// For license information, see `http://img-prod-cms-rt-microsoft-com.akamaized.net/launch/store/launch-ENf7805d09fd1b455883333cdf34ee4ca2.js`.
window._satellite=window._satellite||{},window._satellite.container={buildInfo:{minified:!0,buildDate:"2022-07-12T21:44:00Z",turbineBuildDate:"2022-06-22T20:54:39Z",turbineVersion:"27.3.3-latest"},environment:{id:"ENf7805d09fd1b455883333cdf34ee4ca2",stage:"production"},dataElements:{},extensions:{core:{displayName:"Core",hostedLibFilesBaseUrl:"//img-prod-cms-rt-microsoft-com.akamaized.net/launch/store/5ef092d1efb5/21b18fecd107/b1a558045b99/hostedLibFiles/EP9f64ab5391d540b0bb8658a244bbeb36/",modules:{"core/src/lib/events/pageBottom.js":{name:"page-bottom",displayName:"Page Bottom",script:function(t,e,n){"use strict";var o=n("./helpers/pageLifecycleEvents");t.exports=function(t,e){o.registerPageBottomTrigger(e)}}},"core/src/lib/conditions/domain.js":{name:"domain",displayName:"Domain",script:function(t,e,n){"use strict";var o=n("@adobe/reactor-document"),a=n("../../../node_modules/escape-string-regexp/index.js");t.exports=function(t){var e=o.location.hostname;return t.domains.some((function(t){return e.match(new RegExp("(^|\\.)"+a(t)+"$","i"))}))}}},"core/src/lib/conditions/path.js":{name:"path",displayName:"Path Without Query String",script:function(t,e,n){"use strict";var o=n("@adobe/reactor-document"),a=n("../helpers/textMatch");t.exports=function(t){var e=o.location.pathname;return t.paths.some((function(t){var n=t.valueIsRegex?new RegExp(t.value,"i"):t.value;return a(e,n)}))}}},"core/src/lib/actions/customCode.js":{name:"custom-code",displayName:"Custom Code",script:function(t,e,n,o){"use strict";var a,s,r,i=n("@adobe/reactor-document"),c=n("./helpers/decorateCode"),d=n("./helpers/loadCodeSequentially"),u=n("../../../node_modules/postscribe/dist/postscribe"),l=(a=function(t){u(i.body,t,{error:function(t){o.logger.error(t.msg)}})},s=[],r=function(){if(i.body)for(;s.length;)a(s.shift());else setTimeout(r,20)},function(t){s.push(t),r()}),p=function(){if(i.currentScript)return i.currentScript.async;for(var t=i.querySelectorAll("script"),e=0;e<t.length;e++){var n=t[e];if(/(launch|satelliteLib)-[^\/]+.js(\?.*)?$/.test(n.src))return n.async}return!0}();t.exports=function(t,e){var n={settings:t,event:e},o=n.settings.source;if(o)return n.settings.isExternal?d(o).then((function(t){t&&l(c(n,t))})):void(p||"loading"!==i.readyState?l(c(n,o)):i.write?i.write(c(n,o)):l(c(n,o)))}}},"core/src/lib/conditions/dateRange.js":{name:"date-range",displayName:"Date Range",script:function(t){"use strict";t.exports=function(t){var e=new Date;return!(t.start&&e<new Date(t.start)||t.end&&e>new Date(t.end))}}},"core/src/lib/conditions/customCode.js":{name:"custom-code",displayName:"Custom Code",script:function(t){"use strict";t.exports=function(t,e){return t.source.call(e.element,e,e.target)}}},"core/src/lib/conditions/pathAndQuerystring.js":{name:"path-and-querystring",displayName:"Path And Query String",script:function(t,e,n){"use strict";var o=n("@adobe/reactor-document"),a=n("../helpers/textMatch");t.exports=function(t){var e=o.location.pathname+o.location.search;return t.paths.some((function(t){var n=t.valueIsRegex?new RegExp(t.value,"i"):t.value;return a(e,n)}))}}},"core/src/lib/events/libraryLoaded.js":{name:"library-loaded",displayName:"Library Loaded (Page Top)",script:function(t,e,n){"use strict";var o=n("./helpers/pageLifecycleEvents");t.exports=function(t,e){o.registerLibraryLoadedTrigger(e)}}},"core/src/lib/events/helpers/pageLifecycleEvents.js":{script:function(t,e,n){"use strict";var o=n("@adobe/reactor-window"),a=n("@adobe/reactor-document"),s=-1!==o.navigator.appVersion.indexOf("MSIE 10"),r="WINDOW_LOADED",i="DOM_READY",c="PAGE_BOTTOM",d=[c,i,r],u=function(t,e){return{element:t,target:t,nativeEvent:e}},l={};d.forEach((function(t){l[t]=[]}));var p=function(t,e){d.slice(0,f(t)+1).forEach((function(t){g(e,t)}))},m=function(){return"complete"===a.readyState?r:"interactive"===a.readyState?s?null:i:void 0},f=function(t){return d.indexOf(t)},g=function(t,e){l[e].forEach((function(e){h(t,e)})),l[e]=[]},h=function(t,e){var n=e.trigger,o=e.syntheticEventFn;n(o?o(t):null)};o._satellite=o._satellite||{},o._satellite.pageBottom=p.bind(null,c),a.addEventListener("DOMContentLoaded",p.bind(null,i),!0),o.addEventListener("load",p.bind(null,r),!0),o.setTimeout((function(){var t=m();t&&p(t)}),0),t.exports={registerLibraryLoadedTrigger:function(t){t()},registerPageBottomTrigger:function(t){l[c].push({trigger:t})},registerDomReadyTrigger:function(t){l[i].push({trigger:t,syntheticEventFn:u.bind(null,a)})},registerWindowLoadedTrigger:function(t){l[r].push({trigger:t,syntheticEventFn:u.bind(null,o)})}}}},"core/node_modules/escape-string-regexp/index.js":{script:function(t){"use strict";var e=/[|\\{}()[\]^$+*?.]/g;t.exports=function(t){if("string"!=typeof t)throw new TypeError("Expected a string");return t.replace(e,"\\$&")}}},"core/src/lib/helpers/textMatch.js":{script:function(t){"use strict";t.exports=function(t,e){if(null==e)throw new Error("Illegal Argument: Pattern is not present");return null!=t&&("string"==typeof e?t===e:e instanceof RegExp&&e.test(t))}}},"core/src/lib/actions/helpers/decorateCode.js":{script:function(t,e,n,o){"use strict";var a=0,s=function(t){return t.settings.isExternal},r=function(t,e){return"<script>\n"+e+"\n</script>"},i=function(t,e){var n="__runScript"+ ++a;return _satellite[n]=function(e){e.call(t.event.element,t.event,t.event.target),delete _satellite[n]},'<script>_satellite["'+n+'"](function(event, target) {\n'+e+"\n});</script>"},c={javascript:function(t,e){return t.settings.global?r(t,e):i(t,e)},html:function(t,e){return s(t)?o.replaceTokens(e,t.event):e}};t.exports=function(t,e){return c[t.settings.language](t,e)}}},"core/src/lib/actions/helpers/loadCodeSequentially.js":{script:function(t,e,n){"use strict";var o=n("@adobe/reactor-promise"),a=n("./getSourceByUrl"),s=o.resolve();t.exports=function(t){var e=new o((function(e){var n=a(t);o.all([n,s]).then((function(t){var n=t[0];e(n)}))}));return s=e,e}}},"core/node_modules/postscribe/dist/postscribe.js":{script:function(t,e){var n,o;n=this,o=function(){return function(t){function e(o){if(n[o])return n[o].exports;var a=n[o]={exports:{},id:o,loaded:!1};return t[o].call(a.exports,a,a.exports,e),a.loaded=!0,a.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}var a=o(n(1));t.exports=a.default},function(t,e,n){"use strict";function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function a(t){return t&&t.__esModule?t:{default:t}}function s(){}function r(){var t=f.shift();if(t){var e=l.last(t);e.afterDequeue(),t.stream=i.apply(void 0,t),e.afterStreamStart()}}function i(t,e,n){function o(t){t=n.beforeWrite(t),g.write(t),n.afterWrite(t)}(g=new u.default(t,n)).id=m++,g.name=n.name||g.id,c.streams[g.name]=g;var a=t.ownerDocument,i={close:a.close,open:a.open,write:a.write,writeln:a.writeln};d(a,{close:s,open:s,write:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return o(e.join(""))},writeln:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return o(e.join("")+"\n")}});var l=g.win.onerror||s;return g.win.onerror=function(t,e,o){n.error({msg:t+" - "+e+": "+o}),l.apply(g.win,[t,e,o])},g.write(e,(function(){d(a,i),g.win.onerror=l,n.done(),g=null,r()})),g}function c(t,e,n){if(l.isFunction(n))n={done:n};else if("clear"===n)return f=[],g=null,void(m=0);n=l.defaults(n,p);var o=[t=/^#/.test(t)?window.document.getElementById(t.substr(1)):t.jquery?t[0]:t,e,n];return t.postscribe={cancel:function(){o.stream?o.stream.abort():o[1]=s}},n.beforeEnqueue(o),f.push(o),g||r(),t.postscribe}e.__esModule=!0;var d=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t};e.default=c;var u=a(n(2)),l=o(n(4)),p={afterAsync:s,afterDequeue:s,afterStreamStart:s,afterWrite:s,autoFix:!0,beforeEnqueue:s,beforeWriteToken:function(t){return t},beforeWrite:function(t){return t},done:s,error:function(t){throw new Error(t.msg)},releaseAsync:!1},m=0,f=[],g=null;d(c,{streams:{},queue:f,WriteStream:u.default})},function(t,e,n){"use strict";function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function a(t){return t&&t.__esModule?t:{default:t}}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){var n=p+e,o=t.getAttribute(n);return u.existy(o)?String(o):o}function i(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=p+e;u.existy(n)&&""!==n?t.setAttribute(o,n):t.removeAttribute(o)}e.__esModule=!0;var c=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},d=a(n(3)),u=o(n(4)),l=!1,p="data-ps-",m="ps-style",f="ps-script",g=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};s(this,t),this.root=e,this.options=n,this.doc=e.ownerDocument,this.win=this.doc.defaultView||this.doc.parentWindow,this.parser=new d.default("",{autoFix:n.autoFix}),this.actuals=[e],this.proxyHistory="",this.proxyRoot=this.doc.createElement(e.nodeName),this.scriptStack=[],this.writeQueue=[],i(this.proxyRoot,"proxyof",0)}return t.prototype.write=function(){var t;for((t=this.writeQueue).push.apply(t,arguments);!this.deferredRemote&&this.writeQueue.length;){var e=this.writeQueue.shift();u.isFunction(e)?this._callFunction(e):this._writeImpl(e)}},t.prototype._callFunction=function(t){var e={type:"function",value:t.name||t.toString()};this._onScriptStart(e),t.call(this.win,this.doc),this._onScriptDone(e)},t.prototype._writeImpl=function(t){this.parser.append(t);for(var e=void 0,n=void 0,o=void 0,a=[];(e=this.parser.readToken())&&!(n=u.isScript(e))&&!(o=u.isStyle(e));)(e=this.options.beforeWriteToken(e))&&a.push(e);a.length>0&&this._writeStaticTokens(a),n&&this._handleScriptToken(e),o&&this._handleStyleToken(e)},t.prototype._writeStaticTokens=function(t){var e=this._buildChunk(t);return e.actual?(e.html=this.proxyHistory+e.actual,this.proxyHistory+=e.proxy,this.proxyRoot.innerHTML=e.html,l&&(e.proxyInnerHTML=this.proxyRoot.innerHTML),this._walkChunk(),l&&(e.actualInnerHTML=this.root.innerHTML),e):null},t.prototype._buildChunk=function(t){for(var e=this.actuals.length,n=[],o=[],a=[],s=t.length,r=0;r<s;r++){var i=t[r],c=i.toString();if(n.push(c),i.attrs){if(!/^noscript$/i.test(i.tagName)){var d=e++;o.push(c.replace(/(\/?>)/," "+p+"id="+d+" $1")),i.attrs.id!==f&&i.attrs.id!==m&&a.push("atomicTag"===i.type?"":"<"+i.tagName+" "+p+"proxyof="+d+(i.unary?" />":">"))}}else o.push(c),a.push("endTag"===i.type?c:"")}return{tokens:t,raw:n.join(""),actual:o.join(""),proxy:a.join("")}},t.prototype._walkChunk=function(){for(var t=void 0,e=[this.proxyRoot];u.existy(t=e.shift());){var n=1===t.nodeType;if(!n||!r(t,"proxyof")){n&&(this.actuals[r(t,"id")]=t,i(t,"id"));var o=t.parentNode&&r(t.parentNode,"proxyof");o&&this.actuals[o].appendChild(t)}e.unshift.apply(e,u.toArray(t.childNodes))}},t.prototype._handleScriptToken=function(t){var e=this,n=this.parser.clear();n&&this.writeQueue.unshift(n),t.src=t.attrs.src||t.attrs.SRC,(t=this.options.beforeWriteToken(t))&&(t.src&&this.scriptStack.length?this.deferredRemote=t:this._onScriptStart(t),this._writeScriptToken(t,(function(){e._onScriptDone(t)})))},t.prototype._handleStyleToken=function(t){var e=this.parser.clear();e&&this.writeQueue.unshift(e),t.type=t.attrs.type||t.attrs.TYPE||"text/css",(t=this.options.beforeWriteToken(t))&&this._writeStyleToken(t),e&&this.write()},t.prototype._writeStyleToken=function(t){var e=this._buildStyle(t);this._insertCursor(e,m),t.content&&(e.styleSheet&&!e.sheet?e.styleSheet.cssText=t.content:e.appendChild(this.doc.createTextNode(t.content)))},t.prototype._buildStyle=function(t){var e=this.doc.createElement(t.tagName);return e.setAttribute("type",t.type),u.eachKey(t.attrs,(function(t,n){e.setAttribute(t,n)})),e},t.prototype._insertCursor=function(t,e){this._writeImpl('<span id="'+e+'"/>');var n=this.doc.getElementById(e);n&&n.parentNode.replaceChild(t,n)},t.prototype._onScriptStart=function(t){t.outerWrites=this.writeQueue,this.writeQueue=[],this.scriptStack.unshift(t)},t.prototype._onScriptDone=function(t){t===this.scriptStack[0]?(this.scriptStack.shift(),this.write.apply(this,t.outerWrites),!this.scriptStack.length&&this.deferredRemote&&(this._onScriptStart(this.deferredRemote),this.deferredRemote=null)):this.options.error({msg:"Bad script nesting or script finished twice"})},t.prototype._writeScriptToken=function(t,e){var n=this._buildScript(t),o=this._shouldRelease(n),a=this.options.afterAsync;t.src&&(n.src=t.src,this._scriptLoadHandler(n,o?a:function(){e(),a()}));try{this._insertCursor(n,f),n.src&&!o||e()}catch(t){this.options.error(t),e()}},t.prototype._buildScript=function(t){var e=this.doc.createElement(t.tagName);return u.eachKey(t.attrs,(function(t,n){e.setAttribute(t,n)})),t.content&&(e.text=t.content),e},t.prototype._scriptLoadHandler=function(t,e){function n(){t=t.onload=t.onreadystatechange=t.onerror=null}function o(){n(),null!=e&&e(),e=null}function a(t){n(),r(t),null!=e&&e(),e=null}function s(t,e){var n=t["on"+e];null!=n&&(t["_on"+e]=n)}var r=this.options.error;s(t,"load"),s(t,"error"),c(t,{onload:function(){if(t._onload)try{t._onload.apply(this,Array.prototype.slice.call(arguments,0))}catch(e){a({msg:"onload handler failed "+e+" @ "+t.src})}o()},onerror:function(){if(t._onerror)try{t._onerror.apply(this,Array.prototype.slice.call(arguments,0))}catch(e){return void a({msg:"onerror handler failed "+e+" @ "+t.src})}a({msg:"remote script failed "+t.src})},onreadystatechange:function(){/^(loaded|complete)$/.test(t.readyState)&&o()}})},t.prototype._shouldRelease=function(t){return!/^script$/i.test(t.nodeName)||!!(this.options.releaseAsync&&t.src&&t.hasAttribute("async"))},t}();e.default=g},function(t){var e;e=function(){return function(t){function e(o){if(n[o])return n[o].exports;var a=n[o]={exports:{},id:o,loaded:!1};return t[o].call(a.exports,a,a.exports,e),a.loaded=!0,a.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}var a=o(n(1));t.exports=a.default},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function a(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var r=a(n(2)),i=a(n(3)),c=o(n(6)),d=n(5),u={comment:/^<!--/,endTag:/^<\//,atomicTag:/^<\s*(script|style|noscript|iframe|textarea)[\s\/>]/i,startTag:/^</,chars:/^[^<]/},l=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};s(this,t),this.stream=n;var a=!1,i={};for(var d in r)r.hasOwnProperty(d)&&(o.autoFix&&(i[d+"Fix"]=!0),a=a||i[d+"Fix"]);a?(this._readToken=(0,c.default)(this,i,(function(){return e._readTokenImpl()})),this._peekToken=(0,c.default)(this,i,(function(){return e._peekTokenImpl()}))):(this._readToken=this._readTokenImpl,this._peekToken=this._peekTokenImpl)}return t.prototype.append=function(t){this.stream+=t},t.prototype.prepend=function(t){this.stream=t+this.stream},t.prototype._readTokenImpl=function(){var t=this._peekTokenImpl();if(t)return this.stream=this.stream.slice(t.length),t},t.prototype._peekTokenImpl=function(){for(var t in u)if(u.hasOwnProperty(t)&&u[t].test(this.stream)){var e=i[t](this.stream);if(e)return"startTag"===e.type&&/script|style/i.test(e.tagName)?null:(e.text=this.stream.substr(0,e.length),e)}},t.prototype.peekToken=function(){return this._peekToken()},t.prototype.readToken=function(){return this._readToken()},t.prototype.readTokens=function(t){for(var e=void 0;e=this.readToken();)if(t[e.type]&&!1===t[e.type](e))return},t.prototype.clear=function(){var t=this.stream;return this.stream="",t},t.prototype.rest=function(){return this.stream},t}();for(var p in e.default=l,l.tokenToString=function(t){return t.toString()},l.escapeAttributes=function(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=(0,d.escapeQuotes)(t[n],null));return e},l.supports=r,r)r.hasOwnProperty(p)&&(l.browserHasFlaw=l.browserHasFlaw||!r[p]&&p)},function(t,e){"use strict";e.__esModule=!0;var n=!1,o=!1,a=window.document.createElement("div");try{var s="<P><I></P></I>";a.innerHTML=s,e.tagSoup=n=a.innerHTML!==s}catch(t){e.tagSoup=n=!1}try{a.innerHTML="<P><i><P></P></i></P>",e.selfClose=o=2===a.childNodes.length}catch(t){e.selfClose=o=!1}a=null,e.tagSoup=n,e.selfClose=o},function(t,e,n){"use strict";function o(t){var e=t.indexOf("-->");if(e>=0)return new d.CommentToken(t.substr(4,e-1),e+3)}function a(t){var e=t.indexOf("<");return new d.CharsToken(e>=0?e:t.length)}function s(t){var e,n,o;if(-1!==t.indexOf(">")){var a=t.match(u.startTag);if(a){var s=(e={},n={},o=a[2],a[2].replace(u.attr,(function(t,a){arguments[2]||arguments[3]||arguments[4]||arguments[5]?arguments[5]?(e[arguments[5]]="",n[arguments[5]]=!0):e[a]=arguments[2]||arguments[3]||arguments[4]||u.fillAttr.test(a)&&a||"":e[a]="",o=o.replace(t,"")})),{v:new d.StartTagToken(a[1],a[0].length,e,n,!!a[3],o.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""))});if("object"===(void 0===s?"undefined":c(s)))return s.v}}}function r(t){var e=s(t);if(e){var n=t.slice(e.length);if(n.match(new RegExp("</\\s*"+e.tagName+"\\s*>","i"))){var o=n.match(new RegExp("([\\s\\S]*?)</\\s*"+e.tagName+"\\s*>","i"));if(o)return new d.AtomicTagToken(e.tagName,o[0].length+e.length,e.attrs,e.booleanAttrs,o[1])}}}function i(t){var e=t.match(u.endTag);if(e)return new d.EndTagToken(e[1],e[0].length)}e.__esModule=!0;var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.comment=o,e.chars=a,e.startTag=s,e.atomicTag=r,e.endTag=i;var d=n(4),u={startTag:/^<([\-A-Za-z0-9_]+)((?:\s+[\w\-]+(?:\s*=?\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,endTag:/^<\/([\-A-Za-z0-9_]+)[^>]*>/,attr:/(?:([\-A-Za-z0-9_]+)\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))|(?:([\-A-Za-z0-9_]+)(\s|$)+)/g,fillAttr:/^(checked|compact|declare|defer|disabled|ismap|multiple|nohref|noresize|noshade|nowrap|readonly|selected)$/i}},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0,e.EndTagToken=e.AtomicTagToken=e.StartTagToken=e.TagToken=e.CharsToken=e.CommentToken=e.Token=void 0;var a=n(5),s=(e.Token=function t(e,n){o(this,t),this.type=e,this.length=n,this.text=""},e.CommentToken=function(){function t(e,n){o(this,t),this.type="comment",this.length=n||(e?e.length:0),this.text="",this.content=e}return t.prototype.toString=function(){return"<!--"+this.content},t}(),e.CharsToken=function(){function t(e){o(this,t),this.type="chars",this.length=e,this.text=""}return t.prototype.toString=function(){return this.text},t}(),e.TagToken=function(){function t(e,n,a,s,r){o(this,t),this.type=e,this.length=a,this.text="",this.tagName=n,this.attrs=s,this.booleanAttrs=r,this.unary=!1,this.html5Unary=!1}return t.formatTag=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n="<"+t.tagName;for(var o in t.attrs)if(t.attrs.hasOwnProperty(o)){n+=" "+o;var s=t.attrs[o];void 0!==t.booleanAttrs&&void 0!==t.booleanAttrs[o]||(n+='="'+(0,a.escapeQuotes)(s)+'"')}return t.rest&&(n+=" "+t.rest),t.unary&&!t.html5Unary?n+="/>":n+=">",null!=e&&(n+=e+"</"+t.tagName+">"),n},t}());e.StartTagToken=function(){function t(e,n,a,s,r,i){o(this,t),this.type="startTag",this.length=n,this.text="",this.tagName=e,this.attrs=a,this.booleanAttrs=s,this.html5Unary=!1,this.unary=r,this.rest=i}return t.prototype.toString=function(){return s.formatTag(this)},t}(),e.AtomicTagToken=function(){function t(e,n,a,s,r){o(this,t),this.type="atomicTag",this.length=n,this.text="",this.tagName=e,this.attrs=a,this.booleanAttrs=s,this.unary=!1,this.html5Unary=!1,this.content=r}return t.prototype.toString=function(){return s.formatTag(this,this.content)},t}(),e.EndTagToken=function(){function t(e,n){o(this,t),this.type="endTag",this.length=n,this.text="",this.tagName=e}return t.prototype.toString=function(){return"</"+this.tagName+">"},t}()},function(t,e){"use strict";function n(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return t?t.replace(/([^"]*)"/g,(function(t,e){return/\\/.test(e)?e+'"':e+'\\"'})):e}e.__esModule=!0,e.escapeQuotes=n},function(t,e){"use strict";function n(t){return t&&"startTag"===t.type&&(t.unary=i.test(t.tagName)||t.unary,t.html5Unary=!/\/>$/.test(t.text)),t}function o(t,e){var o=t.stream,a=n(e());return t.stream=o,a}function a(t,e){var n=e.pop();t.prepend("</"+n.tagName+">")}function s(){var t=[];return t.last=function(){return this[this.length-1]},t.lastTagNameEq=function(t){var e=this.last();return e&&e.tagName&&e.tagName.toUpperCase()===t.toUpperCase()},t.containsTagName=function(t){for(var e,n=0;e=this[n];n++)if(e.tagName===t)return!0;return!1},t}function r(t,e,r){function i(){var e=o(t,r);e&&u[e.type]&&u[e.type](e)}var d=s(),u={startTag:function(n){var o=n.tagName;"TR"===o.toUpperCase()&&d.lastTagNameEq("TABLE")?(t.prepend("<TBODY>"),i()):e.selfCloseFix&&c.test(o)&&d.containsTagName(o)?d.lastTagNameEq(o)?a(t,d):(t.prepend("</"+n.tagName+">"),i()):n.unary||d.push(n)},endTag:function(n){d.last()?e.tagSoupFix&&!d.lastTagNameEq(n.tagName)?a(t,d):d.pop():e.tagSoupFix&&(r(),i())}};return function(){return i(),n(r())}}e.__esModule=!0,e.default=r;var i=/^(AREA|BASE|BASEFONT|BR|COL|FRAME|HR|IMG|INPUT|ISINDEX|LINK|META|PARAM|EMBED)$/i,c=/^(COLGROUP|DD|DT|LI|OPTIONS|P|TD|TFOOT|TH|THEAD|TR)$/i}])},t.exports=e()},function(t,e){"use strict";function n(t){return null!=t}function o(t){return"function"==typeof t}function a(t,e,n){var o=void 0,a=t&&t.length||0;for(o=0;o<a;o++)e.call(n,t[o],o)}function s(t,e,n){for(var o in t)t.hasOwnProperty(o)&&e.call(n,o,t[o])}function r(t,e){return t=t||{},s(e,(function(e,o){n(t[e])||(t[e]=o)})),t}function i(t){try{return Array.prototype.slice.call(t)}catch(o){var e=(n=[],a(t,(function(t){n.push(t)})),{v:n});if("object"===(void 0===e?"undefined":p(e)))return e.v}var n}function c(t){return t[t.length-1]}function d(t,e){return!(!t||"startTag"!==t.type&&"atomicTag"!==t.type||!("tagName"in t)||!~t.tagName.toLowerCase().indexOf(e))}function u(t){return d(t,"script")}function l(t){return d(t,"style")}e.__esModule=!0;var p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.existy=n,e.isFunction=o,e.each=a,e.eachKey=s,e.defaults=r,e.toArray=i,e.last=c,e.isTag=d,e.isScript=u,e.isStyle=l}])},"object"==typeof e&&"object"==typeof t?t.exports=o():"function"==typeof define&&define.amd?define([],o):"object"==typeof e?e.postscribe=o():n.postscribe=o()}},"core/src/lib/actions/helpers/getSourceByUrl.js":{script:function(t,e,n){"use strict";var o=n("@adobe/reactor-load-script"),a=n("@adobe/reactor-promise"),s={},r={},i=function(t){return r[t]||(r[t]=o(t)),r[t]};_satellite.__registerScript=function(t,e){s[t]=e},t.exports=function(t){return s[t]?a.resolve(s[t]):new a((function(e){i(t).then((function(){e(s[t])}),(function(){e()}))}))}}}}},"google-adwords":{displayName:"Google Ads",hostedLibFilesBaseUrl:"//img-prod-cms-rt-microsoft-com.akamaized.net/launch/store/5ef092d1efb5/21b18fecd107/b1a558045b99/hostedLibFiles/EP0c3eb682977f4498b44855d2e1d8c210/",modules:{}},linkedin:{displayName:"LinkedIn Insight Tag",hostedLibFilesBaseUrl:"//img-prod-cms-rt-microsoft-com.akamaized.net/launch/store/5ef092d1efb5/21b18fecd107/b1a558045b99/hostedLibFiles/EP56446adda5514f21aa663f9e3635ddaa/",settings:{insightTagID:"7850"},modules:{"linkedin/src/lib/actions/loadInsightTag.js":{name:"load-insight-tag",displayName:"Load Insight Tag",script:function(t,e,n,o){"use strict";t.exports=function(){var t=o.getExtensionSettings();if(t&&t.insightTagID){window._linkedin_data_partner_id=t.insightTagID;var e=document.getElementsByTagName("script")[0],n=document.createElement("script");n.type="text/javascript",n.async=!0,n.src="https://snap.licdn.com/li.lms-analytics/insight.min.js",e.parentNode.insertBefore(n,e)}}}}}}},company:{orgId:"EA76ADE95776D2EC7F000101@AdobeOrg",dynamicCdnEnabled:!1},property:{name:"Store",settings:{domains:["microsoft.com"],undefinedVarsReturnEmpty:!1,ruleComponentSequencingEnabled:!1},id:"PRb55c9879b37e451cb2349365f439f194"},rules:[{id:"RL89c6b1458ddb45ab8e133a4d0fbab7d7",name:"Media_/EN-GB/Surface Indirect Commercial Category Page (RT)",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-gb/store/b/surfaceforbusiness",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{var rand = parseInt(1E5 * 1E4 * Math.random() * Math.random());\n// Shop now and Shop Essential Bundle buttons\njQuery("a:contains(\'Shop now\'),a:contains(\'Learn more\'),a:contains(\'Shop essential bundle\')").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="https://secure.adnxs.com/px?id=1268102&t=2";\nimage2 = new Image(1, 1); \nimage2.src="https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50188&ActionName=Store_Site_Visit&cachebuster="+rand;\n});\n  \n//Product Card Clicks\njQuery("div.m-content-placement.x-clearfix:lt(4)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="https://secure.adnxs.com/px?id=1268102&t=2";\nimage2 = new Image(1, 1); \nimage2.src="https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50188&ActionName=Store_Site_Visit&cachebuster="+rand;\n });\n  \n }\ncatch(err)\n{\n\t_satellite.logger.error("Media_/EN-GB/Surface Indirect Commercial Category Page (RT)");\n}\n',language:"javascript"}}]},{id:"RL7aaf7a34d86c49acbd979fbbdd4cb738",name:"Media_/DE-DE/Surface Indirect Commercial Category Page (RT)",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/de-de/store/b/surfaceforbusiness",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{var rand = parseInt(1E5 * 1E4 * Math.random() * Math.random());\n// Shop now and Shop Essential Bundle buttons\njQuery("a.c-call-to-action:lt(14),a.c-call-to-action:eq(15)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="https://secure.adnxs.com/px?id=1268102&t=2";\nimage2 = new Image(1, 1); \nimage2.src="https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50188&ActionName=Store_Site_Visit&cachebuster="+rand;\n});\n  \n//Product Card Clicks\njQuery("div.m-content-placement.x-clearfix:lt(3),div:eq(78)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="https://secure.adnxs.com/px?id=1268102&t=2";\nimage2 = new Image(1, 1); \nimage2.src="https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50188&ActionName=Store_Site_Visit&cachebuster="+rand;\n });\n  \n }\ncatch(err)\n{\n\t_satellite.logger.error("Media_/DE-DE/Surface Indirect Commercial Category Page (RT)");\n}\n',language:"javascript"}}]},{id:"RL6e837a4ee338456db500b886b2d772c3",name:"Media_/en-au/store/b/student",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-au/store/b/student",valueIsRegex:!0},{value:"/en-au/store/b/student/",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n//DCM Hero\n  jQuery("div[id*=\'coreui-multihero-yko9tu6\']").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=Check Eligibility Student"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?";\n});\n  \n//DCM Quick Links\n  jQuery("div[id*=\'oneStore-quicklinksmodule-hl74ock\']").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=Check Eligibility Student"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?";\n}); \n  \n//ADNXS Hero\n  jQuery("div[id*=\'coreui-multihero-yko9tu6\']").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="//secure.adnxs.com/px?id=1268102&t=2";\n});\n  \n//ADNXS Quick Links\n  jQuery("div[id*=\'oneStore-quicklinksmodule-hl74ock\']").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="//secure.adnxs.com/px?id=1268102&t=2";\n});   \n  \n//Yahoo Hero\n  jQuery("div[id*=\'coreui-multihero-yko9tu6\']").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick";\n});\n  \n//Yahoo Quick Links\n  jQuery("div[id*=\'oneStore-quicklinksmodule-hl74ock\']").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick";\n});     \n   \n  \n }\ncatch(err)\n{\n\t_satellite.logger.error("Media_/en-au/store/b/student");\n}\n',language:"javascript"}}]},{id:"RL8d9a434b8bda46f6962536ba8508db38",name:"Personal Shopper AU- Facebook",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-au/store/b/online-computer-shopping-appointments",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}},{modulePath:"core/src/lib/conditions/dateRange.js",settings:{end:"2022-01-31T00:00:00Z",start:"2021-11-11T00:00:00Z"}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n// Facebook\n jQuery("a#coreui-highlightfeature-v8eiq2s-0").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="https://www.facebook.com/tr?id=1770559986549030&amp&ev=CompleteRegistration&cd[content_names]=["+encodeURIComponent(_TMDL.pagename) + "]";\n  \n });\n }\ncatch(err)\n{\n\t_satellite.logger.error("Personal Shopper AU- Facebook");\n}\n',language:"javascript"}}]},{id:"RL245f9ce34bfa4f3d8082b7eaf6a88731",name:"OFF_AMO_ADNXS_CV",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{
source:'/* OFF_AMO_ADNXS_CV */\n\n\nvar isTrial=0;\nvar inScope=0;\nvar trialskus = {\n\t"cfq7ttc0k5bc-0003" : 1,\n\t"cfq7ttc0k5dm-007n" : 1,\n\t"cfq7ttc0k5dm-007q" : 1,\n\t"cfq7ttc0k5dm-007s" : 1,\n\t"cfq7ttc0k5dm-00hq" : 1,\n\t"cfq7ttc0k5dm-00hr" : 1\n};\n\n// added for Alta\nvar office365bigids = {\n\t"cfq7ttc0k5bf" : 1,\n\t"cfq7ttc0k5dm" : 1,\n\t"cfq7ttc0k5bc" : 1,\n\t"8pc5bjbhn74p" : 1, //new\n\t"94cm694vj57p" : 1, //new\n\t"900rpbx20ts6" : 1, //new\n\t"93r684wj71vj" : 1, //new\n\t"8v9j0t4jfz6w" : 1, //new\n\t"cfq7ttc0k5bd" : 1,\n\t"8nfjc88fkmrz" : 1, //new\n\t"8szwm812t6n1" : 1, //new\n\t"cfq7ttc0k5bg" : 1, //new\n\t"8v883x3j1v40" : 1  //new\n};\n\nfor (var i = 0; i < _TMDL.pidsku.length; i++) {\n  // update check to also look for office365bigids to adapt to Alta\n\tif (_TMDL.pnames && (~_TMDL.pnames[i].toLowerCase().indexOf("office") || ~_TMDL.pnames[i].toLowerCase().indexOf("o365") || ~_TMDL.pnames[i].toLowerCase().indexOf("off365") || office365bigids[_TMDL.pids[i].toLowerCase()]==1 )  && trialskus[_TMDL.pidsku[i].toLowerCase()]!==1) {\n\t\tinScope=1;\n\t}\n}\n\nvar amourl,adnxurl;\n\ntry {\n  if (inScope) {\n      adnxurl = "https://secure.adnxs.com/px?id=1089341&order_id="+_TMDL.purchaseID+"&other="+_TMDL.pidsku.join("_")+"&t=2";\n      Bootstrapper.imageRequest(adnxurl);\n\n      amourl = "https://pixel.everesttech.net/px2/5584?px_evt=t&ev_ConsPurchase=1"+\n          "&ev_transaction_market_"+_TMDL.geo+"=1"+\n          "&ev_items="+_TMDL.totqty+\n          "&ev_currency_"+_TMDL.cc+"=1"+\n          "&ev_revenue="+_TMDL.totamount+\n          "&ev_transid="+_TMDL.purchaseID;\n      Bootstrapper.imageRequest(amourl);\n  }\n} catch(err) {_satellite.logger.log("OFF_AMO_ADNXS_CV ERR");}\n\n\n',language:"javascript"}}]},{id:"RL5c1f0ed8f9c64aa488ccab2558f160dc",name:"BingSurfClkCustom /d/ (AEM/RT)",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:80}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return~window.location.pathname.toLowerCase().indexOf("/d/")&&~window.location.pathname.toLowerCase().indexOf("surface")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"\n\nvar tempobj; \n\ntry {\n\n\tif (~window.location.pathname.toLowerCase().indexOf(\"surface\") && ~window.location.pathname.toLowerCase().indexOf(\"/d/\") && window.navigator.userAgent.toLowerCase().indexOf(\"soasta\")<0 && (typeof uetq=='object')) {\n\n\t\ttempobj={};\n\t\t\n\t\tif (_TMDL.pidsku.length > 0) {\n\t\t\ttempobj.ecomm_prodid = (_TMDL.pidsku.length>0) ? _TMDL.pidsku : \"\";\n\t\t\ttempobj.ecomm_pagetype = \"product\";\n\t\t\ttempobj.items = [\n\t\t\t\t{\n\t\t\t\t  'id': _TMDL.pidsku[0],\n\t\t\t\t  'category': 'surface',\n\t\t\t\t  'price' : _TMDL.sales[0]\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t\t\n\t\t// Configure Now CTA\n        /*\n\t\t$(document).on('mousedown','button[id*=\"ConfigureDeviceButton\"]','', function() {\n\t\t\twindow.uetq.push('event','configurenow', tempobj); \n\t\t});\n        */\n      \n\t\t// Configure Now CTA - Updated 7/19 to correct ID\n        jQuery(\"a:contains('Configure now'),button:contains('Configure now')\").on(\"mousedown\", function(){\n            window.uetq.push('event','configurenow', tempobj); \n         });\n      \n      \n\t\t// BuildYourBundle CTA\n        $(document).on('mousedown','button[id*=\"buttons_BuildABundleButton\"],a[href*=\"/store/build/\"]','', function() {\n\t\t\twindow.uetq.push('event','buildyourbundle', tempobj); \n\t\t});\n\t\t\t\n\t\t\n\t\t//check your eligibility CTA\n\t\t\n\t\t$(document).on('mousedown',\"a[href*='student-discounts?successurl']\",'', function() {\n\t\t\twindow.uetq.push('event','checkeligibility', tempobj); \n\t\t});\n      \n      \t// Add to Cart button, particularly needed for Surface Go PDP -- Update 7/19 Surface GO PDP and configurator page do not appear to have this ID. \"add to cart\" only exists after the bundle is created on the configurator. \n        //This should likely be updated to use: jQuery(\"a:contains('Add to cart'),button:contains('Add to cart')\");\n\t\t$(document).on('mousedown','button[id*=\"buttons_AddToCartButton\"]','', function() {\n\t\t\twindow.uetq.push('event','addtocartbutton', tempobj); \n\t\t});\t\t\n\t}\n} catch(bingerr) {console.log(\"bing onclick err\");}\n",language:"javascript"}}]},{id:"RLd2efe62bee8d45ecbf62d39c15613ec0",name:"Media_/de-de/store/b/sale",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/de-de/store/b/sale"},{value:"/de-de/store/b/sale/"}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n  \n// ADNXS\n \n //Surface Starter Packages Product Tiles\njQuery("section.m-product-placement-item:lt(4)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "//secure.adnxs.com/px?id=1268102&t=2";\n});\n //Further Information  \njQuery("a.c-call-to-action.c-glyph:eq(11)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "//secure.adnxs.com/px?id=1268102&t=2";\n});\n  \n\n\n//DoubleClick\n \n  //Surface Starter Packages Product Tiles\njQuery("section.m-product-placement-item:lt(4)").on("mousedown", function(){\n    Bootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=Shop Now"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?");\n});\n  \n  //Further Information  \njQuery("a.c-call-to-action.c-glyph:eq(11)").on("mousedown", function(){\n    Bootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=Product Options"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?");\n});\n  \n  \n//Yahoo\n \n  //Surface Starter Packages Product Tiles\njQuery("section.m-product-placement-item:lt(4)").on("mousedown", function(){\n    Bootstrapper.imageRequest("https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick");\n});\n  \n  //Further Information \njQuery("a.c-call-to-action.c-glyph:eq(11)").on("mousedown", function(){\n    Bootstrapper.imageRequest("https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick");\n});\n\n}\ncatch(err)\n{\n\t_satellite.logger.error("Media_/de-de/store/b/sale");\n}\n  ',language:"javascript"}}]},{id:"RLd73c3b4bf4e447aa9825807eb823eca1",name:"Media_/LL-LL/d/surface Twitter (RT)",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/d/surface",valueIsRegex:!0},{value:"/d/surface/",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-us/d/surface",valueIsRegex:!0},{value:"/en-us/d/surface/",valueIsRegex:!0}]},negate:!0}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try {\n  \n  //Page Load\n  var image = new Image(1,1);\n  image.src = "https://analytics.twitter.com/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";\n  var image2 = new Image(1,1);\n  image2.src="//t.co/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";\n\n  \n   //Configure Now button\njQuery("button.c-button.f-primary:eq(0)").on("mousedown", function(){\nvar image = new Image(1,1);\n  image.src = "https://analytics.twitter.com/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9u&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";\nvar image2 = new Image(1,1);  \n  image2.src="//t.co/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";\n});\n  \n   //Surface Laptop Go for Business Button\njQuery("a.c-hyperlink:eq(2)").on("mousedown", function(){\nvar image = new Image(1,1);\n  image.src = "https://analytics.twitter.com/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";\nvar image2 = new Image(1,1);\n  image2.src="//t.co/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";\n});\n\n}\ncatch(err)\n{\n\t_satellite.logger.error("Media_/LL-LL/d/surface Twitter (RT)");\n}',language:"javascript"}}]},{id:"RLe39a0c628c1f4bda9ac9927f913e881c",name:"Media_/EN-US/Business Consultation Signup Facebook (AEM/RT)",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-us/store/b/business-consultation",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}},{modulePath:"core/src/lib/conditions/dateRange.js",settings:{end:"2022-07-01T00:00:00Z",start:"2021-07-12T00:00:00Z"}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n// Facebook pixel\n$(\'a[href*="https://digitalreservations.microsoft.com/en-us/appointment/create"]\').on("mousedown", function () {\n    var image = new Image(1, 1);\n    image.src ="https://www.facebook.com/tr?id=1770559986549030&ev=CompleteRegistration&cd%5Bcontent_names%5D=%5Bbusiness%20consultation%20-%20allmodules%5D&dt=1l9jpcf0884e2ejscx0mouivuhqnr3hy";\n});\n\n }\ncatch(err)\n{\n\t_satellite.logger.error("Media_/EN-US/Business Consultation Signup Facebook (AEM/RT)");\n}\n\n',language:"javascript"}}]},{id:"RL11bcd2cc8bc2418f87c203a3c8580113",name:"DCMCVF",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"try\n{\n\tvar doFloodlights = function(debug) {\n\t\t_TMDL.dcmcat = [];\n\n\t\tvar pnames, pids, pidsku, sales, quantities, totqty, totamt, imgsrc1;\n\t\tvar\ta = \"\" + (Math.random() * 10000000000000);\n\t\tvar mc1 = \"\";\n\t\tvar floodlights = {};\n\n\n\t\tvar cartFloodlights = {\n\t\t\t\twindowsdevices : \"/src=8406115;type=wndv;cat=crtv_std\",\n\t\t\t\twindowssoftware : \"/src=8406727;type=wsft;cat=crtv_std\",\n\t\t\t\tothersoftware : \"/src=8406724;type=sftw;cat=crtv_std\",\n\t\t\t\tsurface : \"/src=8400690;type=surf;cat=crtv_std\",\n\t\t\t\txboxplatform : \"/src=8391491;type=xbxp;cat=crtv_std\",\n\t\t\t\txboxgames : \"exclude\",\n\t\t\t\txboxdesignlabs : \"/src=8404966;type=xdl;cat=crtv_std\",\n\t\t\t\txboxgamepass : \"/src=8406391;type=xgpg;cat=crtv_std\",\n\t\t\t\txboxlive : \"/src=8391497;type=xlg;cat=crtv_std\",\n\t\t\t\thololens : \"/src=8391509;type=hll;cat=crtv_std\",\n\t\t\t\toffice : \"/src=8406097;type=ofco;cat=crtv_std\",\n\t\t\t\tminecraft : \"/src=8400687;type=mc;cat=crtv_std\",\n\t\t\t\tother : \"/src=8406157;type=stoth;cat=crtv_std\",\n\t\t\t\txboxdigitalgames : \"/src=8406391;type=xgpg;cat=crtd_std\",\n\t\t\t\twinsoftdigital : \"/src=8406727;type=wsft;cat=pdv_dgtl\"\n\t\t};\n\n\t\tvar purchaseFloodlights = {\n\t\t\twindowsdevices : \"/src=8406115;type=wndv_sls;cat=pch_phy\",\n\t\t\twindowssoftware : \"/src=8406727;type=wsft_sls;cat=pch_phy\",\n\t\t\tothersoftware : \"/src=8406724;type=sftw_sls;cat=pch_phy\",\n\t\t\tsurface : \"/src=8400690;type=surf_sls;cat=pch_phy\",\n\t\t\txboxplatform : \"/src=8391491;type=xbxp_sls;cat=pch_phy\",\n\t\t\txboxgames : \"exclude\",\n\t\t\txboxdesignlabs : \"/src=8404966;type=xdl_sls;cat=pch_phy\",\n\t\t\txboxgamepass : \"/src=8406391;type=xgpg_sls;cat=pch_phy\",\n\t\t\txboxlive : \"/src=8391497;type=xlg_sale;cat=pch_phy\",\n\t\t\thololens : \"/src=8391509;type=hll_sls;cat=pch_phy\",\n\t\t\toffice : \"/src=8406097;type=ofco_sls;cat=pch_phy\",\n\t\t\tminecraft : \"/src=8400687;type=mc_sls;cat=pch_phy\",\n\t\t\tother : \"/src=8406157;type=stot_sl;cat=pch_phy\",\n\t\t\txboxdigitalgames : \"/src=8406391;type=xgpg_sls;cat=pch_dgtl\",\n\t\t\twinsoftdigital : \"/src=8406727;type=wsft_sls;cat=pch_dgtl\"\n\t\t};\n\t\t\n\t\tvar categoryAmounts = {\n\t\t\twindowsdevices : 0,\n\t\t\twindowssoftware : 0,\n\t\t\tothersoftware : 0,\n\t\t\tsurface : 0,\n\t\t\txboxplatform : 0,\n\t\t\txboxgames : 0,\n\t\t\txboxdesignlabs : 0,\n\t\t\txboxgamepass : 0,\n\t\t\txboxlive : 0,\n\t\t\thololens : 0,\n\t\t\toffice : 0,\n\t\t\tminecraft : 0,\n\t\t\tother : 0,\n\t\t\txboxdigitalgames : 0,\n\t\t\twinsoftdigital : 0\n\t\t};\n\t\t\n\t\tvar categoryOrders = {\n\t\t\twindowsdevices : 0,\n\t\t\twindowssoftware : 0,\n\t\t\tothersoftware : 0,\n\t\t\tsurface : 0,\n\t\t\txboxplatform : 0,\n\t\t\txboxgames : 0,\n\t\t\txboxdesignlabs : 0,\n\t\t\txboxgamepass : 0,\n\t\t\txboxlive : 0,\n\t\t\thololens : 0,\n\t\t\toffice : 0,\n\t\t\tminecraft : 0,\n\t\t\tother : 0,\n\t\t\txboxdigitalgames : 0,\n\t\t\twinsoftdigital : 0\n\t\t};\n\n\t\tvar pidexclude = {\n\t\t};\n\t\tvar skulist = {\n          '8MXP0HW2H8GR-8JK6' : 'surface',\n          '8MXP0HW2H8GR-9T1P' : 'surface',\n          '8MXP0HW2H8GR-LVMX' : 'surface'\t\t\t\n\t\t};\n\t\t\n\t\tvar matchWindowBrand = function(pname) {\n\t\t\tvar brandnames = [\n\t\t\t\t\"acer\",\n\t\t\t\t\"alienware\",\n\t\t\t\t\"asus\",\n\t\t\t\t\"cyberpowerpc\",\n\t\t\t\t\"dell\",\n\t\t\t\t\"hp\",\n\t\t\t\t\"huawei\",\n\t\t\t\t\"ibuypower\",\n\t\t\t\t\"lenovo\",\n\t\t\t\t\"linx\",\n\t\t\t\t\"logah\",\n\t\t\t\t\"millet\",\n\t\t\t\t\"razer\",\n\t\t\t\t\"porsche\",\n\t\t\t\t\"samsung\",\n\t\t\t\t\"toshiba\"\n\t\t\t\t];\n\t\t\tfor (var i=0; i<brandnames.length; i++){\n\t\t\t\tif (~pname.toLowerCase().indexOf(brandnames[i])) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\t\t\n\t\tvar matchXboxBrand = function(pname) {\n\t\t\tvar brandnames = [\n\t\t\t\t\"forza\",\n\t\t\t\t\"call of duty\",\n\t\t\t\t\"tomb raider\",\n\t\t\t\t\"toy soldiers war chest\",\n\t\t\t\t\"red dead\",\n\t\t\t\t\"halo\",\n\t\t\t\t\"state of decay\",\n\t\t\t\t\"fifa\",\n\t\t\t\t\"sea of thieves\",\n\t\t\t\t\"fallout\",\n\t\t\t\t\"playerunknown\"\n\t\t\t\t];\n\t\t\tfor (var i=0; i<brandnames.length; i++){\n\t\t\t\tif (~pname.toLowerCase().indexOf(brandnames[i])) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\n\t\t// update pidlist\n\t\tvar pidlist={\n\t\t\t\n\t\t'D76QX4BZNWK4' : 'windowssoftware',\n\t\t'DF77X4D43RKT' : 'windowssoftware',\n\t\t'DG7GMGF0DS12' : 'windowssoftware',\n\t\t'DG7GMGF0DS1H' : 'windowssoftware',\n\t  'DG7GMGF0DT05' : 'windowssoftware',\n\t\t'DG7GMGF0DT06' : 'windowssoftware',\n\t\t\n\t\t'DG7GMGF0DST3' : 'othersoftware',\n\t\t'DG7GMGF0DST4' : 'othersoftware',\n\t\t'DG7GMGF0DST5' : 'othersoftware',\n\t\t'DG7GMGF0DST6' : 'othersoftware',\n\t\t'DG7GMGF0DWP2' : 'othersoftware',  // sql server\n\n\n\t\t'8MB6CR05S1QD' : 'xboxplatform',\n\t  '8W68VXXMN260' : 'xboxplatform', // forza\n\t\t'9NV34NLCLG81' : 'xboxplatform', // forza\n\t\t'8SVG47RPZDDN' : 'xboxplatform', \n\n\t\t'8MC6K8M228SK' : 'surface',\n\t\t'8MCPZJJCC98C' : 'surface',\n\t\t'8N1V4QJ3GQ5X' : 'surface',\n\t\t'8NKT9WTTRBJK' : 'surface',\n\t\t'8RKCLMWPW1PP' : 'surface',\n\t\t'8XCW9BBPVFV9' : 'surface',\n\t\t'907TDS4DGWWV' : 'surface',\n\t\t'90FC23DV6SNZ' : 'surface',\n\t\t'93LTM69S3RFF' : 'surface',\n\n\t\t'8XF18PQZ17TS' : 'hololens',\n\t\t'90MDTZVL02K9' : 'hololens',\n\t\t'944XGCF64Z5B' : 'hololens',\n          \n        '91PNZZZNZWCP' : 'hololens', //device\n        '8TQMXX9XJFLL' : 'hololens', //acc\n        '8WXL8WMK1F7Z' : 'hololens', //acc\n        '8VJ21F2Z8PK5' : 'hololens', //acc\n\t\t\n\t\t'900WZDF9XJVG' : 'xboxdesignlabs',\n\t\t'93JLLWMDZ0V7' : 'xboxdesignlabs',\n\t\t'941H3FP99RM3' : 'xboxdesignlabs',\n\t\t'8TBJW32WJF8C' : 'xboxdesignlabs',\n\t\t'90T6CGN08P38' : 'xboxdesignlabs',\n\t\t'90K4SGTLSKML' : 'xboxdesignlabs',\n\t\t'8VK59S4SSLWD' : 'xboxdesignlabs',\n\t\t'8TVCQSJ7V6PT' : 'xboxdesignlabs',\n\t\t'8T07Q5SRTV11' : 'xboxdesignlabs',\n\t\t'8VKFWF7M03NJ' : 'xboxdesignlabs',\n\t\t'90GBR9CZBHJ9' : 'xboxdesignlabs',\n\t\t'9355VZP4KXB8' : 'xboxdesignlabs',\n\t\t'8QT59S4FDX8Z' : 'xboxdesignlabs',\n\t\t'936X3M90WS2S' : 'xboxdesignlabs', // configs\n\t\t'9102F5Z9J68L' : 'xboxdesignlabs', // configs\n\t\t'8ST76B99KP7D' : 'xboxdesignlabs', // configs\n\t\t'90SX28477R3L' : 'xboxdesignlabs', // configs\n\t\t\n\t\t'CFQ7TTC0K5ZM' : 'xboxlive',\n\t  'CFQ7TTC0K5DJ' : 'xboxlive',\n\t\t\n\t\t'CFQ7TTC0K5F8' : 'office',\n\t\t'CFQ7TTC0K5FD' : 'office',\n\t\t'CFQ7TTC0K5FF' : 'office',\n\t\t'CFQ7TTC0K5BB' : 'office',\n\t\t'CFQ7TTC0K5BC' : 'office',\n\t\t'CFQ7TTC0K5BD' : 'office',\n\t\t'8N0LL43Q1H85' : 'office',\n\t\t'CFQ7TTC0K5DZ' : 'office',\n\t\t'CFQ7TTC0K5F2' : 'office',\n\t\t'CFQ7TTC0K5F3' : 'office',\n\t\t'CFQ7TTC0K5BH' : 'office',\n\t\t'CFQ7TTC0K5D6' : 'office',\n\t\t'CFQ7TTC0K5D7' : 'office',\n\t\t'CFQ7TTC0K5CD' : 'office',\n\t\t'CFQ7TTC0K5CF' : 'office',\n\t\t'CFQ7TTC0K5CP' : 'office',\n\t\t'CFQ7TTC0K5CS' : 'office',\n\t\t'CFQ7TTC0K5CT' : 'office',\n\t\t'CFQ7TTC0K5D0' : 'office',\n\t\t'CFQ7TTC0K5DN' : 'office',\n\t\t'CFQ7TTC0K5DM' : 'office',\n\t\t'CFQ7TTC0K5BF' : 'office',\n\t\t'CFQ7TTC0K5FB' : 'office',\n\t\t'CFQ7TTC0K5FC' : 'office',\n\t\t'CFQ7TTC0K5D2' : 'office',  // project  4/2/18\n\t\t'CFQ7TTC0K5DB' : 'office',  // visio  4/2/18\n\t\t'CFQ7TTC0K5CW' : 'office',  // visio  4/2/18\n          \n         // added 4/20/20 for alta\n\t\t'8PC5BJBHN74P' : 'office',\n\t\t'94CM694VJ57P' : 'office',\n\t\t'900RPBX20TS6' : 'office',\n\t\t'93R684WJ71VJ' : 'office',\n\t\t'8V9J0T4JFZ6W' : 'office',\n\t\t'8NFJC88FKMRZ' : 'office',\n\t\t'8SZWM812T6N1' : 'office',\n\t\t'CFQ7TTC0K5BG' : 'office',\n\t\t'8V883X3J1V40' : 'office',\n        // end alta\n\n         // post-alta\n        '8Q3ZWVGG3FQC' : 'office',\n        '8N98X0XQT2FQ' : 'office',\n        '8PRQ1VSC8Q22' : 'office',\n        '8NVJD5ZKHMFX' : 'office',\n        '94924XCG402M' : 'xboxplatform',\n        '942ZHD9DCWXM' : 'xboxplatform',\n        // end post-alta\n          \n\t  '8V9DP4LNKNSZ' : 'surface',  // surface go added 7/10/18\n\t  \n\t\t// xbox games  9/27/18\n\t\t'8XMZ4ZZX5JT8' : 'xboxplatform',\n\t\t'8N4KPS2M97J6' : 'xboxplatform',\n\t\t'BTH9X5LM11MV' : 'xboxplatform',\n\t\t'8MSBS8Q55DBG' : 'xboxplatform',\n\t\t'BR8QZQXJVQD0' : 'xboxplatform',\n\n\t\t// 10/8/18\n\t\t'8Z1WM755TWGX' : 'xboxplatform', \n\t\t'C3C71TV51SQC' : 'xboxplatform', \n\t\t'8TSHP571GP11' : 'xboxplatform',\n\t\t'CFQ7TTC0K7Q8' : 'office',  \n\t\t'CFQ7TTC0K7DX' : 'office', \n\t\t'CFQ7TTC0K7C4' : 'office',\n\t\t'CFQ7TTC0K7C6' : 'office',\n\t\t'CFQ7TTC0K7C3' : 'office',\n\t\t'CFQ7TTC0K7C7' : 'office',\n\t\t'DG7GMGF0DW9S' : 'windowssoftware',\n\t\t'DG7GMGF0DS1G' : 'windowssoftware',\n\t\t'CFQ7TTC0K7CJ' : 'othersoftware',\n\t\t'CFQ7TTC0K7CH' : 'othersoftware',\n\t\t'CFQ7TTC0K7CF' : 'othersoftware',\n\t\t\n\t\t// 10/15/18\n\t\t'CFQ7TTC0K7C9': 'office',\n\t\t'CFQ7TTC0K7CG': 'office',\n\t\t'CFQ7TTC0K7CK': 'office',\n\t\t\n\t\t// 11/5/18\n\t\t'BPSWGQBW7R3G': 'xboxplatform', // red dead redemption 2\n\t\t'9NBLGGH4PBBM': 'xboxplatform', // Gears of War 4\n\t\t\n\t\t// 11/9/18\n\t\t'92594H05TKL3': 'xboxplatform', // fortnite bundle\n\t\t'8VDVCNF9F65W': 'xboxplatform', // playerunknowns battleground\n\t\t\n\t\t// 11/23/2018\n\t\t//'C0MN5DN8KR3F': 'xboxplatform', // playerunknowns full release\n\t\t'9PB2MZ1ZMB1S': 'winsoftdigital', // itunes\n\t\t'9WZDNCRFJ3TJ': 'winsoftdigital', // netflix\n\t\t'8NPV33DJ370P': 'xboxdesignlabs',\n\t\t'8Z1WFX3PP9BP': 'xboxdesignlabs',\n\t\t'8TN029PXKRTV': 'xboxdesignlabs',\n\t\t'8TMZXJV9D39G': 'xboxdesignlabs',\n          \n        // 10/21/19 -- all of the variations are for these BigIDs \n        'CFQ7TTC0K61W' : 'other',\t\n        'CFQ7TTC0K64F' : 'other',\t\n        'CFQ7TTC0K56K' : 'other',\n          \n        // 10/6/20 - Xbox Series X & S \n        '8T65QFQQ4K01' : 'xboxplatform',\t\n        '8RRVZ1VF9SF3' : 'xboxplatform',\n\n        // 10/12/20 - Xbox Game Pass (cfq7ttc0k6l8,CFQ7TTC0KGQ8,CFQ7TTC0KHS0)\n        'cfq7ttc0k6l8' : 'xboxgamepass',\t\n        'CFQ7TTC0KGQ8' : 'xboxgamepass',\n        'CFQ7TTC0KHS0' : 'xboxgamepass',\n\n\t\t// leave this as last\n\t\t'SHOULDNEVERMATCH' : 'pc'\n\t\t};\n\n\t\t// _TMDL.prdType and _TMDL.prdFam\n\t\t\n\t\tif (_TMDL.pids) {\n\t\t\tfor (var i = 0; i < _TMDL.pids.length; i++) {\n\t\t\t\tif (_TMDL.pids && _TMDL.pids[i] && pidexclude[_TMDL.pids[i]]) {\n\t\t\t\t\t// do nothing, not commissionable\n\t\t\t\t\t_TMDL.dcmcat[i]=\"excluded\";\n\t\t\t\t} else if (_TMDL.pidsku && _TMDL.pidsku[i] && skulist[_TMDL.pidsku[i]]) {\n\t\t\t\t\t// sku lookup based eventID\n\t\t\t\t\t_TMDL.dcmcat[i]=skulist[_TMDL.pidsku[i]];\n\t\t\t\t\tcategoryOrders[skulist[_TMDL.pidsku[i]]]++;\n\t\t\t\t\tcategoryAmounts[skulist[_TMDL.pidsku[i]]]+=_TMDL.sales[i];\n\t\t\t\t} else if (_TMDL.pids && _TMDL.pids[i] && pidlist[_TMDL.pids[i]]) {\n\t\t\t\t\t_TMDL.dcmcat[i]=pidlist[_TMDL.pids[i]];\n\t\t\t\t\tcategoryOrders[pidlist[_TMDL.pids[i]]]++;\n\t\t\t\t\tcategoryAmounts[pidlist[_TMDL.pids[i]]]+=_TMDL.sales[i];\n\t\t\t\t} else if (_TMDL.pnames && ~_TMDL.pnames[i].toLowerCase().indexOf(\"surface\") ) {\n\t\t\t\t\t_TMDL.dcmcat[i]=\"surface\";\n\t\t\t\t\tcategoryOrders[\"surface\"]++;\n\t\t\t\t\tcategoryAmounts[\"surface\"]+=_TMDL.sales[i];\n\t\t\t\t} else if (_TMDL.pnames && (~_TMDL.pnames[i].toLowerCase().indexOf(\"office\") || ~_TMDL.pnames[i].toLowerCase().indexOf(\"o365\"))) {\n\t\t\t\t\t_TMDL.dcmcat[i]=\"office\";\n\t\t\t\t\tcategoryOrders[\"office\"]++;\n\t\t\t\t\tcategoryAmounts[\"office\"]+=_TMDL.sales[i];\n\t\t\t\t} else if (_TMDL.pnames && ~_TMDL.pnames[i].toLowerCase().indexOf(\"minecraft\") ) {\n\t\t\t\t\t_TMDL.dcmcat[i]=\"minecraft\";\n\t\t\t\t\tcategoryOrders[\"minecraft\"]++;\n\t\t\t\t\tcategoryAmounts[\"minecraft\"]+=_TMDL.sales[i];\n\t\t\t\t} else if (_TMDL.pnames && ~_TMDL.pnames[i].toLowerCase().indexOf(\"xbox\")) {\n\t\t\t\t\t_TMDL.dcmcat[i]=\"xboxplatform\";\n\t\t\t\t\tcategoryOrders[\"xboxplatform\"]++;\n\t\t\t\t\tcategoryAmounts[\"xboxplatform\"]+=_TMDL.sales[i];\n\t\t\t\t} else if (_TMDL.pnames && matchXboxBrand(_TMDL.pnames[i]) ) {\n\t\t\t\t\t_TMDL.dcmcat[i]=\"xboxplatform\";\n\t\t\t\t\tcategoryOrders[\"xboxplatform\"]++;\n\t\t\t\t\tcategoryAmounts[\"xboxplatform\"]+=_TMDL.sales[i];\n\t\t\t\t} else if (_TMDL.pnames && matchWindowBrand(_TMDL.pnames[i]) ) {\n\t\t\t\t\t_TMDL.dcmcat[i]=\"windowsdevices\";\n\t\t\t\t\tcategoryOrders[\"windowsdevices\"]++;\n\t\t\t\t\tcategoryAmounts[\"windowsdevices\"]+=_TMDL.sales[i];\n\t\t\t\t} else if ((typeof _TMDL.prdType == \"object\") && (typeof _TMDL.prdType[i] == \"string\") && ~_TMDL.prdType[i].toLowerCase().indexOf(\"game\") && (~_TMDL.pnames[i].toLowerCase().indexOf(\"xbox\") || matchXboxBrand(_TMDL.pnames[i]) || _TMDL.sales[i]>0)) {\n\t\t\t\t\t// look for digital goods\n\t\t\t\t\t_TMDL.dcmcat[i]=\"xboxdigitalgames\";\n\t\t\t\t\tcategoryOrders[\"xboxdigitalgames\"]++;\n\t\t\t\t\tcategoryAmounts[\"xboxdigitalgames\"]+=_TMDL.sales[i];\n\t\t\t\t} else if ((typeof _TMDL.prdType == \"object\") && (typeof _TMDL.prdType[i] == \"string\") && _TMDL.prdType[i].toLowerCase().indexOf(\"device\")<0 && _TMDL.prdType[i].toLowerCase().indexOf(\"pass\")<0) {\n\t\t\t\t\t// look for digital goods\n\t\t\t\t\t_TMDL.dcmcat[i]=\"winsoftdigital\";\n\t\t\t\t\tcategoryOrders[\"winsoftdigital\"]++;\n\t\t\t\t\tcategoryAmounts[\"winsoftdigital\"]+=_TMDL.sales[i];\n\t\t\t\t} else {\n\t\t\t\t\t_TMDL.dcmcat[i]=\"other\";\n\t\t\t\t\tcategoryOrders[\"other\"]++;\n\t\t\t\t\tcategoryAmounts[\"other\"]+=_TMDL.sales[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\t\n\t\ttry {\n\t\t\tif (_TMutils.readCookie(\"MC1\")) {\n\t\t\t\tmc1 = _TMutils.readCookie(\"MC1\").split(\"&\")[0].split(\"=\")[1]; //use in u58\n\t\t\t}\n\t\t} catch(mc1err) {}\t\n\n\t\t// set the floodlights based on the page\n\t\tif (_TMDL.pageType==\"receipt\" || _TMDL.pageType==\"congrats\") {\n\t\t\tfloodlights = purchaseFloodlights;\n\t\t} else if (~_TMDL.pageType.indexOf(\"cart\")) {\n\t\t\tfloodlights = cartFloodlights;\n\t\t}\n\t\t\n\t\t// iterate through line items\n\t\tfor (key in categoryOrders) {\n\t\t\tif (categoryOrders[key]>0 && floodlights[key] !== \"exclude\") {\t\t\n\t\t\t\tpnames=[]; pids=[]; pidsku=[]; sales=[]; quantities=[]; totqty=0; totamt=0;\n\t\t\t\tconsole.log(key,categoryOrders[key],categoryAmounts[key],\"\\n\"); // make sure formatted as xx.xx\n\n\t\t\t\tfor (var line=0; line < _TMDL.pids.length; line++) {\n\t\t\t\t\tif (_TMDL.dcmcat[line] == key) {\t\n\t\t\t\t\t\tpnames.push(_TMDL.pnames[line]);\n\t\t\t\t\t\tpids.push(_TMDL.pids[line]);\n\t\t\t\t\t\tpidsku.push(_TMDL.pidsku[line]);\n\t\t\t\t\t\tsales.push(_TMDL.sales[line]);\n\t\t\t\t\t\tquantities.push(_TMDL.quantities[line]);\n\t\t\t\t\t\ttotqty+=_TMDL.quantities[line];\n\t\t\t\t\t\ttotamt+=_TMDL.sales[line];\t\n\t\t\t\t\t}\t\t\t\t\n\t\t\t\t}\n\n\t\t\t\timgsrc1 = \"https://ad.doubleclick.net/ddm/activity\"+floodlights[key]+\";qty=1;cost=\"+totamt+\";u1=\"+_TMDL.geo.toUpperCase()+\";u2=\"+_TMDL.ll\n\t\t\t\t\t//+\";u5=\"+encodeURIComponent(document.referrer)\n\t\t\t\t\t+\";u25=\"+pids.join(\"_\")\n\t\t\t\t\t+\";u26=\"+encodeURIComponent(pnames.join(\"_\"))\n\t\t\t\t\t+\";u58=\"+mc1\n\t\t\t\t\t+\";u31=\"+_TMDL.cc+\";u32=\"+pids.join(\"_\")+\";u33=\"+pidsku.join(\"_\")+\";u34=\"+_TMDL.purchaseID+\";u35=\"+totqty\n\t\t\t\t\t+\";u39=\"+sales.join(\"_\")+\";u40=\"+quantities.join(\"_\")\n\t\t\t\t\t+\";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=\"+_TMDL.purchaseID+\"?\";\n\t\t\t\timgsrc = imgsrc1;\n\t\t\t\tif (debug) {\n\t\t\t\t\tconsole.log(key,pnames.join(\"_\"),\"\\n\");\n\t\t\t\t\tconsole.log(imgsrc1,\"\\n\");\n\t\t\t\t} \n\t\t\t\tBootstrapper.imageRequest(imgsrc1);\n\t\t\t}\n\t\t}\n\n\t};\n\n\tdoFloodlights(0);var imgsrc=\"\";\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== \"undefined\") {_TMutils.logRuleCall(\"DCM Cart and Purchase\",err.message,imgsrc);}\n\t_satellite.logger.error(\"DCM Cart and Purchase\");\n}\n",language:"javascript"}}]},{id:"RL4f2bc935924f443e8a5d5f819389d319",name:"Media_/EN-US/Business Consultation Signup LinkedIn (AEM/RT)",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-us/store/b/business-consultation",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n// LinkedIn pixel\n$(\'a[href*="https://digitalreservations.microsoft.com/en-us/appointment/create"]\').on("mousedown", function () {\n  var image = new Image(1, 1);\n  image.src ="https://px.ads.linkedin.com/collect/?pid=7850&conversionId=4082786&fmt=gif";\n});\n  \n }\ncatch(err)\n{\n\t_satellite.logger.error("Media_/EN-US/Business Consultation Signup LinkedIn (AEM/RT)");\n}',language:"javascript"}}]},{id:"RL31a7aedc0d414d348830e9091f084726",name:"Media_/en-au/store/b/business Tax Day",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-au/store/b/business",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'\ntry\n{\n\njQuery("div.m-multi-hero, div.m-channel-placement:Lt(1), div.m-content-placement:Lt(1)").on("mousedown", function(){  \nvar image = new Image(1, 1);\nimage.src ="https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u50=CTA;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;ord=1?";\n\n});\n\n}\ncatch(err)\n{\n\t_satellite.logger.error("Media_/en-au/store/b/business Tax Day");\n}\n\n',language:"javascript"}}]},{id:"RL81d828f12cec453ba0309f909a2aaf39",name:"Media_/EN-US/d/surface Twitter (AEM/RT)",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-us/d/surface",valueIsRegex:!0},{value:"/en-us/d/surface/",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try {\n  \n  //Page Load\n  var image = new Image(1,1);\n  image.src = "https://analytics.twitter.com/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";\n  var image2 = new Image(1,1);\n  image2.src="//t.co/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";\n\n  \n   //Configure Now button\njQuery("a:contains(\'Configure now\'),button:contains(\'Configure now\')").on("mousedown", function(){\nvar image = new Image(1,1);\n  image.src = "https://analytics.twitter.com/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9u&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";\nvar image2 = new Image(1,1);  \n  image2.src="//t.co/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";\n});\n  \n   //Surface Laptop Go for Business Button\njQuery("[href=\'https://www.microsoft.com/en-us/p/surface-laptop-go-for-business/8NR6D2WCLC72?icid=PDP_LaptopGo_forbusiness_C97_060421\']").on("mousedown", function(){\nvar image = new Image(1,1);\n  image.src = "https://analytics.twitter.com/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";\nvar image2 = new Image(1,1);\n  image2.src="//t.co/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";\n});\n\n}\ncatch(err)\n{\n\t_satellite.logger.error("Media_/EN-US/d/surface Twitter (AEM/RT)");\n}',language:"javascript"}}]},{id:"RL3329950363d843f9a5524bfff31f3b56",name:"Media_/en-au/store/b/surface-accessories Tax Day",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-au/store/b/surface-accessories",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'\ntry\n{\n\njQuery("div.herohighlight, div.c-carousel, div.m-content-placement.x-clearfix").on("mousedown", function(){  \nvar image = new Image(1, 1);\nimage.src ="https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u50=CTA;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;ord=1?";\n\n});\n\n}\ncatch(err)\n{\n\t_satellite.logger.error("Media_/en-au/store/b/surface-accessories Tax Day");\n}\n\n',language:"javascript"}}]},{id:"RLae38a03ca6914b4dbd6fc77c006a5ad3",name:"XTAAMCVFSignals",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{
source:'// AAM Image Pixel for Cart Flow\ntry\n{\n\tvar pn = _TMDL.pageName,extraSignals = "",imgurl="",_ts;\n\n\tif (pn == "receipt" || pn=="congrats") {\n\t\textraSignals = \t"&c_purchasepid="+encodeURIComponent(_TMDL.pids.join("|"))\n\t\t\t\t\t\t+"&c_purchasepidsku="+encodeURIComponent(_TMDL.pidsku.join("|"))\n\t\t\t\t\t\t+"&c_purchasepnames="+encodeURIComponent(_TMDL.pnames.join("|"))\n\t\t\t\t\t\t\n\t} else if (~pn.indexOf("interstitial") || ~pn.indexOf("cart")) {\n\t\textraSignals = \t"&c_cartpid="+encodeURIComponent(_TMDL.pids.join("|"))\n\t\t\t\t\t+"&c_cartpidsku="+encodeURIComponent(_TMDL.pidsku.join("|"))\n\t\t\t\t\t+"&c_cartpnames="+encodeURIComponent(_TMDL.pnames.join("|"));\n\t} \n\n\tif (extraSignals) {\n\t\t_ts= (new Date).getTime();\n\t\timgurl = "https://mscom.demdex.net/event?d_nsid=0&d_ld=_ts%3D"+_ts+"&d_rtbd=json&d_jsonv=1&d_dst=1"\n\t\t//+"&d_cb=demdexRequestCallback_0_1521748306026"\n\t\t+"&c_ms.siteorg=Retail&c_ms.sitename=Store"\n\t\t+"&c_ms.pagetype="+_TMDL.pageType\n\t\t+"&c_ms.sup_ln="+_TMDL.ll\n\t\t+extraSignals;\n\n\t\tBootstrapper.imageRequest(imgurl);\n\t}\n}\ncatch(err)\n{\n\t_satellite.logger.error("XTAAMCVG");\t\n}',language:"javascript"}}]},{id:"RL9effe5e8fdb64618b9c8c6b182f342ae",name:"XboxGrCPE_PMP CTA",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:70}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"(us|ca|au|gb)\\/store\\/b\\/xbox",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'// OVERWRITES jquery contains to make it case insensitive\njQuery.expr[\':\'].contains = function(a, i, m) {\n  return jQuery(a).text().toUpperCase()\n      .indexOf(m[3].toUpperCase()) >= 0;\n};\n\nvar debug=0,fireDCM=1;\nvar ll=_TMDL.geo.toLowerCase();\n\nfunction attachAnalyticsToElement(elementAddress, actionName, actionURL) {\n\t$(document).on(\'mousedown\', elementAddress, \'\', function() {\n\t\tif (debug) { \n\t\t\tconsole.log(actionName); \n\t\t}\n\n\t\tvar j={},pid="",cN="",u="",hr="";\n\t\tvar\ta = "" + (Math.random() * 10000000000000);\n\n\t\ttry {\n\t\t\tj=JSON.parse($(this).attr("data-m"));\n\t\t\tpid = j.pid;\n\t\t\tcN= j.cN;\n\t\t\t//hr=this.href;\n\t\t} catch(proderr) {\n\t\t\tif (debug) { \n\t\t\t\tconsole.log("catch "+ actionName + " " + hr); \n\t\t\t}\n\t\t}\n\n\t\tu=actionURL + ";u1="\n\t\t+_TMDL.geo\n\t\t+";u2="+_TMDL.ll\n\t\t+";u6="+encodeURIComponent(window.location.pathname)\n\t\t+";u25="+pid\n\t\t+";u26="+encodeURIComponent(cN)\n\t\t+";u50="+encodeURIComponent(cN)\n\t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="\t+ a + "?";\n\n\t\tif (debug) { \n\t\t\tconsole.log(actionName+" u25="+pid+" u26="+cN+"\\t"+u); \n\t\t}\n\n\t\tif (fireDCM) {\n\t\t\tBootstrapper.imageRequest(u);\n\t\t}\n\t});\n}\n\n\nif (ll=="us" || ll=="ca" || ll=="gb" || ll=="au") {\n\ttry {\n\t\tattachAnalyticsToElement(\n\t\t\t\'a.small-icon, a.f-image\',\n\t\t\t\'Hero banner click on Learn More or Free Return & Shipping Icons above the hero\',\n\t\t\t\'https://ad.doubleclick.net/ddm/activity/src=8391491;type=xbxp;cat=lrn_std\');\n\n\t\tattachAnalyticsToElement(\n\t\t\t"div[id*=\'oneStore-quicklinksmodule-\'] a.large-icon, div[id*=\'coreui-hero-\'] ul li:contains(\'SHOP NOW\'), div[id*=\'coreui-hero-\'] ul li:contains(\'Shop now\')",\n\t\t\t\'Hero banner click on Shop Now or icon menu below banner\',\n\t\t\t\'https://ad.doubleclick.net/ddm/activity/src=8391491;type=xbxp;cat=pchn_std\');\n\n\t\tattachAnalyticsToElement(\n\t\t\t"div[id*=\'coreui-hero-\'] ul li:contains(\'Learn more\')",\n\t\t\t\'Hero banner click on Learn More\',\n\t\t\t\'https://ad.doubleclick.net/ddm/activity/src=8391491;type=xbxp;cat=lrn_std\');\n\n\t\tattachAnalyticsToElement(\n\t\t\t"div:contains(\'Shop\') section.m-content-placement-item, div:contains(\'Join\') section.m-content-placement-item",\n\t\t\t\'Click on c-call-to-action Shop Now\',\n\t\t\t\'https://ad.doubleclick.net/ddm/activity/src=8391491;type=xbxp;cat=pchn_std\');\n\n\t\tattachAnalyticsToElement(\n\t\t\t"div[id*=\'coreui-productplacement\'] div.m-channel-placement-item, div[id*=\'coreui-productplacement\'] a.c-hyperlink",\n\t\t\t\'Click on m-channel-placement on the product trays\',\n\t\t\t\'https://ad.doubleclick.net/ddm/activity/src=8391491;type=xbxp;cat=pchn_std\');\n\n\t\tattachAnalyticsToElement(\n\t\t\t"div:contains(\'Learn more\') section.m-content-placement-item",\n\t\t\t\'Click on c-call-to-action Learn More\',\n\t\t\t\'https://ad.doubleclick.net/ddm/activity/src=8391491;type=xbxp;cat=lrn_std\');\n\t} catch(clkerr) {\n\t\tconsole.log("Xbox PMP CPE Error");\n\t}\n}',language:"javascript"}}]},{id:"RL4291be31c51a49aca3a412fadc14bca7",name:"Holiday Sale Page",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"\\/store\\/b\\/sale",valueIsRegex:!0},{value:"(en-ca|fr-ca)\\/store\\/b\\/boxing-week",valueIsRegex:!0},{value:"(us|ca|jp|au)\\/store\\/b\\/cyber-monday",valueIsRegex:!0},{value:"(us|ca|jp|au)\\/store\\/b\\/black-friday",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/dateRange.js",settings:{end:"2022-02-01T00:00:00Z",start:"2021-10-28T00:00:00Z"}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'// Holiday Script\nvar debug = 0, fireTags = 1;\nvar ehnsToAvoid = ["Extended free returns", "Pick the perfect gift with a product expert", "Fast, free shipping", "Our best price of the season", "90 days of free support", "60-day low price promise", "Free returns", "Free shipping"];\nvar usAndSingapore = \'div.card, \';\nvar div_enCa = \'div#coreui-contentplacement-f5d4afi, div#coreui-contentplacement-lzrgp5j, \';\nvar div_frca = \'div#coreui-contentplacement-h1khlym, div#coreui-contentplacement-y1o0trq, \';\nvar div_frfr = \'div#coreui-contentplacement-qxreqji, div#StoreLocations-HighlightHero-6ywe7ix div div div div ul, \';\nvar div_jajp = \'div#coreui-contentplacement-zlfss3q, div#coreui-hero-npd01s8 div div div ul, \';\nvar div_dede = \'div#coreui-contentplacement-a4imfpx, div#coreui-contentplacement-grqvg59, div#coreui-featurecollection-t1clixa div section ul, \';\nvar div_engb = \'div#coreui-contentplacement-fiqwvm2, div#coreui-contentplacement-bkhqr5t, div#coreui-contentplacement-ntwsdzm, \';\nvar div_enau = \'div#StoreLocations-HighlightHero-0qj0sa2, div#coreui-contentplacement-pwrxlcn, \';\nvar div_row = \'div.m-channel-placement a\';\nvar allLocales = "" + usAndSingapore + div_enCa + div_frca + div_frfr + div_jajp + div_dede + div_engb + div_enau + div_row;\n\ntry {\n\t$(document).on(\'mousedown\', allLocales, \'\', function () {\n\t\tif (debug) { console.log("Tag is running") }\n\n\t\t// to prevent the US site from running the Microsoft store promise section\n\t\tvar ehn = $(this).attr("data-bi-ehn");\n\t\tif (ehn && ehnsToAvoid.includes(ehn)) {\n\t\t\tfireTags = 0;\n\t\t\tif (debug) {console.log("avoiding")}\n\t\t}\n\n\t\tvar rand = parseInt(Math.random() * 10000000000000);\n\t\tif (fireTags) {\n\t\t\tBootstrapper.imageRequest("https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50188&ActionName=Store_Site_Visit&cachebuster=" + rand);\n\t\t\tBootstrapper.imageRequest("https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick");\n\t\t\tBootstrapper.imageRequest("https://secure.adnxs.com/px?id=1268102&t=2");\n\t\t}\n\t\tfireTags = 1;\n\n\t});\n} catch (clkerr) { console.log("sale page err"); }',language:"javascript"}}]},{id:"RL786094462b894139ab3b2c6dee7ade87",name:"Media_/LL-LL/Business Consultation Signup Facebook (RT)",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-au/store/b/business-consultation",valueIsRegex:!0},{value:"/en-gb/store/b/business-consultation",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}},{modulePath:"core/src/lib/conditions/dateRange.js",settings:{end:"2021-12-31T00:00:00Z",start:"2021-07-12T00:00:00Z"}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n// Facebook\n jQuery("a.c-hyperlink:Lt(1),a.c-call-to-action:Lt(1)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="https://www.facebook.com/tr?id=1770559986549030&amp&ev=CompleteRegistration&cd[content_names]=["+encodeURIComponent(_TMDL.pagename) + "]";\n  \n });\n }\ncatch(err)\n{\n\t_satellite.logger.error("Media_/LL-LL/Business Consultation Signup Facebook (RT)");\n}\n',language:"javascript"}}]},{id:"RL289b7578fe5749c98866fb2212076816",name:"Surface_XANDR /d/ LP",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:70}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-us/d/surface-go/8v9dp4lnknsz",valueIsRegex:!0},{value:"/en-us/d/surface-book-2/8mcpzjjcc98c",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'if (~window.location.pathname.toLowerCase().indexOf("surface") && ~window.location.pathname.toLowerCase().indexOf("/d/")) {\n\tif (~window.location.pathname.toLowerCase().indexOf("/en-us/d/surface-go/8v9dp4lnknsz")){\n\t\tBootstrapper.imageRequest("https://secure.adnxs.com/px?id=1182093&seg=19686450&t=2");\t\n\t} else if (~window.location.pathname.toLowerCase().indexOf("/en-us/d/surface-book-2/8mcpzjjcc98c")){\n\t\tBootstrapper.imageRequest("https://secure.adnxs.com/px?id=1182149&seg=19686725&t=2");\t\t\n\t} \t\n}',language:"javascript"}}]},{id:"RLbce7faddd577453299ebe0a2cad2a168",name:"Media.Verizon.Surface_081620 (AEM/RT)",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"(/en-us)\\/p\\/surface",valueIsRegex:!0},{value:"(/en-us)\\/d\\/surface",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n  \n // Promo Bar\n  \njQuery("a:contains(\'Book your online appointment\')")\n.on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=SurfaceButtonClick";\n});\n  \njQuery("a:contains(\'Build your bundle\')")\n.on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=SurfaceButtonClick";\n});\n  \njQuery("a:contains(\'Learn more about promise\')")\n.on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=SurfaceButtonClick";\n});\n  \njQuery("a[href*=\'/en-us/p/surface\']").filter(\'a:contains("BUSINESS")\')\n.on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=SurfaceButtonClick";\n});\n  \n \n //Configure now & Sticky\njQuery("a:contains(\'Configure now\'),button:contains(\'Configure now\')")\n.on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=SurfaceButtonClick";\n});\n  \n}\ncatch(err)\n{\n\t_satellite.logger.error("Media.Verizon.Surface_081620 (AEM/RT)");\n}\n',language:"javascript"}}]},{id:"RL427b9e2007e24b8fb1e06bfec30434ac",name:"IRLP",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"www.microsoft.com"==window.location.host.toLowerCase()}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"try\n{\n\tvar marketMap = {\n\t\t'NZ' : 'A1143145-4ed3-453a-8ac9-f0c166db12591',\n\t\t'AU' : 'A1143145-4ed3-453a-8ac9-f0c166db12591',\n\t\t'CA' : 'A1143100-98df-45ee-8c6e-2dec4e6eb56e1',\n\t\t'BG' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',\n\t\t'RU' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1', //added for CEE\n\t\t'HR' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',\n\t\t'CY' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',\n\t\t'HU' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',\n\t\t'SK' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',\n\t\t'EE' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',\n\t\t'CZ' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',\n\t\t'GR' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',\n\t\t'LT' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',\n\t\t'PL' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',\n\t\t'FR' : 'A1143111-30b6-46be-bbab-c7bbbca8eb991',\n\t\t'TW' : 'A1143121-28a1-47b0-8a2c-8128049efd901',\n\t\t'HK' : 'A1143121-28a1-47b0-8a2c-8128049efd901',\n\t\t'CN' : 'A1143121-28a1-47b0-8a2c-8128049efd901',\n\t\t'DE' : 'A1143124-6b0f-4685-b9ab-e289200ad2901',\n\t\t'IN' : 'A1143126-787b-4983-ad6f-e804972459e91',\n\t\t'JP' : 'A1143130-b81e-4371-9b61-b590cea59c051',\n\t\t'BO' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'DO' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'GT' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'HN' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'PA' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'PY' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'SV' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'VE' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'EC' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'CR' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'PE' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'CL' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'AR' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'MX' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',  // was MEX\n\t\t'BR' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'BS' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'BB' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'CO' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'JM' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'NI' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'TT' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'UY' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'BH' : 'A1143144-62f4-44be-93a3-7c960374e2961',\n\t\t'MA' : 'A1143144-62f4-44be-93a3-7c960374e2961',\n\t\t'OM' : 'A1143144-62f4-44be-93a3-7c960374e2961',\n\t\t'QA' : 'A1143144-62f4-44be-93a3-7c960374e2961',\n\t\t'NG' : 'A1143144-62f4-44be-93a3-7c960374e2961',\n\t\t'KW' : 'A1143144-62f4-44be-93a3-7c960374e2961',\n\t\t'EG' : 'A1143144-62f4-44be-93a3-7c960374e2961',\n\t\t'SA' : 'A1143144-62f4-44be-93a3-7c960374e2961',\n\t\t'IL' : 'A1143144-62f4-44be-93a3-7c960374e2961',\n\t\t'ZA' : 'A1143144-62f4-44be-93a3-7c960374e2961',\n\t\t'TR' : 'A1143144-62f4-44be-93a3-7c960374e2961',\n\t\t'AE' : 'A1143144-62f4-44be-93a3-7c960374e2961', // was UAE\n\t\t'PH' : 'A1143145-4ed3-453a-8ac9-f0c166db12591',\n\t\t'TH' : 'A1143145-4ed3-453a-8ac9-f0c166db12591',\n\t\t'ID' : 'A1143145-4ed3-453a-8ac9-f0c166db12591',\n\t\t'MY' : 'A1143145-4ed3-453a-8ac9-f0c166db12591',\n\t\t'KR' : 'A1143145-4ed3-453a-8ac9-f0c166db12591',\n\t\t'SG' : 'A1143145-4ed3-453a-8ac9-f0c166db12591',\n\t\t'GB' : 'A1143151-5b4f-4392-9e5d-0d32d4dda7b21',\n\t\t'UK' : 'A1143151-5b4f-4392-9e5d-0d32d4dda7b21',\n\t\t'PR' : 'A1133099-331c-4cdf-89b0-06dc20e168021', // map to US\n\t\t'US' : 'A1133099-331c-4cdf-89b0-06dc20e168021',\n\t\t'LU' : 'A1143167-163d-430c-aa98-4062268d1ce01', // was LUX\n\t\t'BE' : 'A1143167-163d-430c-aa98-4062268d1ce01',\n\t\t'IE' : 'A1143151-5b4f-4392-9e5d-0d32d4dda7b21', // map to GB/UK\n\t\t'AT' : 'A1143124-6b0f-4685-b9ab-e289200ad2901', // map to DE\n\t\t'NL' : 'A1143167-163d-430c-aa98-4062268d1ce01',\n\t\t'FI' : 'A1143167-163d-430c-aa98-4062268d1ce01',\n\t\t'DK' : 'A1143167-163d-430c-aa98-4062268d1ce01',\n\t\t'NO' : 'A1143167-163d-430c-aa98-4062268d1ce01',\n\t\t'SE' : 'A1143167-163d-430c-aa98-4062268d1ce01',\n\t\t'PT' : 'A1143167-163d-430c-aa98-4062268d1ce01',\n\t\t'IT' : 'A1143167-163d-430c-aa98-4062268d1ce01',\n\t\t'ES' : 'A1143167-163d-430c-aa98-4062268d1ce01',\n\t\t'CH' : 'A1143124-6b0f-4685-b9ab-e289200ad2901',  // map to DE\n\t\t// FR\n\t\t'RE' : 'A1143111-30b6-46be-bbab-c7bbbca8eb991',\n\t\t'NC' : 'A1143111-30b6-46be-bbab-c7bbbca8eb991',\n\t\t'AD' : 'A1143111-30b6-46be-bbab-c7bbbca8eb991',\n\t\t// APAC TH\n\t\t'VN' : 'A1143145-4ed3-453a-8ac9-f0c166db12591',\n\t\t'PF' : 'A1143145-4ed3-453a-8ac9-f0c166db12591',\n\t\t'KH' : 'A1143145-4ed3-453a-8ac9-f0c166db12591',\n\t\t'LA' : 'A1143145-4ed3-453a-8ac9-f0c166db12591',\n\t\t//'GA' : 'A1143145-4ed3-453a-8ac9-f0c166db12591', removed to map to MEA\n\n\t\t// FI\n\t\t'IS' : 'A1143167-163d-430c-aa98-4062268d1ce01',\n\t\t'GL' : 'A1143167-163d-430c-aa98-4062268d1ce01',\n\t\t// IN\n\t\t'PK' : 'A1143126-787b-4983-ad6f-e804972459e91',\n\t\t'LK' : 'A1143126-787b-4983-ad6f-e804972459e91',\n\t\t'BD' : 'A1143126-787b-4983-ad6f-e804972459e91',\n\t\t'NP' : 'A1143126-787b-4983-ad6f-e804972459e91',\n\t\t'MM' : 'A1143126-787b-4983-ad6f-e804972459e91',\n\t\t// LATAM\n\t\t'GP' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'KY' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t// NL\n\t\t'AW' : 'A1143167-163d-430c-aa98-4062268d1ce01',\n\t\t// US\n\t\t'GU' : 'A1133099-331c-4cdf-89b0-06dc20e168021',\n\t\t'BM' : 'A1133099-331c-4cdf-89b0-06dc20e168021',\n\t\t'VI' : 'A1133099-331c-4cdf-89b0-06dc20e168021',\n\t\t// UK\n\t\t'JE' : 'A1143151-5b4f-4392-9e5d-0d32d4dda7b21',\n\t\t// CEE\n\t\t'RO' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'UA' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'SI' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'MT' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'LV' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'MU' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'KZ' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'RS' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'BY' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'BA' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'GE' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'AL' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'AM' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'MK' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'MD' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'AZ' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'UZ' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1'  // added to CEE\n\t\t// Everything else map to MEA\n\t};\n\n\tvar mapstring=\"\";\n\tvar u=\"\";\n\n\tif(_TMDL && marketMap[(_TMDL.geo).toUpperCase()] ){mapstring = marketMap[(_TMDL.geo).toUpperCase()];}\n\t\n\tif (mapstring==\"\") {\n\t\t// map to MEA as catchall\n\t\tmapstring = 'A1143144-62f4-44be-93a3-7c960374e2961';\n\t}\n\n\tu = \"https://d.impactradius-event.com/\"+mapstring+\".js\";\n\n\t(function (a, b, c, d, e, f, g) {\n\t\te['ire_o'] = c;\n\t\te[c] = e[c] || function () {\n\t\t\t(e[c].a = e[c].a || []).push(arguments);\n\t\t};\n\t\tf = d.createElement(b);\n\t\tg = d.getElementsByTagName(b)[0];\n\t\tf.async = 1;\n\t\tf.src = a;\n\t\tif (a) {\n\t\t\tg.parentNode.insertBefore(f, g);\n\t\t}\n\t})(u, 'script', 'ire', document, window);\n\n\tire('identify', {customerId: '', customerEmail: ''});\n}\ncatch(err)\n{\n\t_satellite.logger.error(\"IRLP\");\t\n}",language:"javascript"}}]},{id:"RL45841b807ebc4e208726abe1ec8503f4",name:"XboxGrCPE_PMP /EN-US/ (AEM/RT)",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:70}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-us/store/b/xbox",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'//OVERWRITES jquery contains to make it case insensitive\njQuery.expr[\':\'].contains = function(a, i, m) {\n  return jQuery(a).text().toUpperCase()\n      .indexOf(m[3].toUpperCase()) >= 0;\n};\n\nvar debug=0,fireDCM=1;\nvar ll=_TMDL.geo.toLowerCase();\n\nfunction attachAnalyticsToElement(elementAddress, actionName, actionURL) {\n\t$(document).on(\'mousedown\', elementAddress, \'\', function() {\n\t\tif (debug) { \n\t\t\tconsole.log(actionName); \n\t\t}\n\n\t\tvar j={},pid="",cN="",u="",hr="";\n\t\tvar\ta = "" + (Math.random() * 10000000000000);\n\n\t\ttry {\n\t\t\tj=JSON.parse($(this).attr("data-m"));\n\t\t\tpid = j.pid;\n\t\t\tcN= j.cN;\n\t\t\t//hr=this.href;\n\t\t} catch(proderr) {\n\t\t\tif (debug) { \n\t\t\t\tconsole.log("catch "+ actionName + " " + hr); \n\t\t\t}\n\t\t}\n\n\t\tu=actionURL + ";u1="\n\t\t+_TMDL.geo\n\t\t+";u2="+_TMDL.ll\n\t\t+";u6="+encodeURIComponent(window.location.pathname)\n\t\t+";u25="+pid\n\t\t+";u26="+encodeURIComponent(cN)\n\t\t+";u50="+encodeURIComponent(cN)\n\t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="\t+ a + "?";\n\n\t\tif (debug) { \n\t\t\tconsole.log(actionName+" u25="+pid+" u26="+cN+"\\t"+u); \n\t\t}\n\n\t\tif (fireDCM) {\n\t\t\tBootstrapper.imageRequest(u);\n\t\t}\n\t});\n}\n\n\nif (ll=="us" || ll=="ca" || ll=="gb" || ll=="au") {\n\ttry {\n\t\tattachAnalyticsToElement(\n\t\t\t\'a.small-icon, a.f-image\',\n\t\t\t\'Hero banner click on Learn More or Free Return & Shipping Icons above the hero\',\n\t\t\t\'https://ad.doubleclick.net/ddm/activity/src=8391491;type=xbxp;cat=lrn_std\');\n\n\t\tattachAnalyticsToElement(\n\t\t\t"div[id*=\'oneStore-quicklinksmodule-\'] a.large-icon, div[id*=\'coreui-hero-\'] ul li:contains(\'SHOP NOW\'), div[id*=\'coreui-hero-\'] ul li:contains(\'Shop now\')",\n\t\t\t\'Hero banner click on Shop Now or icon menu below banner\',\n\t\t\t\'https://ad.doubleclick.net/ddm/activity/src=8391491;type=xbxp;cat=pchn_std\');\n\n\t\tattachAnalyticsToElement(\n\t\t\t"div[id*=\'coreui-hero-\'] ul li:contains(\'Learn more\')",\n\t\t\t\'Hero banner click on Learn More\',\n\t\t\t\'https://ad.doubleclick.net/ddm/activity/src=8391491;type=xbxp;cat=lrn_std\');\n\n\t\tattachAnalyticsToElement(\n\t\t\t"div:contains(\'Shop\') section.m-content-placement-item, div:contains(\'Join\') section.m-content-placement-item",\n\t\t\t\'Click on c-call-to-action Shop Now\',\n\t\t\t\'https://ad.doubleclick.net/ddm/activity/src=8391491;type=xbxp;cat=pchn_std\');\n\n\t\tattachAnalyticsToElement(\n\t\t\t"div[id*=\'coreui-productplacement\'] div.m-channel-placement-item, div[id*=\'coreui-productplacement\'] a.c-hyperlink",\n\t\t\t\'Click on m-channel-placement on the product trays\',\n\t\t\t\'https://ad.doubleclick.net/ddm/activity/src=8391491;type=xbxp;cat=pchn_std\');\n\n\t\tattachAnalyticsToElement(\n\t\t\t"div:contains(\'Learn more\') section.m-content-placement-item",\n\t\t\t\'Click on c-call-to-action Learn More\',\n\t\t\t\'https://ad.doubleclick.net/ddm/activity/src=8391491;type=xbxp;cat=lrn_std\');\n\t} catch(clkerr) {\n\t\tconsole.log("Xbox PMP CPE Error");\n\t}\n}',language:"javascript"}}]},{id:"RLa64cd18cd78841478da1c58fca9971e0",name:"Media_/LL-LL/Surface Adobe DCO (RT)",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/p/surface",valueIsRegex:!0},{value:"/d/surface",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-us/",valueIsRegex:!0}]},negate:!0}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n// Configure Now buttons\n jQuery("button[id*=\'ConfigureDeviceButton\']").on("mousedown", function(){\n    var rand1 = parseInt(Math.random() * 10000000000000);\n    var image = new Image(1, 1);\n    image.src ="https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50188&ActionName=Store_Site_Visit&cachebuster=" + rand1;\n});\n  \n//Check Your Eligibility button\n jQuery(\'a[href*="student-discounts?successurl"]\').on("mousedown", function(){\n   var rand2 = parseInt(Math.random() * 10000000000000);\n   var image = new Image(1, 1);\n   image.src ="https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50188&ActionName=Store_Site_Visit&cachebuster=" + rand2;\n});\n  \n//Promotional Bar links\n jQuery("div.pi-promotion-bar").on("mousedown", function(){\n   var rand3 = parseInt(Math.random() * 10000000000000);\n   var image = new Image(1, 1);\n   image.src ="https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50188&ActionName=Store_Site_Visit&cachebuster=" + rand3;\n});\n  \n }\ncatch(err)\n{\n\t_satellite.logger.error("Media_/LL-LL/Surface Adobe DCO (RT)");\n}\n',language:"javascript"}}]},{id:"RL3846f5bb89ac402c9528c708ad36d21f",name:"SurfaceGrowthCPE",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"(us|ca|de|au|gb|sg|fr|jp)\\/p\\/surface-book-3",valueIsRegex:!0},{value:"(us|ca|de|au|gb|sg|fr|jp)\\/p\\/surface-go-2",valueIsRegex:!0},{value:"(us|ca|de|au|gb|sg|fr|jp)\\/d\\/surface-book-3",valueIsRegex:!0},{value:"(us|ca|de|au|gb|sg|fr|jp)\\/d\\/surface-go-2",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'// OVERWRITES jquery contains to make it case insensitive\njQuery.expr[\':\'].contains = function(a, i, m) {\n  return jQuery(a).text().toUpperCase()\n      .indexOf(m[3].toUpperCase()) >= 0;\n};\n\nvar debug=0,fireDCM=1;\nvar ll=_TMDL.geo.toLowerCase();\n\nfunction attachAnalyticsToElement(elementAddress, actionName, actionURL) {\n\t$(document).on(\'mousedown\', elementAddress, \'\', function() {\n\t\tif (debug) { \n\t\t\tconsole.log(actionName); \n\t\t}\n\n\t\tvar j={},pid="",cN="",u="",hr="";\n\t\tvar\ta = "" + (Math.random() * 10000000000000);\n\n\t\ttry {\n\t\t\tj=JSON.parse($(this).attr("data-m"));\n\t\t\tpid = j.pid;\n\t\t\tcN= j.cN;\n\t\t\t//hr=this.href;\n\t\t} catch(proderr) {\n\t\t\tif (debug) { \n\t\t\t\tconsole.log("catch "+ actionName + " " + hr); \n\t\t\t}\n\t\t}\n\n\t\tu=actionURL + ";u1="\n\t\t+_TMDL.geo\n\t\t+";u2="+_TMDL.ll\n\t\t+";u6="+encodeURIComponent(window.location.pathname)\n\t\t+";u25="+pid\n\t\t+";u26="+encodeURIComponent(cN)\n\t\t+";u50="+encodeURIComponent(cN)\n\t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="\t+ a + "?";\n\n\t\tif (debug) { \n\t\t\tconsole.log(actionName+" u25="+pid+" u26="+cN+"\\t"+u); \n\t\t}\n\n\t\tif (fireDCM) {\n\t\t\tBootstrapper.imageRequest(u);\n\t\t}\n\t});\n}\n\ntry {\n\tattachAnalyticsToElement(\n\t\t"div#coreui-contentplacement-25bhfyl section.m-content-placement-item, div#coreui-contentplacement-34ednys section.m-content-placement-item, div#coreui-banner-0drta14 a",\n\t\t\'Configurations Add to Cart\',\n\t\t\'https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std\');\n} catch(clkerr) {\n\tconsole.log("Surface PDP Configs CPE Error");\n}\n\n\n',language:"javascript"}}]},{id:"RL83f784964f9f4aeb89f164274dec4c93",name:"XANDR Universal LP",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:70}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'/*\nxandr universal \nhttps://ib.adnxs.com/pixie?pi=8b1ad172-7b69-4621-be02-60f12c250344&e=Purchase&ii=CFQ7TTC0K7C8&in=Office%20Home%20%20Student%202019%2CUS%2CUSD&itp=office&va=1.99&script=0\n//imgurl = "https://ib.adnxs.com/pixie?pi=8b1ad172-7b69-4621-be02-60f12c250344&e=Purchase&ii=test&in=test&itp=test&va=0&script=0";\n*/\n\n\n(function() {\n\ttry {\n\t\tvar imgurl="",pn=[],itp=[],c=",";\n\t\tfor (var i=0; i<_TMDL.pids.length; i++) {\n\t\t\tpn[i]=encodeURIComponent(_TMDL.pnames[i]).slice(0,100);\n\t\t\tif ((typeof(_TMDL.dcmcat)==\'object\') && (typeof(_TMDL.dcmcat[i])==\'string\')) {\n\t\t\t\titp.push(encodeURIComponent(_TMDL.dcmcat[i]).slice(0,100));\n\t\t\t}\n\t\t}\n\t\tif (_TMDL.pT=="rP") {\n\t\t\timgurl = "https://ib.adnxs.com/pixie?pi=8b1ad172-7b69-4621-be02-60f12c250344&e=Purchase&ii="+_TMDL.pids.join(c)\n\t\t\t\t+"&in="+_TMDL.geo+c+_TMDL.cc+c+pn.join(c)\n\t\t\t\t+"&itp="+itp.join(c)+"&va="+_TMDL.totamount+"&u="+encodeURIComponent(window.location.protocol+"//"+window.location.host+window.location.pathname)+"&script=0";\n\t\t\tBootstrapper.imageRequest(imgurl);\n\t\t}\n\t} catch(e) { _satellite.logger.log("warn: "+e);\t}\n})();\n',language:"javascript"}}]},{id:"RL68235348568040d4bda4a81492fce87f",name:"AUStudentStore",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"en-au/store/b/student",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"// JavaScript source code section.m-multi-hero-item, div.m-channel-placement-item, section.m-content-placement-item,\nvar debug = 0, fireTags = 1;\nvar elements = \"section.m-multi-hero-item, div#coreui-feature-fuhlmyn section div a, a#coreui-highlightfeature-q04bez3-0, ul.c-group, section.m-content-placement-item\";\n\ntry {\n\t$(document).on('mousedown', elements, '', function () {\n\t\tif (debug) { console.log(\"Tag is running\") }\n\n\t\tvar rand = parseInt(Math.random() * 10000000000000);\n\t\tif (fireTags) {\n\t\t\tBootstrapper.imageRequest('https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50188&ActionName=Store_Site_Visit&cachebuster=' + rand);\n\t\t\tBootstrapper.imageRequest('https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick');\n\t\t\tBootstrapper.imageRequest(\"https://secure.adnxs.com/px?id=1268102&t=2\");\n\t\t}\n\n\n\t});\n} catch (clkerr) { console.log(\"au student store error\"); }",language:"javascript"}}]},{id:"RLf127bd87fe0c4bd3911337bd54ac7700",name:"Surface Indirect-Consumer/US/Yahoo & Adobe",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-us/d/surface-laptop-studio",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{
source:"//Yahoo/Adobe tag\nvar debug = 0, fireDCM = 1;\n\nfunction attachYahooAdobeAnalyticsToElement(elementAddress, isAdobe) {\n\t$(document).on('mousedown', elementAddress, '', function () {\n\t\tvar rand = parseInt(Math.random() * 10000000000000);\n\t\tvar yahooURL = 'https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick';\n\t\tvar adobeURL = 'https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50188&ActionName=Store_Site_Visit&cachebuster=' + rand;\n\n\t\tif (debug) {\n\t\t\tif (isAdobe) {\n\t\t\t\tconsole.log(\"firing both\");\n\t\t\t} else {\n\t\t\t\tconsole.log(\"firing one\");\n            }\n\t\t\t\n\t\t}\n\n\t\tif (fireDCM) {\n\t\t\tBootstrapper.imageRequest(yahooURL);\n\t\t\tif (isAdobe) {\n\t\t\t\tBootstrapper.imageRequest(adobeURL);\n\t\t\t}\n\t\t}\n\t});\n}\n\ntry {\n\t// Configure\n\tif (~window.location.pathname.toLowerCase().indexOf(\"surface\") && ~window.location.pathname.toLowerCase().indexOf(\"/d/\")) {\n\t\t// Configure Now CTA eeeeee\n\t\tattachYahooAdobeAnalyticsToElement('button[id*=\"ConfigureDeviceButton\"]');\n\n\t\t// Bundle\n\t\tattachYahooAdobeAnalyticsToElement('button[id*=\"buttons_BuildABundleButton\"],a[href*=\"/store/build/\"]');\n\n\t\t// Shop Now CTA from PDP (Surface_GBL_PchNow_Count_)  eeeeee\n\t\t$(document).on('mousedown', 'div.pi-promotion-bar a', '', function () {\n\t\t\tvar inScope = 1;\n\n\t\t\ttry {\n\t\t\t\tif (~this.href.indexOf(\"/build/\") || ~this.href.indexOf(\"student-discounts?successurl\")) {\n\t\t\t\t\t_satellite.logger.log(\"out of scope\");\n\t\t\t\t\tinScope = 0;\n\t\t\t\t}\n\t\t\t} catch (shperr) { _satellite.logger.log(\"shopnow err\"); }\n\n\t\t\tif (inScope) {\n\t\t\t\tvar isAdobe = false;\n\t\t\t\tif (this.href == \"https://www.microsoft.com/en-us/d/surface-laptop-studio-for-business/8wvj5p8dd2th\") {\n\t\t\t\t\tisAdobe = true;\n\t\t\t\t}\n\n\t\t\t\tif (debug) {\n\t\t\t\t\tif (isAdobe) {\n\t\t\t\t\t\tconsole.log('firing both');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.log('firing solo');\n                    }\n\t\t\t\t}\n\n\t\t\t\tif (isAdobe) {\n\t\t\t\t\tvar rand = parseInt(Math.random() * 10000000000000);\n\t\t\t\t\t\n\t\t\t\t\tBootstrapper.imageRequest('https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50188&ActionName=Store_Site_Visit&cachebuster=' + rand);\n                }\n\t\t\t\tBootstrapper.imageRequest('https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick');\n\t\t\t} else {\n\t\t\t\tconsole.log('not in scope');\n\t\t\t}\n\t\t});\n\n\t\t// Business\t\n\t\tattachYahooAdobeAnalyticsToElement('div.store-finance-offer a', true);\n\n\t\t// Eligibility\t\t\t\n\t\tattachYahooAdobeAnalyticsToElement('a[href*=\"student-discounts?successurl\"]', false);\n\t}\n}\ncatch (clkerr) {\n\tconsole.log(\"Surface Indirect-Consumer/US Yahoo/Adobe\");\n}",language:"javascript"}}]},{id:"RLbabdaaa9429a4087b3d39b2cae35a0ff",name:"Media.Verizon.Surface_081620 (RT)",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"(/en-ca|/en-au|/en-gb|/fr-fr|fr-ca)\\/p\\/surface",valueIsRegex:!0},{value:"(/en-ca|/en-au|/en-gb|/fr-fr|fr-ca)\\/d\\/surface",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n  \n//Yahoo\n   //Shop now \njQuery("#PromotionBar a").on("mousedown", function(){\n  var image = new Image(1, 1);\n  image.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=SurfaceButtonClick";\n});\n //Get started\njQuery("#purchaseColumn a").on("mousedown", function(){\n  var image = new Image(1, 1);\n  image.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=SurfaceButtonClick";\n});\n //Configure now & Sticky\njQuery(\'button[id*="ConfigureDeviceButton"]\').on("mousedown", function(){\n  var image = new Image(1, 1);\n  image.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=SurfaceButtonClick";\n});\n  \n}\ncatch(err)\n{\n\t_satellite.logger.error("Media.Verizon.Surface_081620(RT)");\n}\n',language:"javascript"}}]},{id:"RL540e8548e4cf4a23b1c50783151ec10b",name:"IRCV",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:30}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"try\n{\n\tvar marketMap = {\n\t\t'NZ' : ['d.impactradius-event.com/A1143145-4ed3-453a-8ac9-f0c166db12591.js' , '13903' , '7815'],\n\t\t'AU' : ['d.impactradius-event.com/A1143145-4ed3-453a-8ac9-f0c166db12591.js' , '13901' , '7815'],\n\t\t'CA' : ['d.impactradius-event.com/A1143100-98df-45ee-8c6e-2dec4e6eb56e1.js' , '13899' , '7814'],\n\t\t'BG' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // master for CEE\n\t\t'RU' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'HR' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],\n\t\t'CY' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],\n\t\t'HU' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],\n\t\t'SK' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],\n\t\t'EE' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],\n\t\t'CZ' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],\n\t\t'GR' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],\n\t\t'LT' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],\n\t\t'PL' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],\n\t\t'FR' : ['d.impactradius-event.com/A1143111-30b6-46be-bbab-c7bbbca8eb991.js' , '13876' , '7809'],\n\t\t'TW' : ['d.impactradius-event.com/A1143121-28a1-47b0-8a2c-8128049efd901.js' , '13874' , '7808'],\n\t\t'HK' : ['d.impactradius-event.com/A1143121-28a1-47b0-8a2c-8128049efd901.js' , '13872' , '7808'],\n\t\t'CN' : ['d.impactradius-event.com/A1143121-28a1-47b0-8a2c-8128049efd901.js' , '13870' , '7808'],\n\t\t'DE' : ['d.impactradius-event.com/A1143124-6b0f-4685-b9ab-e289200ad2901.js' , '13868' , '7806'],\n\t\t'IN' : ['d.impactradius-event.com/A1143126-787b-4983-ad6f-e804972459e91.js' , '13865' , '7805'],\n\t\t'JP' : ['d.impactradius-event.com/A1143130-b81e-4371-9b61-b590cea59c051.js' , '13863' , '7804'],\n\t\t'BO' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'], // master for LATAM\n\t\t'DO' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'GT' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'HN' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'PA' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'PY' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'SV' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'VE' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'EC' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'CR' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'PE' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'CL' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'AR' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'MX' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'BR' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'BS' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'BB' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'CO' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'JM' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'NI' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'TT' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'UY' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'BH' : ['d.impactradius-event.com/A1143144-62f4-44be-93a3-7c960374e2961.js' , '13816' , '7796'], // master for MEA\n\t\t'MA' : ['d.impactradius-event.com/A1143144-62f4-44be-93a3-7c960374e2961.js' , '13816' , '7796'],\n\t\t'OM' : ['d.impactradius-event.com/A1143144-62f4-44be-93a3-7c960374e2961.js' , '13816' , '7796'],\n\t\t'QA' : ['d.impactradius-event.com/A1143144-62f4-44be-93a3-7c960374e2961.js' , '13816' , '7796'],\n\t\t'NG' : ['d.impactradius-event.com/A1143144-62f4-44be-93a3-7c960374e2961.js' , '13816' , '7796'],\n\t\t'KW' : ['d.impactradius-event.com/A1143144-62f4-44be-93a3-7c960374e2961.js' , '13816' , '7796'],\n\t\t'EG' : ['d.impactradius-event.com/A1143144-62f4-44be-93a3-7c960374e2961.js' , '13816' , '7796'],\n\t\t'SA' : ['d.impactradius-event.com/A1143144-62f4-44be-93a3-7c960374e2961.js' , '13816' , '7796'],\n\t\t'IL' : ['d.impactradius-event.com/A1143144-62f4-44be-93a3-7c960374e2961.js' , '13816' , '7796'],\n\t\t'ZA' : ['d.impactradius-event.com/A1143144-62f4-44be-93a3-7c960374e2961.js' , '13816' , '7796'],\n\t\t'TR' : ['d.impactradius-event.com/A1143144-62f4-44be-93a3-7c960374e2961.js' , '13816' , '7796'],\n\t\t'AE' : ['d.impactradius-event.com/A1143144-62f4-44be-93a3-7c960374e2961.js' , '13816' , '7796'],  // check on Geo code (was UAE, now AE_\n\t\t'PH' : ['d.impactradius-event.com/A1143145-4ed3-453a-8ac9-f0c166db12591.js' , '13785' , '7795'],\n\t\t'TH' : ['d.impactradius-event.com/A1143145-4ed3-453a-8ac9-f0c166db12591.js' , '13783' , '7795'],\n\t\t'ID' : ['d.impactradius-event.com/A1143145-4ed3-453a-8ac9-f0c166db12591.js' , '13781' , '7795'],\n\t\t'MY' : ['d.impactradius-event.com/A1143145-4ed3-453a-8ac9-f0c166db12591.js' , '13777' , '7795'],\n\t\t'KR' : ['d.impactradius-event.com/A1143145-4ed3-453a-8ac9-f0c166db12591.js' , '13779' , '7795'],\n\t\t'SG' : ['d.impactradius-event.com/A1143145-4ed3-453a-8ac9-f0c166db12591.js' , '13775' , '7795'],\n\t\t'UK' : ['d.impactradius-event.com/A1143151-5b4f-4392-9e5d-0d32d4dda7b21.js' , '13773' , '7794'],\n\t\t'GB' : ['d.impactradius-event.com/A1143151-5b4f-4392-9e5d-0d32d4dda7b21.js' , '13773' , '7794'], // added GB as UK\n\t\t'IE' : ['d.impactradius-event.com/A1143151-5b4f-4392-9e5d-0d32d4dda7b21.js' , '13773' , '7794'], // map to UK/GB\n\t\t'PR' : ['d.impactradius-event.com/A1133099-331c-4cdf-89b0-06dc20e168021.js' , '13588' , '7593'], // mspped to US\n\t\t'US' : ['d.impactradius-event.com/A1133099-331c-4cdf-89b0-06dc20e168021.js' , '13588' , '7593'],\n\t\t'LU' : ['d.impactradius-event.com/A1143167-163d-430c-aa98-4062268d1ce01.js' , '13768' , '7793'], // changed from LUX\n\t\t'BE' : ['d.impactradius-event.com/A1143167-163d-430c-aa98-4062268d1ce01.js' , '13766' , '7793'],\n\t\t'AT' : ['d.impactradius-event.com/A1143124-6b0f-4685-b9ab-e289200ad2901.js' , '13868' , '7806'], // mapped to DE\n\t\t'NL' : ['d.impactradius-event.com/A1143167-163d-430c-aa98-4062268d1ce01.js' , '13760' , '7793'],\n\t\t'FI' : ['d.impactradius-event.com/A1143167-163d-430c-aa98-4062268d1ce01.js' , '13758' , '7792'],\n\t\t'DK' : ['d.impactradius-event.com/A1143167-163d-430c-aa98-4062268d1ce01.js' , '13756' , '7792'],\n\t\t'NO' : ['d.impactradius-event.com/A1143167-163d-430c-aa98-4062268d1ce01.js' , '13754' , '7792'],\n\t\t'SE' : ['d.impactradius-event.com/A1143167-163d-430c-aa98-4062268d1ce01.js' , '13752' , '7792'],\n\t\t'PT' : ['d.impactradius-event.com/A1143167-163d-430c-aa98-4062268d1ce01.js' , '13750' , '7791'],\n\t\t'IT' : ['d.impactradius-event.com/A1143167-163d-430c-aa98-4062268d1ce01.js' , '13748' , '7791'],\n\t\t'ES' : ['d.impactradius-event.com/A1143167-163d-430c-aa98-4062268d1ce01.js' , '13746' , '7791'],\n\t\t'CH' : ['d.impactradius-event.com/A1143124-6b0f-4685-b9ab-e289200ad2901.js' , '13868' , '7806'], // mapped to DE\n\t\t// FR\n\t\t'RE' : ['d.impactradius-event.com/A1143111-30b6-46be-bbab-c7bbbca8eb991.js' , '13876' , '7809'],\n\t\t'NC' : ['d.impactradius-event.com/A1143111-30b6-46be-bbab-c7bbbca8eb991.js' , '13876' , '7809'],\n\t\t'AD' : ['d.impactradius-event.com/A1143111-30b6-46be-bbab-c7bbbca8eb991.js' , '13876' , '7809'],\n\t\t// APAC TH\n\t\t'VN' : ['d.impactradius-event.com/A1143145-4ed3-453a-8ac9-f0c166db12591.js' , '13783' , '7795'],\n\t\t'PF' : ['d.impactradius-event.com/A1143145-4ed3-453a-8ac9-f0c166db12591.js' , '13783' , '7795'],\n\t\t'KH' : ['d.impactradius-event.com/A1143145-4ed3-453a-8ac9-f0c166db12591.js' , '13783' , '7795'],\n\t\t'LA' : ['d.impactradius-event.com/A1143145-4ed3-453a-8ac9-f0c166db12591.js' , '13783' , '7795'],\n\t\t//'GA' : ['d.impactradius-event.com/A1143145-4ed3-453a-8ac9-f0c166db12591.js' , '13783' , '7795'], // Gabon, removed so that it will default to MEA\n\n\t\t// FI\n\t\t'IS' : ['d.impactradius-event.com/A1143167-163d-430c-aa98-4062268d1ce01.js' , '13758' , '7792'],\n\t\t'GL' : ['d.impactradius-event.com/A1143167-163d-430c-aa98-4062268d1ce01.js' , '13758' , '7792'],\n\t\t// IN\n\t\t'PK' : ['d.impactradius-event.com/A1143126-787b-4983-ad6f-e804972459e91.js' , '13865' , '7805'],\n\t\t'LK' : ['d.impactradius-event.com/A1143126-787b-4983-ad6f-e804972459e91.js' , '13865' , '7805'],\n\t\t'BD' : ['d.impactradius-event.com/A1143126-787b-4983-ad6f-e804972459e91.js' , '13865' , '7805'],\n\t\t'NP' : ['d.impactradius-event.com/A1143126-787b-4983-ad6f-e804972459e91.js' , '13865' , '7805'],\n\t\t'MM' : ['d.impactradius-event.com/A1143126-787b-4983-ad6f-e804972459e91.js' , '13865' , '7805'],\n\t\t// LATAM\n\t\t'GP' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'KY' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t// NL\n\t\t'AW' : ['d.impactradius-event.com/A1143167-163d-430c-aa98-4062268d1ce01.js' , '13760' , '7793'],\n\t\t// US\n\t\t'GU' : ['d.impactradius-event.com/A1133099-331c-4cdf-89b0-06dc20e168021.js' , '13588' , '7593'],\n\t\t'BM' : ['d.impactradius-event.com/A1133099-331c-4cdf-89b0-06dc20e168021.js' , '13588' , '7593'],\n\t\t'VI' : ['d.impactradius-event.com/A1133099-331c-4cdf-89b0-06dc20e168021.js' , '13588' , '7593'],\n\t\t// UK\n\t\t'JE' : ['d.impactradius-event.com/A1143151-5b4f-4392-9e5d-0d32d4dda7b21.js' , '13773' , '7794'],\n\t\t// CEE\n\t\t'RO' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'UA' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'SI' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'MT' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'LV' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'MU' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'KZ' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'RS' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'BY' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'BA' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'GE' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'AL' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'AM' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'MK' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'MD' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'AZ' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'UZ' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811']  // added to CEE\n\t\t// Everything else map to MEA\n\t};\n\n\n\t/*\n\t// OLD TD\n\tvar eventIDmap = {\n\t\tpc : \"259975\",\n\t\twindows : \"259977\",\n\t\toffice : \"259979\",\n\t\tothersoftware : \"259981\",\n\t\txbox : \"259983\",\n\t\tbackup : \"259985\",  // developer and visual studio\n\t\tmspress : \"259987\",  // and hp tablet, only remapped for hptablet not mspress\n\t\tx1 : \"287980\",\n\t\tsurface : \"287592\",\n\t\to365monthy : \"275200\",\n\t\tphone : \"287982\",\n\t\to365yearly : \"276225\",\n\t\thptablet : \"259987\",\n\t\t//  new additions\n\t\tband : \"333480\",\n\t\taccessories : \"321395\",\n\t\tdummy : \"359828\", // used as placeholder when testing\n\t\txboxlive1mo : \"363063\", // added 7/27/17\n\t\txboxlive3mo : \"363065\", // added 7/27/17\n\t\txboxlive12mo : \"363067\" // added 7/27/17\n\t};\n\n\t// new IR category names\n\tvar eventIDmap = {\n\t\tpc : \"PC\",\n\t\twindows : \"Windows\",\n\t\toffice : \"OfficeNonSub\",\n\t\tothersoftware : \"Software\",\n\t\txbox : \"Xbox\",\n\t\tbackup : \"259985\",  // developer and visual studio\n\t\tmspress : \"259987\",  // and hp tablet, only remapped for hptablet not mspress\n\t\tx1 : \"287980\",\n\t\tsurface : \"Surface\",\n\t\to365monthy : \"Office1M\",\n\t\tphone : \"Phone\",\n\t\to365yearly : \"Office1Y\",\n\t\thptablet : \"259987\",\n\t\t//  new additions\n\t\tband : \"Band\",\n\t\taccessories : \"Accessory\",\n\t\tdummy : \"359828\", // used as placeholder when testing\n\t\txboxlive1mo : \"XboxLive1M\", \n\t\txboxlive3mo : \"XboxLive3M\", // added 7/27/17\n\t\txboxlive12mo : \"XboxLive12M\", // added 7/27/17\n\t\t\n\t\tDevVisualStudio : \"DevVisualStudio\", // split out from Software 7/24/18\n\n\t\tmrvr : \"MRVR\"\n\t};\n\t*/\n\n  \tvar pidexclude={\n\t\t'Nevermatch_sku' : 'Default'\n\t};\n\n\tvar pidlist = {\n\t\t'Nevermatch' : 'Default'\n\t};\n\t\n\tvar skulist = {\n\t\t'Nevermatch_sku' : 'Default'\n\t};\n  \n\n\n\tvar cid=\"\"; // map based on geo and campaign\n\tvar irchannel=\"\";  // map based on geo\n\tvar anonarr = [];\n\tvar anonID = \"\";\n\tvar mapCat = function(pid,pidsku,pname,ptype) {\n\t\tif (pidexclude[pid]) {\n\t\t\treturn \"\";\n\t\t} else if (skulist[pidsku]) {\n\t\t\treturn skulist[pidsku];\n\t\t} else if (pidlist[pid]) {\n\t\t\treturn pidlist[pid];\n\t\t} /*else if (pname && ~pname.toLowerCase().indexOf(\"surface\") ) {\n\t\t\treturn \"Surface\";\n\t\t} else if (pname && ~pname.toLowerCase().indexOf(\"xbox\") ) {\n\t\t\treturn \"Xbox\";\n\t\t} */ else if (~ptype.toLowerCase().indexOf(\"app\") || ~ptype.toLowerCase().indexOf(\"durable\") || ~ptype.toLowerCase().indexOf(\"consumable\")) {\n\t\t\treturn \"App\";\n\t\t} else if (~ptype.toLowerCase().indexOf(\"tv\") || ~ptype.toLowerCase().indexOf(\"movie\")) {\n\t\t\treturn \"MoviesTV\";\n\t\t} else {\n\t\t\treturn \"Default\";\n\t\t}\n\t};\n\tvar lineItemStr=\"\";\n\tvar li=0; // line item number\n\tvar cat=\"\";\n\tvar totlines=0;\n\tvar u=\"\";\n\tvar ptype=\"\";\n\tvar hupurl=\"\";\n\n\ttry {\n\t\tif(_TMDL && marketMap[(_TMDL.geo).toUpperCase()] ){\n\t\t\tirchannel = marketMap[(_TMDL.geo).toUpperCase()][1];\n\t\t\tcid = marketMap[(_TMDL.geo).toUpperCase()][2];\n\t\t}\n\t} catch(err) {}\n\n\tif (cid==\"\") {\n\t\t// map to MEA as catchall\n\t\t// 'BH' : ['d.impactradius-event.com/A1143144-62f4-44be-93a3-7c960374e2961.js' , '13816' , '7796'],\n\t\tirchannel = '13816';\n\t\tcid = '7796';\n\t}\n\n\tfor (var i=0; i<_TMDL.pids.length; i++) {\n\t\t//\"&amt1=Item Sub Total&cat1=Item Category&sku1=Item SKU&qty1=Item Quantity&name1=Item Name\";\n\t\tli = i+1;\n\t\tptype=\"\";\n\t\ttry {\n\t\t\tif ((typeof _TMDL.prdType == \"object\") && (typeof _TMDL.prdType[i] == \"string\")) {\n\t\t\t\tptype = _TMDL.prdType[i];\n\t\t\t}\n\t\t} catch(ptypeerr) {}\n\t\tcat = mapCat(_TMDL.pids[i],_TMDL.pidsku[i],_TMDL.pnames[i],ptype); // added ptype 12/3/18\n\t\tif (cat) {  // only emit if category matches (e.g. if not filtered)\n\t\t\ttotlines++;\n\t\t\tlineItemStr += ( \"&amt\"+li+\"=\"+_TMDL.sales[i]\n\t\t\t\t\t\t\t+\"&cat\"+li+\"=\"+cat\n\t\t\t\t\t\t\t+\"&sku\"+li+\"=\"+_TMDL.pidsku[i].replace(\"-\",\"_\")\n\t\t\t\t\t\t\t+\"&qty\"+li+\"=\"+_TMDL.quantities[i]\n\t\t\t\t\t\t\t+\"&name\"+li+\"=\"+encodeURIComponent(_TMDL.pnames[i])\n\t\t\t\t\t\t);\n\t\t}\n\t}\n\n\tu=\"https://microsoft.msafflnk.net/conv/?\"\n\t\t+\"irchannel=\"+irchannel\n\t\t+\"&cid=\"+cid\n\t\t+\"&oid=\"+_TMDL.purchaseID\n\t\t//+\"&custid=\"+anonID\n\t\t+\"&status=\"\n\t\t+\"&note=\"+_TMDL.geo\n\t\t+\"&custctry=\"+_TMDL.geo\n\t\t//+\"&custemail=\"\n\t\t+\"&currency=\"+_TMDL.cc\n\t\t//+\"&promocode=\"\n\t\t+lineItemStr;\n\n\tvar hupurl=\"\";\n/*\n\thupurl=\"https://microsoft.msafflnk.net/conv/?\"\n\t\t+\"irchannel=13588\"\n\t\t+\"&cid=9340\"\n\t\t+\"&oid=\"+_TMDL.purchaseID\n\t\t+\"&status=\"\n\t\t+\"&note=\"+_TMDL.geo\n\t\t+\"&custctry=\"+_TMDL.geo\n\t\t+\"&currency=\"+_TMDL.cc\n\t\t+lineItemStr;\n*/\n  \n  \thupurl = \"https://microsoft.msafflnk.net/conv/?\" + \"irchannel=16760\" + \"&cid=9429\" + \"&oid=\" + _TMDL.purchaseID + \"&status=\" + \"&note=\" + _TMDL.geo + \"&custctry=\" + _TMDL.geo + \"&currency=\" + _TMDL.cc + lineItemStr;\n\n\tvar\tmktstring = \"AT,AU,BE,BR,CA,CH,CN,DE,DK,ES,FR,GB,IE,IN,IT,JP,KR,MX,NL,NO,NZ,PL,SA,SE,SG,TW,US,ZA\";\n    var mktInScope=true;\n\tmktInScope = (mktstring.indexOf(_TMDL.geo.toUpperCase())>-1);\n  \n\tif (cid && mktInScope && lineItemStr) {\n\t\tdbugimgurl = u; \n\t\tBootstrapper.imageRequest(u);\n\t\tdbugimgurl = hupurl; \n\t\tBootstrapper.imageRequest(hupurl);\n\t}\t\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== \"undefined\") {_TMutils.logRuleCall(\"IRCV\",err.message,dbugimgurl);}\n\t_satellite.logger.error(\"IRCV\");\t\n}",language:"javascript"}}]},{id:"RLb9638e6a11854c11b48d315d3f8fc064",name:"Media.ja-jp.store.b.surface-studentdeals",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/ja-jp/store/b/surface-studentdeals"},{value:"/ja-jp/store/b/surface-studentdeals/"}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'// JavaScript source code\ntry {\n    //ADNXS\n    jQuery(".m-hero, #primaryR4, #primaryR6, #onestore-quicklinksmodule-s99z4gv-quicklink1, #onestore-quicklinksmodule-s99z4gv-quicklink2, #onestore-quicklinksmodule-s99z4gv-quicklink3").on("mousedown", function () {\n        var image = new Image(1, 1);\n        image.src = "//secure.adnxs.com/px?id=1268102&t=2";\n    });\n\n    //DCM\n    jQuery(".m-hero, #primaryR4, #primaryR6, #onestore-quicklinksmodule-s99z4gv-quicklink1, #onestore-quicklinksmodule-s99z4gv-quicklink2, #onestore-quicklinksmodule-s99z4gv-quicklink3").on("mousedown", function () {\n        var image = new Image(1, 1);\n        image.src = "https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1=" + _TMDL.geo + ";u2=" + _TMDL.ll + ";u6=" + encodeURIComponent(_TMDL.pagename) + ";u25=" + _TMDL.pids[0] + ";u26=" + encodeURIComponent(_TMDL.pnames[0]) + ";u50=Check Eligibility Student" + ";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?";\n    });\n\n    //Yahoo\n    jQuery(".m-hero, #primaryR4, #primaryR6, #onestore-quicklinksmodule-s99z4gv-quicklink1, #onestore-quicklinksmodule-s99z4gv-quicklink2, #onestore-quicklinksmodule-s99z4gv-quicklink3").on("mousedown", function () {\n        var image = new Image(1, 1);\n        image.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick";\n    });\n\n    //Adobe DCO\n    var rand = parseInt(Math.random() * 10000000000000);\n    jQuery(".m-hero, #primaryR4, #primaryR6, #onestore-quicklinksmodule-s99z4gv-quicklink1, #onestore-quicklinksmodule-s99z4gv-quicklink2, #onestore-quicklinksmodule-s99z4gv-quicklink3").on("mousedown", function () {\n        var image = new Image(1, 1);\n        image.src = "https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50188&ActionName=Store_Site_Visit&cachebuster=" + rand;\n    });\n\n}\ncatch (err) { satellite.logger.error("Media.ja-jp.store.b.surface-studentdeals"); }\n\n',language:"javascript"}}]},{id:"RL369c413f84c54b4a89a9eaa73a57154a",name:"Media_/LL-LL/ Reddit Xbox Purchase",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}},{modulePath:"core/src/lib/conditions/dateRange.js",settings:{end:"2022-07-01T00:00:00Z",start:"2021-11-03T00:00:00Z"}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{
source:'//Reddit Xbox Pixel\nif (_TMDL.geo=="US" || _TMDL.geo=="AU" || _TMDL.geo=="GB") {\ntry\n{\nvar ps="",inScope=0\nfor (var i=0; i<_TMDL.pids.length; i++) {\nif (_TMDL.pidsku.length > i) {\nps = _TMDL.pidsku[i].toUpperCase();\nif (ps=="CFQ7TTC0K5DJ-000C" || ps=="CFQ7TTC0K5DJ-000D" || ps=="CFQ7TTC0K5ZM-0002" || ps=="CFQ7TTC0K5ZM-7SR4" || ps=="CFQ7TTC0K63H-0007" || ps=="CFQ7TTC0K63H-0008" || ps=="CFQ7TTC0K63H-000L" || ps=="CFQ7TTC0K63H-000M" || \n    ps=="CFQ7TTC0K63H-000R" || ps=="CFQ7TTC0K63H-000S" || ps=="CFQ7TTC0K63H-000X" || ps=="CFQ7TTC0K63H-000Z" || ps=="CFQ7TTC0K63H-001C" || ps=="CFQ7TTC0K63H-001R" || ps=="CFQ7TTC0K63H-001Q" || ps=="CFQ7TTC0K63H-001V" || \n    ps=="CFQ7TTC0K63H-001W" || ps=="CFQ7TTC0K63H-0021" || ps=="CFQ7TTC0K63H-0022" || ps=="CFQ7TTC0K63H-0025" || ps=="CFQ7TTC0K63H-0026" || ps=="CFQ7TTC0K63H-002F" || ps=="CFQ7TTC0K63H-001S" || ps=="CFQ7TTC0K63H-001T" || \n    ps=="CFQ7TTC0K63H-001X" || ps=="CFQ7TTC0K63H-001Z" || ps=="CFQ7TTC0K63H-0023" || ps=="CFQ7TTC0K63H-0024" || ps=="CFQ7TTC0K63H-0029" || ps=="CFQ7TTC0K5ZM-0003" || ps=="CFQ7TTC0K63H-002M" || ps=="CFQ7TTC0K63H-002N" || \n    ps=="CFQ7TTC0K63H-002P" || ps=="CFQ7TTC0K63H-0005" || ps=="CFQ7TTC0K63H-0006" || ps=="CFQ7TTC0K63H-000Q" || ps=="CFQ7TTC0K63H-000W" || ps=="CFQ7TTC0K63H-000P" || ps=="CFQ7TTC0K63H-0018" || ps=="CFQ7TTC0K63H-0019" || \n    ps=="CFQ7TTC0K63H-001F" || ps=="CFQ7TTC0K63H-001G" || ps=="CFQ7TTC0K63H-002S" || ps=="CFQ7TTC0K63H-0001" || ps=="CFQ7TTC0K63H-000H" || ps=="CFQ7TTC0K63H-000K" || ps=="CFQ7TTC0K63H-0012" || ps=="CFQ7TTC0K63H-002J" || \n    ps=="CFQ7TTC0K63H-0020" || ps=="CFQ7TTC0K63H-002B" || ps=="CFQ7TTC0K63H-001D" || ps=="CFQ7TTC0K63H-001H" || ps=="CFQ7TTC0K63H-001K" || ps=="CFQ7TTC0K63H-001L" || ps=="CFQ7TTC0K63H-002C" || ps=="CFQ7TTC0K63H-0027" || \n    ps=="CFQ7TTC0K63H-0028" || ps=="CFQ7TTC0K63H-002Q" || ps=="CFQ7TTC0K63H-002R" || ps=="CFQ7TTC0K63H-0003" || ps=="CFQ7TTC0K63H-0004" || ps=="CFQ7TTC0K63H-0009" || ps=="CFQ7TTC0K63H-000B" || ps=="CFQ7TTC0K63H-000C" || \n    ps=="CFQ7TTC0K63H-000D" || ps=="CFQ7TTC0K63H-000F" || ps=="CFQ7TTC0K63H-000G" || ps=="CFQ7TTC0K63H-001B" || ps=="CFQ7TTC0K63H-001N" || ps=="CFQ7TTC0K63H-002D" || ps=="CFQ7TTC0K63H-002G" || ps=="CFQ7TTC0K63H-0002" || \n    ps=="CFQ7TTC0K63H-000J" || ps=="CFQ7TTC0K63H-002K" || ps=="CFQ7TTC0K63H-002L" || ps=="CFQ7TTC0K63H-000N" || ps=="CFQ7TTC0K63H-000T" || ps=="CFQ7TTC0K63H-000V" || ps=="CFQ7TTC0K63H-0011" || ps=="CFQ7TTC0K63H-0010" || \n    ps=="CFQ7TTC0K63H-002H" || ps=="CFQ7TTC0K63H-0013" || ps=="CFQ7TTC0K63H-0014" || ps=="CFQ7TTC0K63H-0015" || ps=="CFQ7TTC0K63H-0016" || ps=="CFQ7TTC0K63H-0017" || ps=="CFQ7TTC0K63H-001M" || ps=="CFQ7TTC0K63H-001P" || \n    ps=="CFQ7TTC0K63H-001J" || ps=="8T07Q5SRTV11-498S" || ps=="90Z8K1DBJ8ZD-0TR4" || ps=="8T07Q5SRTV11-058T" || ps=="8T07Q5SRTV11-637M" || ps=="8WJ714N3RBTL-490G" || ps=="8T07Q5SRTV11-8XR4" || ps=="8RDMHCQPFTB3-5D0N" || \n    ps=="8T07Q5SRTV11-90ZR" || ps=="8T07Q5SRTV11-HV5X" || ps=="8T07Q5SRTV11-K73G" || ps=="8V07B7D9RT94-4N65" || ps=="8P80WLPWCS0X-CJD3" || ps=="8T07Q5SRTV11-F0GG" || ps=="8S1VNGFW2JV8-GDJM" || ps=="8WH200Q1JG76-GHM1" || \n    ps=="8S1VNGFW2JV8-KMDS" || ps=="8RNHQJKR23JQ-685Q" || ps=="8RNHQJKR23JQ-L036" || ps=="8T07Q5SRTV11-B192" || ps=="940J83PK147R-B1PX" || ps=="8PD10J7J6MDG-DWDF" || ps=="8TZDQ3K9F52M-GGR9" || ps=="8SM6PVLK1H52-KXFF" || \n    ps=="8V9DX9W37PD3-9SVP" || ps=="8QMN3Q6FQJFH-FMZ8" || ps=="8T07Q5SRTV11-HVT1" || ps=="910PCTKGCV8T-MBT6" || ps=="9496XKF4D9D0-H7MF" || ps=="8TRWZ09B0G07-FDV4" || ps=="8T8KCNB1XS3D-84PC" || ps=="8XN59CRBSQGZ-JBFJ" || \n    ps=="9052SHFFCXL5-KJDD" || ps=="92PQ94D376XZ-F638" || ps=="9082KXHLZ2XR-B09V" || ps=="8V5N5W7RQTT7-H982" || ps=="8TDWHGLL0VZP-J7F2" || ps=="8XN59CRBSQGZ-HG3Q" || ps=="8ZW2DXG78JC7-4JMD" || ps=="8XN59CRBSQGZ-M3FS" || \n    ps=="8T07Q5SRTV11-CBN1" || ps=="8NFTLGZ7S1L3-87DS" || ps=="8XN59CRBSQGZ-25XW" || ps=="8P472LSRHZ0T-7776" || ps=="8PD7FXKHP5RW-6VR4" || ps=="8X4FHH4X4MHX-6ZG5" || ps=="93382MKKGJ02-BZM7" || ps=="922M1DK9HZV8-BBD5" || \n    ps=="93ZM50FF452F-6ZWX" || ps=="8WJTT248MM6G-8NTM" || ps=="911C2SNM16G4-HP38" || ps=="8MWHG706SV3N-DTWZ" || ps=="8T07Q5SRTV11-D5XD" || ps=="8VMJMHBJTFL5-2N5N" || ps=="8RSN7J6375GG-99WM" || ps=="8PRG8Q2265SL-BDSK" || \n    ps=="936L5FN0W6V6-92B9" || ps=="8XRD3S750JFG-8K4D" || ps=="8XGF1S3VFFDB-JK66" || ps=="8ZFM1D39DZWP-62BD" || ps=="8NSDBHZ1N3D8-0002" || ps=="901JF2ZPTLXQ-5209" || ps=="8RKW2L0CR8SP-GPLV" || ps=="8PWCCRL7F0BN-0QCF" || \n    ps=="8R47GMDT9ZG6-6DGZ" || ps=="8TNQZRJQ38W1-G19L" || ps=="94BWQ0QBKZFB-H3QM" || ps=="8XGF1S3VFFDB-2HSZ" || ps=="8V2CFLQ6FPF0-B2RC" || ps=="91DQRB97L130-JQ56" || ps=="911C2SNM16G4-75FQ" || ps=="8W3GK9F99GJH-8JNJ" || \n    ps=="8W3GK9F99GJH-12QS" || ps=="91VGJSDXVF5N-8P0P" || ps=="8MTPBK7QLTVD-M30R" || ps=="929C19165TL3-93ZL" || ps=="927Q1VG7LRXZ-5N34" || ps=="90V7LC49LGKS-JXJT" || ps=="91N2GCXRWHQ6-K8QZ" || ps=="8S6F8FH2SKBF-KLFN" || \n    ps=="943M1NC8ZG69-20XL" || ps=="8RX4V78HT8Q8-DW63" || ps=="8QQQT5GCMJ7B-52DC" || ps=="92KZG88SZ07Q-B063" || ps=="8NMPB6V29840-9VR5" || ps=="8THSBP49Z46X-9779" || ps=="8XN59CRBSQGZ-3MJ2" || ps=="8XRD3S750JFG-9BLL" || \n    ps=="8XRD3S750JFG-LFPL" || ps=="9082KXHLZ2XR-B9N1" || ps=="8W6SDMBQ072S-BNGM" || ps=="8RX4V78HT8Q8-KGN2" || ps=="934ZNJCQ2VXR-DXFX" || ps=="8T6N0J1ZG7SL-2L5C" || ps=="8NPCSJJW4CGV-9LDS" || ps=="8NPCSJJW4CGV-F9RF" || \n    ps=="8QC1QMT3JC2Z-1R7D" || ps=="8W8V368G8KZX-LJS1" || ps=="9082KXHLZ2XR-LCR8" || ps=="91D6W1CT940X-8M5K" || ps=="8QJQB1F4V0DJ-0VF1" || ps=="8NPCSJJW4CGV-L5NQ" || ps=="934ZNJCQ2VXR-F5VS" || ps=="8Z2MHHTK24GC-1SSJ" || \n    ps=="8P25R836686S-6P2J" || ps=="8V9DX9W37PD3-6ZB0" || ps=="8RPM8T9CK0P6-GSTK" || ps=="8Z1DCQL8Z512-5P6C" || ps=="8XP6LKM3MPX8-2587" || ps=="8PCN2542HZ64-K33P" || ps=="8W3GK9F99GJH-D9FW" || ps=="8WQTH21CMCL4-FS5P" || \n    ps=="8MTPBK7QLTVD-3RK9" || ps=="90V7LC49LGKS-2WDZ" || ps=="8MV3XWV6TWBM-36VS" || ps=="8MV3XWV6TWBM-KRNQ" || ps=="8WNCCQXW5X1N-H2BK" || ps=="8P8F24GFKJ18-4VRH" || ps=="8P0WSDDC3WQG-PZTD" || ps=="8MM77Q8LM45C-5S9S" || \n    ps=="8MM77Q8LM45C-9MR0" || ps=="8P2NZWC0JJL6-6M3W" || ps=="8SM6PVLK1H52-FCNP" || ps=="942Q7T9W9B1H-FPHD" || ps=="90G6MJNF223N-KM4P" || ps=="8QMDT7ZSF6TP-6P4S" || ps=="90GZCDQBW2DF-BFDQ" || ps=="8W1XD96LJLCD-JX5W" || \n    ps=="8R419TH0Z8NV-QXM0" || ps=="94CZ2B1VPCR7-PGDN" || ps=="8RTF503L2PL9-FV6V" || ps=="936NDVCJZP78-M8JT" || ps=="8NPCSJJW4CGV-JZLF" || ps=="942J774TP9JN-D73K" || ps=="90BBJ44JTM04-GBR5" || ps=="8P25R836686S-C6RX" || \n    ps=="8P25R836686S-0C7W" || ps=="8P25R836686S-40N7" || ps=="8NZP0DD82NGP-BDGV" || ps=="8XNCBK6NS06C-DKNX" || ps=="8ND3067HN3RS-B62Z" || ps=="8Z80TH5JF0F3-HLHN" || ps=="92R4FRRQS20D-5M8M" || ps=="93CQ5LVZBBDR-419G" || \n    ps=="8NPCSJJW4CGV-G03D" || ps=="8T7S7VDWQNDV-0TZQ" || ps=="8NPCSJJW4CGV-JXR3" || ps=="8P25R836686S-B7V3" || ps=="90BDN4KXVSBN-76GM" || ps=="904H9VM1QG4H-HNZV" || ps=="8V23FGLC1NM8-35VP" || ps=="8P25R836686S-JGQ9" || \n    ps=="8R1R8THV8Q73-37PJ" || ps=="91K4CGDZQDF8-M3RM" \n\n){\ninScope=1\n}\nif (inScope) {\nvar image = new Image(1, 1);\nimage.src ="https://alb.reddit.com/rp.gif?id=t2_7knbgndc&event=Purchase&integration=noscript";\n}\n}}}\ncatch(err)\n{\n_satellite.logger.error("Media_/LL-LL/ Reddit Xbox Purchase");\n}}',language:"javascript"}}]},{id:"RL665debaffb1f41d4aa72af52480b524b",name:"Media_/LL-LL/ Reddit Surface Purchase",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}},{modulePath:"core/src/lib/conditions/dateRange.js",settings:{end:"2022-07-01T00:00:00Z",start:"2021-11-03T00:00:00Z"}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'//Reddit Surface Pixel\nif (_TMDL.geo=="US" || _TMDL.geo=="AU" || _TMDL.geo=="GB") {\ntry\n{\nvar ps="",inScope=0\nfor (var i=0; i<_TMDL.pids.length; i++) {\nif (_TMDL.pidsku.length > i) {\nps = _TMDL.pidsku[i].toUpperCase();\nif (ps=="8VDB5VRKC5TQ-6V0M" || ps=="8MN7MP9NQDLK-7Z5S" || ps=="8N17J0M5ZZQS-KMF5" || ps=="8N17J0M5ZZQS-08ZH" || ps=="8VDB5VRKC5TQ-M6M3" || ps=="8X0X6SC9Z3XP-F0RD" || ps=="8V9DP4LNKNSZ-G8RH" || ps=="93H0MB2GQD5B-69W9" || \n    ps=="8MRGKL8T2V5D-23RF" || ps=="943Q37FN6ZPR-4J1S" || ps=="8XBW9G3Z71F1-32LS" || ps=="8N17J0M5ZZQS-H9HB" || ps=="8XJQ3D3LRP0R-31VG" || ps=="8P43N3K93409-JLV2" || ps=="91V4VTMHXWPM-6FK8" || ps=="8MRGKL8T2V5D-KJ9H" || \n    ps=="8MZBMMCK11LF-0002" || ps=="90Z3M8L4GD7W-0003" || ps=="8PG9R8WB09L0-D49K" || ps=="8XJQ3D3LRP0R-JX7S" || ps=="8P43N3K93409-2JJ1" || ps=="8V9DP4LNKNSZ-L8M8" || ps=="8TBXXVBPWHM1-GL2P" || ps=="8X1TZLKCLXTB-26TK" || \n    ps=="8VLM29FGK062-L12T" || ps=="8X1TZLKCLXTB-DBFX" || ps=="8XJQ3D3LRP0R-FJSJ" || ps=="8V5N3QW7D8H9-HDH2" || ps=="8XBW9G3Z71F1-KVHT" || ps=="8P43N3K93409-K4S8" || ps=="8T5N0LQMWFQG-4X5H" || ps=="8MZBMMCK15G3-0003" || \n    ps=="8NN2SMPXK1FR-98ZX" || ps=="8PFWCT94P154-0005" || ps=="8PT3S2VJMDR6-2473" || ps=="8X1TZLKCLXTB-KS6R" || ps=="8N17J0M5ZZQS-JTX3" || ps=="8XJQ3D3LRP0R-GRF9" || ps=="943Q37FN6ZPR-2Q0H" || ps=="8X1TZLKCLXTB-8MR5" || \n    ps=="8XJQ3D3LRP0R-9C5V" || ps=="8XBW9G3Z71F1-25QZ" || ps=="8T0RW4PT6NT4-C2GK" || ps=="8TH6D1P49DV4-HSS7" || ps=="8XJQ3D3LRP0R-51CT" || ps=="93LTM69S3RFF-70F1" || ps=="8Q4HGC6KBMDQ-C0WW" || ps=="8QD9GGH2HZQS-L58W" || \n    ps=="8VSZF6WTWF29-HP78" || ps=="8XJQ3D3LRP0R-007Q" || ps=="93ZCTN7HQTST-503S" || ps=="8N0KT2Q6SNRT-M373" || ps=="8VSZF6WTWF29-6PVT" || ps=="93D7NWW5NQ3H-BB5F" || ps=="8Q340M559RMR-6H18" || ps=="8MJC4RMVLTJ0-7HMP" || \n    ps=="92FP8Q09QHXC-829R" || ps=="93D7NWW5NQ3H-DFWC" || ps=="8ZC6JRR8JMR8-8B0T" || ps=="8T0RW4PT6NT4-74N8" || ps=="90FJ6ZKW1RZB-0B4L" || ps=="93D7NWW5NQ3H-DX19" || ps=="8ZG5FH1FMDSR-C3HL" || ps=="8R9CPQ146064-L5RT" || \n    ps=="8QC5P0D8DDJT-J96Z" || ps=="8Q340M559RMR-0CBH" || ps=="8RDF6XG9P8FG-0MNR" || ps=="8QD9GGH2HZQS-L2JG" || ps=="8MZBMMCK11L0-0008" || ps=="8XGR3X8N3768-G6M5" || ps=="8Q340M559RMR-KT9P" || ps=="8WD86SGSXXX2-6XGT" || \n    ps=="8N17J0M5ZZQS-53NW" || ps=="8P43N3K93409-3PL9" || ps=="8PT3S2VJMDR6-4GN7" || ps=="8N17J0M5ZZQS-65S0" || ps=="8X8MCQDZLJR8-5XH7" || ps=="943Q37FN6ZPR-GZTC" || ps=="8XJQ3D3LRP0R-3TR1" || ps=="8Z28DH01W36X-4K0H" || \n    ps=="8QCV8RZGXC70-JWPR" || ps=="8WZD6DHZJ7KV-8RFG" || ps=="8QXVFTB3PXHM-H05D" || ps=="8VDB5VRKC5TQ-KHJ3" || ps=="8N17J0M5ZZQS-J9PZ" || ps=="8VSZF6WTWF29-JB2T" || ps=="93H0MB2GQD5B-H714" || ps=="93KCSBM0CFPS-LZPM" || \n    ps=="90FJ6ZKW1RZB-J14K" || ps=="90XS39DJ3GSD-H6R9" || ps=="93H0MB2GQD5B-94ML" || ps=="90FJ6ZKW1RZB-LXTB" || ps=="8W78ML23MF1F-1Q8J" || ps=="90FJ6ZKW1RZB-G0QH" || ps=="8TZGFL7Z18PH-1M18" || ps=="8QCV8RZGXC70-J63K" || \n    ps=="8P43N3K93409-GDCM" || ps=="93H0MB2GQD5B-1PF1" || ps=="8P98GBQKDZL5-4BSG" || ps=="8XJQ3D3LRP0R-01GD" || ps=="8TBXXVBPWHM1-4CGS" || ps=="8TBXXVBPWHM1-55LC" || ps=="92F4TX2C1BQF-DFK4" || ps=="8P43N3K93409-BDQ0" || \n    ps=="8NN2SMPXK1FR-8GZ6" || ps=="8NRS20M7T03L-F6JM" || ps=="93H0MB2GQD5B-HD8J" || ps=="8XBW9G3Z71F1-782N" || ps=="8N17J0M5ZZQS-7GKZ" || ps=="8P98GBQKDZL5-4TVL" || ps=="8XTMB6C575MD-8FK0" || ps=="8XBW9G3Z71F1-4Q6R" || \n    ps=="92FP8Q09QHXC-4VRG" || ps=="8VDB5VRKC5TQ-H58Z" || ps=="91V4VTMHXWPM-0001" || ps=="8VWN2B9NTZ3M-8BT8" || ps=="8XTMB6C575MD-BWM7" || ps=="93LTM69S3RFF-0001" || ps=="8MZBMMCK15HN-0001" || ps=="8XBW9G3Z71F1-GDTX" || \n    ps=="8XTMB6C575MD-2N2D" || ps=="8MZBMMCK11L0-0006" || ps=="8W78ML23MF1F-7KM4" || ps=="8X04WWQRR44Z-F1QB" || ps=="8WCCSFNF593P-9L0X" || ps=="8W78ML23MF1F-LGKZ" || ps=="8V2K517TCSXF-L65D" || ps=="8QCV8RZGXC70-CNJ1" || \n    ps=="8R7NCZRD488L-6N5H" || ps=="8Q89H8VDGQZP-5W6D" || ps=="93H0MB2GQD5B-0BRD" || ps=="8N17J0M5ZZQS-6SQD" || ps=="8VSZF6WTWF29-09W8" || ps=="93HV8MDDV9X6-J631" || ps=="8TBXXVBPWHM1-2B1D" || ps=="8WZD6DHZJ7KV-DXW9" || \n    ps=="93N0DWRQJ14C-7C5Q" || ps=="8XGT2SCLG6KG-HKTX" || ps=="8SJJQT4L40XX-M4JL" || ps=="93C88HCHTL99-BJKL" || ps=="8XTMB6C575MD-3C1F" || ps=="8WCCSFNF593P-4F4Z" || ps=="8SJJQT4L40XX-LX6D" || ps=="8ZL5C82QMG6B-3BVF" || \n    ps=="8P43N3K93409-8PRD" || ps=="8QCV8RZGXC70-286D" || ps=="8WCCSFNF593P-9WWC" || ps=="8WCCSFNF593P-5261" || ps=="8XVMDMG6W4R4-F0PW" || ps=="8QXVFTB3PXHM-KPJF" || ps=="8WZD6DHZJ7KV-F0CQ" || ps=="8MZBMMCK15HN-0002" || \n    ps=="8P43N3K93409-6H5T" || ps=="8R9CPQ146064-BPXK" || ps=="8N6Q4DTNS5H9-HKV0" || ps=="8P43N3K93409-9K39" || ps=="8XTMB6C575MD-7FZD" || ps=="8ZL5C82QMG6B-7X3T" || ps=="8ND2W87Q3B2F-9K6G" || ps=="8NXBZW7HRXVG-6F25" || \n    ps=="941SBDCK81PQ-CD4R" || ps=="8S8D6DS8MWVL-HDHW" || ps=="8P43N3K93409-DTSN" || ps=="8WQ0BSX7G523-44BS" || ps=="8S1JPWZV6L0F-H2N7" || ps=="8SJJQT4L40XX-LF11" || ps=="93MDNP8WKPP6-HK4W" || ps=="8QXVFTB3PXHM-HFTS" || \n    ps=="8SBJXM0M58T4-D2Q1" || ps=="90Z4L7RP2ZVS-9XR5" || ps=="8Z28DH01W36X-6V4S" || ps=="8P43N3K93409-1JGW" || ps=="8NWRHPTVDF48-J0T5" || ps=="8T5N0LQMWFQG-902P" || ps=="8XBW9G3Z71F1-FZJ2" || ps=="8NRS20M7T03L-00XC" || \n    ps=="8PF90854NM73-LZNB" || ps=="8NWRHPTVDF48-B3Q4" || ps=="8ZCNC665SLQ5-0055" || ps=="8N17J0M5ZZQS-4MHN" || ps=="8RP9LH17GM18-8TX9" || ps=="8TB9XW8RWC14-9V9M" || ps=="91NNTGWL74FR-CWRD" || ps=="912896799BKG-6GB2" || \n    ps=="8M9ZFXKG88D8-4HN3" || ps=="8NN2SMPXK1FR-L0VT" || ps=="8RL0J2QXSM1S-F7NS" || ps=="90PNC9LJWPX9-5Z3V" || ps=="8P65LKW1LW5Z-32LD" || ps=="8P65LKW1LW5Z-630Z" || ps=="8RL0J2QXSM1S-GL6T" || ps=="8WZD6DHZJ7KV-7CG1" || \n    ps=="8QVCVB7847Z7-7HNL" || ps=="8PT3S2VJMDR6-JVTL" || ps=="8RCG8L253H2D-315T" || ps=="8ZG5FH1FMDSR-2LGJ" || ps=="8QD908364SG2-6WH3" || ps=="8SV14CF5HPMJ-38D1" || ps=="91NNTGWL74FR-J0PX" || ps=="8QPTVN4L2ZMJ-G683" || \n    ps=="8MZBMMCK11M7-0003" || ps=="93H0MB2GQD5B-4F51" || ps=="8WGCKKFKDVPH-D1GL" || ps=="8SJ5MNK7FKXQ-G66K" || ps=="8XN9FQVZBVQ0-830H" || ps=="8RW25SLD63VS-0JG3" || ps=="8R3RQVVFLP4K-DSNG" || ps=="8TZ3PKNDDHJD-D8NR" || \n    ps=="93H0MB2GQD5B-1TD0" || ps=="93H0MB2GQD5B-KMWP" || ps=="8P43N3K93409-FK6N" || ps=="943RTP2F0BG5-0001" || ps=="8XBW9G3Z71F1-GFS1" || ps=="92JCWN8K0B4D-42NW" || ps=="8P5SV2RX3RN5-GGLX" || ps=="8P43N3K93409-CWNX" || \n    ps=="92S67S7W23HX-CZGF" || ps=="8PGXP59JSKJ5-434B" || ps=="93JCD9MGFVR7-5SJ6" || ps=="92VQN82KF597-4ZL6" || ps=="92P1BXSBCPR0-7RTR" || ps=="8S1JPWZV6L0F-08SL" || ps=="8MPK1ZPSHGPP-GGWV" || ps=="8XTMB6C575MD-GM0P" || \n    ps=="8P43N3K93409-5DN6" || ps=="8MC6K8M228SK-0004" || ps=="8NN2SMPXK1FR-BFZJ" || ps=="9233B942X8CM-6GV6" || ps=="941SBDCK81PQ-11GL" || ps=="94CHB2M80S54-4GJ5" || ps=="8X9Z4S6RJ230-2J6K" || ps=="8NN2SMPXK1FR-HJ09" || \n    ps=="8NN2SMPXK1FR-J3N4" || ps=="8ZL8NH9VVD50-KN8T" || ps=="8RW25SLD63VS-FM63" || ps=="93XQV506ZGL5-H7XB" || ps=="8MRMSZC6VXKC-4596" || ps=="925R551SKTGN-D5FT" || ps=="8WQ0BSX7G523-CS2R" || ps=="8PDS243T398V-CLGF" || \n    ps=="8PT3S2VJMDR6-H4BW" || ps=="8MZBMMCK11MM-0003" || ps=="8MRMSZC6VXKC-DBH4" || ps=="8XP6FXFJKTHN-D2BL" || ps=="8RL0J2QXSM1S-L3C1" || ps=="93D8SRJ9BSL0-FXPZ" || ps=="93H0MB2GQD5B-2CX9" || ps=="8WT81CGLRBLP-1JJG" || \n    ps=="8MCPZJJCC98C-001M" || ps=="8RL0J2QXSM1S-4873" || ps=="8SBJXM0M58T4-G652" || ps=="8MG0JQHKPFWK-4PXN" || ps=="8WZD6DHZJ7KV-FP89" || ps=="941SBDCK81PQ-KHLG" || ps=="93QQRPT4NN85-5ZFJ" || ps=="8P62MW6BN9G4-BF2C" || \n    ps=="8WVJWP0KJQ0M-6TMH" || ps=="918XHHX1T2RK-H4L0" || ps=="8SPDXNWQZKJ5-7MV6" || ps=="8Q5DQKD29GXT-CH5Z" || ps=="91SX3ZZH91TF-4B52" || ps=="8S77QXRGW0KT-GB12" || ps=="8TRCT5P0SHHL-68CS" || ps=="91T3QGM634L7-8HTL" || \n    ps=="944KWKTXBL73-728B" || ps=="8MZBMMCK15G3-0002" || ps=="8SQJHGQS07NT-JLJ2" || ps=="8Q7QDH6V9CS5-60Z8" || ps=="8VFXVVDHT3MX-FRJT" || ps=="8QXVFTB3PXHM-1SGB" || ps=="8Z15VD4432GN-41W1" || ps=="8MZBMMCK15G3-0004" || \n    ps=="8X1N09MRQ5D0-4CX8" || ps=="8MZBMMCK1252-0001" || ps=="8QJP6K35J7SV-0003" || ps=="8ZG5FH1FMDSR-4FTL" || ps=="8X4HTZNFGG38-0019" || ps=="8SBJXM0M58T4-HV3T" || ps=="93D7NWW5NQ3H-K6RF" || ps=="929894RG3GD7-CC7L" || \n    ps=="8WVJ5P8DD2TH-3J13" || ps=="8WVJ5P8DD2TH-6Z7C" || ps=="8X4HTZNFGG38-JHZC" || ps=="929894RG3GD7-DS36" || ps=="929894RG3GD7-DWCM" || ps=="929894RG3GD7-9LC4" || ps=="8X4HTZNFGG38-GV99" || ps=="8WVJ5P8DD2TH-GXV3" || \n    ps=="8XLK0G60TLB6-C7QT" || ps=="8XLK0G60TLB6-DV4P" || ps=="94C4Z4FRS9SV-4VKK" || ps=="94C4Z4FRS9SV-3VG5" || ps=="8X4HTZNFGG38-1F4J" || ps=="8QWCRTQ8V8XG-4VB5" || ps=="8MCPZJJCC98C-FNJ9" || ps=="929894RG3GD7-M0NF" || \n    ps=="8MCPZJJCC98C-2MQS" || ps=="94C4Z4FRS9SV-L7KB" || ps=="94C4Z4FRS9SV-M8B8" || ps=="94C4Z4FRS9SV-8TK8" || ps=="8X4HTZNFGG38-0DJ9" || ps=="94C4Z4FRS9SV-KVNP" || ps=="8NN2SMPXK1FR-6HGK" || ps=="929894RG3GD7-CVS7" || \n    ps=="8WVJ5P8DD2TH-JFBV" || ps=="929894RG3GD7-5L7P" || ps=="8XLK0G60TLB6-JP2P" || ps=="9408KGXP4XJL-FN89" || ps=="8X4HTZNFGG38-BFM1" || ps=="929894RG3GD7-JR74" || ps=="904H27D0CBWN-HG5F" || ps=="8MCPZJJCC98C-2NQP" || \n    ps=="8WVJ5P8DD2TH-28M9" || ps=="929894RG3GD7-8CRZ" || ps=="929894RG3GD7-1H5G" || ps=="929894RG3GD7-0K24" || ps=="94C4Z4FRS9SV-KTLM" || ps=="929894RG3GD7-BN0M" || ps=="94FC0BDGQ7WV-3XVD" || ps=="94FC0BDGQ7WV-FLQD" || \n    ps=="946627FB12T1-D639" || ps=="946627FB12T1-02MB" || ps=="946627FB12T1-KKTG" || ps=="929894RG3GD7-5SD6" || ps=="8NR6D2WCLC72-KV52" || ps=="8SRDF62SWKPF-2VQK" || ps=="929894RG3GD7-89FF" || ps=="94FC0BDGQ7WV-25ZQ" || \n    ps=="929894RG3GD7-7SCP" || ps=="946627FB12T1-1PRD" || ps=="8WVJ5P8DD2TH-8NNW" || ps=="946627FB12T1-00GQ" || ps=="94FC0BDGQ7WV-2866" || ps=="94FC0BDGQ7WV-2639" || ps=="946627FB12T1-2D8G" || ps=="8PG9R8WB09L0-0009" || \n    ps=="8NR6D2WCLC72-2HSF" || ps=="8NR6D2WCLC72-3RSN" || ps=="946627FB12T1-GT8C" || ps=="94C4Z4FRS9SV-7SHJ" || ps=="946627FB12T1-9JZD" || ps=="8NR6D2WCLC72-810D" || ps=="94FC0BDGQ7WV-2ZQF" || ps=="929894RG3GD7-6ZV4" || \n    ps=="929894RG3GD7-50FB" || ps=="946627FB12T1-CNH9" || ps=="8MZBMMCK15G2-0003" || ps=="946627FB12T1-502J" || ps=="8QWCRTQ8V8XG-L323" || ps=="8QWCRTQ8V8XG-1QTX" || ps=="8SRDF62SWKPF-28P9" || ps=="8QWCRTQ8V8XG-CMNS" || \n    ps=="8MZBMMCK15G2-0001" || ps=="8XTMB6C575MD-GLGC" || ps=="8QWCRTQ8V8XG-2M6T" || ps=="8X4HTZNFGG38-KCKP" || ps=="946627FB12T1-31N4" || ps=="8SRDF62SWKPF-C74D" || ps=="904H27D0CBWN-K5HG" || ps=="946627FB12T1-59PW" || \n    ps=="8QWCRTQ8V8XG-31HC" || ps=="929894RG3GD7-6TXN" || ps=="929894RG3GD7-CBKS" || ps=="8MSJBNL8HBXW-9G7L" || ps=="8NR6D2WCLC72-6Z3P" || ps=="8SRDF62SWKPF-2GZM" || ps=="929894RG3GD7-J319" || ps=="8MSJBNL8HBXW-BV79" || \n    ps=="8SRDF62SWKPF-CMQJ" || ps=="929894RG3GD7-FQK5" || ps=="946627FB12T1-01S6" || ps=="8NN2SMPXK1FR-CT90" || ps=="946627FB12T1-HR8L" || ps=="94FC0BDGQ7WV-3MWT" || ps=="8NR6D2WCLC72-J490" || ps=="8MZBMMCK15G2-0004" || \n    ps=="8XTMB6C575MD-57K3" || ps=="8XTMB6C575MD-7DQ8" || ps=="946627FB12T1-3ZX4" || ps=="946627FB12T1-BG50" || ps=="929894RG3GD7-83Q9" || ps=="8QWCRTQ8V8XG-F24R" || ps=="946627FB12T1-B16M" || ps=="8S3V46W10HFR-M2HD" || \n    ps=="9408KGXP4XJL-HT2G" || ps=="9408KGXP4XJL-HTS6" || ps=="8XTMB6C575MD-L3VT" || ps=="8MZBMMCK15G2-0002" || ps=="8WVJ5P8DD2TH-4T87" || ps=="929894RG3GD7-HDCF" || ps=="946627FB12T1-3K1B" || ps=="8NR6D2WCLC72-8Q8M" || \n    ps=="929894RG3GD7-HC28" || ps=="946627FB12T1-JCJT" || ps=="946627FB12T1-HT6Q" || ps=="946627FB12T1-2CJX" || ps=="946627FB12T1-0C0T" || ps=="946627FB12T1-8QTP" || ps=="8QWCRTQ8V8XG-1ZWK" || ps=="8QWCRTQ8V8XG-KG8S" || \n    ps=="8QWCRTQ8V8XG-9R2P" || ps=="8NN2SMPXK1FR-HV0Z" || ps=="8NN2SMPXK1FR-GVNV" || ps=="8QWCRTQ8V8XG-H5SK" || ps=="929894RG3GD7-243Q" || ps=="8QWCRTQ8V8XG-6TF7" || ps=="8MCPZJJCC98C-4PTB" || ps=="904H27D0CBWN-2L0C" || \n    ps=="929894RG3GD7-86V2" || ps=="929894RG3GD7-D09T" || ps=="8QWCRTQ8V8XG-321S" || ps=="946627FB12T1-0BCZ" || ps=="929894RG3GD7-9X8V" || ps=="8S3V46W10HFR-5JSF" || ps=="8S3V46W10HFR-0DHP" || ps=="8S3V46W10HFR-DLR9" || \n    ps=="8S3V46W10HFR-GWHX" || ps=="9408KGXP4XJL-5DLK" || ps=="9408KGXP4XJL-CTMC" || ps=="946627FB12T1-1G5R" || ps=="946627FB12T1-J5VD" || ps=="8RH63J18M28T-BX58" || ps=="8QM7KKP2KX8L-GG05" || ps=="916ZQBWNGKZ5-28NJ" \n\n){\ninScope=1\n}\nif (inScope) {\nvar image = new Image(1, 1);\nimage.src ="https://alb.reddit.com/rp.gif?id=t2_ch5mi&event=Purchase&integration=noscript";\n}\n}}}\ncatch(err)\n{\n_satellite.logger.error("Media_/LL-LL/ Reddit Surface Purchase");\n}}',language:"javascript"}}]},{id:"RLe7c9245a98a34085a2d36b5bc0e59655",name:"Media_/LL-LL/ Verizon Intel Purchase",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/dateRange.js",settings:{end:"2022-07-01T00:00:00Z",start:"2021-08-12T00:00:00Z"}},{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'//Verizon Intel Conversion Pixel\nvar ProdIds = ["8MBBH5XNQ26W-B8JJ", "8N6JC13K88R3-0R4G","8RNR51C616JN-GN27","8V98SNJCL7S5-JB2L","8VKVC3HV7MN3-0XQ4", "8WDP52FJ5BW6-6TRK", "8WK9MPLRT4J6-0ZK7", "92ZT4D2BFXZ7-D1V2", "93PH0KP05GVS-G707", "947XD4Q6JGMB-8VHK", "8P3VQXVFXB8T-53FX", "8S5MW3SB3WH3-CB2L", "8TLRDNCNFB2W-HJ6N","8V1ZZN1705ND-7MFP","8XPNZ11M83CX-KHLP","8XV46FCD1K60-LMGR","91NC3TWTBS77-4S46","940V5N9LPW8S-3XC9","8N4MP37WP3TW-K158","8P5Z681FM7SG-1L61","8PMX6PND6T7M-4RRJ","8QDJP7HHPM4X-35JM","8QHLW3FRLZ50-8HT3","8R1CPF43RLGG-JCVZ","8SWR7XV37VJS-LMGR","8TFR99W15F0N-GRPP","8TPB638BVLC3-KV7J","8TTJ7DWB4L7J-7XT7","8VJVMX57SF6H-1R0D","8VKJT6BXRBTT-8Z32","8WBGNTHHTBT3-DR6Q","8XPSVT5P7P97-L12Q","9018RPZRS5QC-CQ7L","92HKS90BGLVK-DRWD","9331N6HDRNJH-G5HV","8N1D1TBVWDQX-MCWK","8N8N7926WBH7-9WJV","8PW8SGQW0ZKL-CCM5","8QB0TGT9CH62-D4GT","8QHTD06GZVS4-DM19","8T46HJBH5LJ4-9HHZ","8VZS01B31W39-9X7Q","8WJPPTH2Z2VK-6403","8ZMR8B6L9D98-9NGF","90VS480C9LV1-8G38","91M891L4C1P2-5PXH","938HBL4D1L5S-L1XF","8MM7SQSJRTJ3-89K6","8RBMPP1KB0P5-06ZS","8WN2VT4FQMT1-HC2D","8WZRPCJLCZC8-CTQ9","8X3212P6575Q-F1NM","902J8R09XZN7-3WX8","92PTWSLZLML7-C9WL","93N2N33HKCZ6-0QGC","8MPZ2S6WPN6Q-2S1R","8N6Z0696WK9H-9FM8","8PGCRF362PMQ-3KPK","8PRZLRDW91HW-4HC8","8RBMPP1KB0P5-85ZC","8R6WBMVWBTB2-BHLF","8RDDD3KW3JT1-DFW2","8RLTRBHFHVR2-5ZVW","8T38KCB9TS6J-2R23","8TN74R7JDPVX-7GQ7","8XX5FZ602G3J-9RSK","8ZPJ34TRGBSW-MCPB","9030MRLSKNKQ-HR75","92BVJ237TD5H-LRLL","92RFGLVGLGH6-8PCT","93GP7GTCSGP6-24J3","93VLG6Q3MTDH-86DN","94GHD48R24G5-7SHN","8MJQMBD0Q63M-5P8Q","8QVFVKTXQJKQ-6403","8R44XH29FDCS-7ZFW","8R90BSLNBDV3-HF6S","8SGXFNB06DNW-6RLD","8V5J9JDGS1PN-H3R3","8ZF00WQQCNL6-54B9","92B8DQ7412KM-D3JB","92D2BF52X92G-6F9R","92J0L2VMFCQM-B1PL","94109T3VWKKZ-DT32","94CZ66KVGG05-2VXB","8NFC4VTH7H85-2JB9","8P0C9W16R212-LZ5Z","8PXKQBTXR8DT-7QMN","8Q42JBD9HN8P-JJH8","8QVL59ZRS6QR-CJF6","8RBMPP1KB0P5-03HL","8RBMPP1KB0P5-JHKM","8RBMPP1KB0P5-M0DW","8RH52ZFQMN54-8XPH","8S869KLMWNZZ-2WD8","8SNLGX6M7T2N-981P","8SVWBNDF3GQX-1SJH","8WBQFL7P88VW-6360","8WMLV0JNRKP9-5C9V","8Z43LDLCKXHB-50NM","8ZZ6S7H1GXQN-DWNW","919755ZR2V9X-8P7H","92B6VNCSDXDR-LVT2","92RGCNBNLTC8-1WHW","92WGTC7J8TW7-J1X6","93JMJ3S1L0Q6-H7KW","8QXTJ6R4JR4J-CM5T","8RM3FX4DF8S0-DBJ7","8X9R9LZ9LZC1-K7XX","8XBGP60M5X7V-C8BH","8Z1XZVZ23CCT-9CG8","90CND5G044X4-597F","90H2LJX1Z20C-48N4","93FKSHD3FW9B-DGV7","9486HGBVVP08-L4PP","94HH753VLZRQ-3CBC","8MPMVZKHQDCH-5PCS","8NLXKHRD4F5H-LB5J","8P16043R5LWH-HD2V","8Q608SK6243F-6G64","8QKT9WHDJ64X-8TPK","8QWCJ8T0W1KL-5ZB3","8RBMPP1KB0P5-25Z0","8SHS6884DSB6-1FST","8SM1L2HHFNK7-JXG6","8SNHK4KD0SXS-M8P9","8TKM0Q0NGQ2H-GGRV","8WTWWRRLWHNX-J8FT","8XL8KL8J72K7-32RJ","8XWG2QG6C7ZX-H281","8ZVNZJ6XKL9F-B7ZB","901Z559K08DM-7Q4N","90LWXQT7RGN5-7ZKJ","928NKS7X3PHL-5KJW","9433NPPRPNHW-DC9S","8NK56K1QS0HQ-6J7Z","8P7B2H1JB09H-BR46","8PD6FJD0F5LN-1L8C","8PJ7VF874V83-4MSJ","8PTR6JKJCW0N-M7SW","8QFLG68DM2Z6-5F7Z","8QTKVQ4TP25K-8P7B","8RBMPP1KB0P5-7N16","8S6RFVC67CVD-FN03","8SPRVG4VP1SF-B1PN","8V3RSTHVS030-4GSP","8VMJWGDQ9WQX-5S0W","8XXPDT84JLTC-CGH4","8ZR46GB4640X-G3K1","8ZXHQ9K4QF08-DRPT","8ZZQJRF5C191-5JR2","91FGGM4FPST2-FWXM","91LF05JFK79S-4WJ1","91NXHK0X2WC0-8CMW","92ZL9HT9L6WV-881Z","92ZZGCK3VT09-7B0V","93FBLZ9KHCM1-1T9G","8MCZWVH7MQH3-DTD6","8MP95M2B95KB-L84C","8NC2CDLKV6QG-GZ77","8NFC4VTH7H85-HF3S","8PDLXDL9C7H9-7BBX","8QP9V8J31VZ0-3BZW","8RBMPP1KB0P5-1FXQ","8RBMPP1KB0P5-1W60","8RBMPP1KB0P5-20XR","8RBMPP1KB0P5-KPFR","8SL5J7W62V51-0WSD","8T0BDK5XWX88-9JFT","8T4FJD8FG7ML-JGDH","8TH02027N32J-7KK5","8THSTBZ641DH-LQB8","8V282TS7BWKG-KF4W","8V79DPWNQPZX-JKXP","8VP3HT9FV22J-956M","8WLR0NL58799-D0BS","8X8XJNL58VBF-1058","8X8ZKQCX06P4-GVQ9","913PF6TNVPJF-JHBG","919K47WMRKNF-47D2","92ZT4D2BFXZ7-9RPQ","933BFPFP2VPC-DVVV","933DZQNS8NW0-BR6Z","934BFN9HBMT5-HVNJ","9350057L72XG-8QLF","93TBPJTC7XKB-2SZ1"];\nif (_TMDL.geo=="US" || _TMDL.geo=="CA") {\ntry\n{\nvar ps=""\nfor (var i=0; i<_TMDL.pids.length; i++) {\n  if (_TMDL.pidsku.length > i) {\n    ps = _TMDL.pidsku[i].toUpperCase();\n    if (ProdIds.includes(ps)){\n      var image = new Image(1, 1);\n      image.src ="https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&he={INSERT_MACRO_HERE}&ec=intelpurchases";\n  }}}}\ncatch(err)\n{\n_satellite.logger.error("Media_/LL-LL/ Verizon Intel Purchase");\n}}',language:"javascript"}}]},{id:"RLa95c5c1f9ffa4ad69c72b6459e7ef0bc",name:"AU/ConsumerConsultationTag",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-au/store/b/online-computer-shopping-appointments",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'// JavaScript source code\ntry {\n    //Floodlight pv\n    var image = new Image(1, 1);\n    image.src = "https://ad.doubleclick.net/ddm/activity/src=8406733;type=corpothe;cat=corpo0;u1=" + _TMDL.geo + ";u2=" + _TMDL.ll + ";u6=" + encodeURIComponent(_TMDL.pagename) + ";u25=" + _TMDL.pids[0] + ";u26=" + encodeURIComponent(_TMDL.pnames[0]) + ";u52=Visit;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=1?";\n\n    // Yahoo pv\n    var image = new Image(1, 1);\n    image.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&he={INSERT_MACRO_HERE}&ea=AUSLandingPageVisit";\n\n    // training - training\n    $(\'a[href*="https://digitalreservations.microsoft.com/en-au/appointment/create"]\').on("mousedown", function () {\n        var cN = $(this).attr("data-bi-cn");\n        \n        var image = new Image(1, 1);\n        image.src = "https://ad.doubleclick.net/ddm/activity/src=8406733;type=corpothe;cat=corpo000;u1=" + _TMDL.geo + ";u2=" + _TMDL.ll + ";u6=" + encodeURIComponent(_TMDL.pagename) + ";u25=" + _TMDL.pids[0] + ";u26=" + encodeURIComponent(_TMDL.pnames[0]) + ";u50=" + cN + ";u52=Click;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=1?";\n\n        //Yahoo clk\n        image2 = new Image(1, 1);\n        image2.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&he={INSERT_MACRO_HERE}&ea=AUSbuttonclick";\n    });\n\n}\ncatch (err) {\n    _satellite.logger.error("AU/ConsumerConsultationTag");\n}',language:"javascript"}}]},{id:"RL10436da76aec413189e4b07115fde524",name:"Media_/LL-LL/Commercial Consultation Tag (RT)",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-au/store/b/business-consultation",valueIsRegex:!0},{value:"/en-au/store/b/business-consultation/",valueIsRegex:!0},{value:"/en-gb/store/b/business-consultation/",valueIsRegex:!0},{value:"/en-gb/store/b/business-consultation",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}},{modulePath:"core/src/lib/conditions/dateRange.js",settings:{end:"2021-11-05T00:00:00Z",start:"2021-06-21T00:00:00Z"}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'\ntry\n{\n// Floodlight pv\nvar image = new Image(1, 1);\nimage.src ="https://ad.doubleclick.net/ddm/activity/src=8406733;type=corpothe;cat=corpo0;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u52=Visit;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=1?";  \n  \n// Floodlight Click\nvar image = new Image(1, 1);\njQuery("a.c-hyperlink:Lt(1),a.c-call-to-action:Lt(1)").on("mousedown", function(){  \nvar image = new Image(1, 1);\nimage.src ="https://ad.doubleclick.net/ddm/activity/src=8406733;type=corpothe;cat=corpo000;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=Book a Consultation;u52=Click;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=1?";\n\n//Xandr\nimage2 = new Image(1, 1); \nimage2.src="https://secure.adnxs.com/px?id=1488447&t=2";\n\n});\n\n}\ncatch(err)\n{\n\t_satellite.logger.error("Media_/LL-LL/Consumer Consultation Tag (RT)");\n}\n\n',language:"javascript"}}]},{id:"RL254c089354a74298ae2263043a49482b",name:"OffAdobeCV",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'/* Office Adobe DCO CV\n*/\n\ntry\n{\n\tvar inScope=0;\n\tvar ps;\n\tvar rand = parseInt(1E5 * 1E4 * Math.random() * Math.random());\n\tvar u="";\n\tvar totunits = 0;\n\t//var lang = (_TMDL.ll.indexOf("-")>-1) ? _TMDL.ll.split("-")[0].toLowerCase() : "";\n\t//var utstring = "&ut1="+_TMDL.pidsku.join("%2C")+"&ut2="+lang+"&ut3="+_TMDL.geo.toLowerCase()+"&cachebuster="+rand;\n\n\tfor (var i=0; i<_TMDL.pidsku.length; i++) {\n\t\tps = _TMDL.pidsku[i].toUpperCase();\n\t\tif (ps=="CFQ7TTC0K5DM-007R" || ps=="CFQ7TTC0K5DM-007W"){\n\t\t\t// Home Annual\n\t\t\tinScope=1;\n\t\t\ttotunits+=parseInt(_TMDL.quantities[i],10);\n\t\t} else if (ps=="CFQ7TTC0K5FB-0002" || ps=="CFQ7TTC0K5FC-0002" || ps=="CFQ7TTC0K5FB-000D" || ps=="CFQ7TTC0K5FC-000C") {\n\t\t\t// Home and Student 2016 (for Mac and Windows SKUs)\n\t\t\tinScope=1;\t\t\n\t\t\ttotunits+=parseInt(_TMDL.quantities[i],10);\n\t\t} \n\t}\n\n\tif (~_TMDL.pageType.indexOf("receipt") && _TMDL.isprod && inScope) {\n\t\t// purchase\n\t\tu="https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50106&ActionName=Microsoft_Store_Office_Conversion_Pixel"\n\t\t\t//+"&Revenue="+_TMDL.totamount  // updated by request from Carat (Robert Jordan) on 11/8/18\n\t\t\t+"&Revenue="+totunits\n\t\t\t+"&TransactionID="+_TMDL.purchaseID\n\t\t\t+"&Currency="+_TMDL.cc\n\t\t\t+"&cachebuster="+rand;\n\t\tBootstrapper.imageRequest(u); \n\t}\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== "undefined") {_TMutils.logRuleCall("OffAdobeCV",err.message,u);}\n\t_satellite.logger.error("OffAdobeCV");\t\n}\n',language:"javascript"}}]},{id:"RL8c1cb23cf17e482fab05494a9c978fa4",name:"Media_/JA-JP/Surface Indirect Commercial Category Page (RT)",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/ja-jp/store/b/surfaceforbusiness",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{var rand = parseInt(1E5 * 1E4 * Math.random() * Math.random());\n// Shop now and Shop Essential Bundle buttons\njQuery("a.c-call-to-action:lt(14)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="https://secure.adnxs.com/px?id=1268102&t=2";\nimage2 = new Image(1, 1); \nimage2.src="https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50188&ActionName=Store_Site_Visit&cachebuster="+rand;\n});\n  \n//Product Card Clicks\njQuery("div.m-content-placement.x-clearfix:lt(2)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="https://secure.adnxs.com/px?id=1268102&t=2";\nimage2 = new Image(1, 1); \nimage2.src="https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50188&ActionName=Store_Site_Visit&cachebuster="+rand;\n });\n  \n }\ncatch(err)\n{\n\t_satellite.logger.error("Media_/JA-JP/Surface Indirect Commercial Category Page (RT)");\n}\n',language:"javascript"}}]},{id:"RL39439012f01b464592c200a1997c464c",name:"AMOSurfCV",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){
return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'/* \nRule: AMOSurfCV\n\nOriginally placed for Klarna\n\n<img src="https://pixel.everesttech.net/px2/4249?px_evt=t&ev_Surface_Plus_Consumer_purchase_orders=1&ev_Surface_Plus_Consumer_purchase_products=&ev_Surface_Plus_Consumer_purchase_revenue=&ev_transid=" width="1" height="1"/>\n\nThe below updates can be made to the pixel macros to include transaction ID, order, products and revenue: \nev_transid= Unique transaction id, client should dynamically pass order id.\nev_Surface_Plus_Consumer_purchase_orders= Count should be 1, which has been hardcoded.\nev_Surface_Plus_Consumer_purchase_products= Should pass quantity of products in order.\nev_Surface_Plus_Consumer_purchase_revenue= Should pass the revenue for order.\n*/\n\n\ntry {\n\tvar i=0,inScope=0,totamt=0,totqty=0, imageURL="",cc="";\n\tfor (i=0; i<_TMDL.pidsku.length; i++) {\n\t\tif (~_TMDL.pnames[i].toLowerCase().indexOf("surface")) {\n\t\t\tinScope=1;\n\t\t\ttotamt+=_TMDL.sales[i];\n\t\t\ttotqty+=_TMDL.quantities[i]\n\t\t} \n\t}\n\tcc=(_TMDL.cc)?_TMDL.cc.toLowerCase() : "";\n\n\timageURL = "https://pixel.everesttech.net/px2/4249?px_evt=t"\n\t\t+"&ev_Surface_Plus_Consumer_purchase_orders=1"\n\t\t+"&ev_Surface_Plus_Consumer_purchase_products="+totqty\n\t\t+"&ev_"+cc+"_Surface_Plus_Consumer_purchase_revenue="+totamt\n\t\t+"&ev_transid="+_TMDL.purchaseID;\n\t\t\n\tif (_TMDL.pT=="rP" && inScope) {\n\t\tBootstrapper.imageRequest(imageURL);\n\t}\n} catch(e) {\n\tconsole.log("surfaceplusamoerr");\n}',language:"javascript"}}]},{id:"RL1bd4a77a2f604eb69d942ed8e47a1507",name:"Media_/fr-fr/store/b/sale",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/fr-fr/store/b/sale"},{value:"/fr-fr/store/b/sale/"}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n  \n// ADNXS\n   //Carousel\n jQuery("div:eq(31)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "//secure.adnxs.com/px?id=1268102&t=2";\n});\n //Featured Product Image Links\njQuery(".m-content-placement-item:lt(3)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "//secure.adnxs.com/px?id=1268102&t=2";\n});\n //Product Cards  \njQuery("div.m-channel-placement-item.f-wide.f-full-bleed-image").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "//secure.adnxs.com/px?id=1268102&t=2";\n});\n  \n\n\n//DoubleClick\n  //Carousel\n jQuery("div:eq(31)").on("mousedown", function(){\n    Bootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=Deals"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?");\n});\n  \n  //Featured Product Image Links\njQuery(".m-content-placement-item:lt(3)").on("mousedown", function(){\n    Bootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=Shop Now"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?");\n});\n  \n  //Product Cards  \njQuery("div.m-channel-placement-item.f-wide.f-full-bleed-image").on("mousedown", function(){\n    Bootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=Product Options"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?");\n});\n  \n  \n//Yahoo\n  //Carousel\n jQuery("div:eq(31)").on("mousedown", function(){\n    Bootstrapper.imageRequest("https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick");\n});\n  \n  //Featured Product Image Links\njQuery(".m-content-placement-item:lt(3)").on("mousedown", function(){\n    Bootstrapper.imageRequest("https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick");\n});\n  \n  //Product Cards  \njQuery("div.m-channel-placement-item.f-wide.f-full-bleed-image").on("mousedown", function(){\n    Bootstrapper.imageRequest("https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick");\n});\n\n}\ncatch(err)\n{\n\t_satellite.logger.error("Media_/fr-fr/store/b/sale");\n}\n  ',language:"javascript"}}]},{id:"RLdc101373a5e7415e876f8ac4e95a3db7",name:"ContentSquare - Confirmation Page",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"try {\nfunction loadjsfile(filename){\n    if (!filename) {\n        return;\n    }\n    var fileref=document.createElement('script')\n    fileref.setAttribute(\"type\",\"text/javascript\")\n    fileref.setAttribute(\"src\", filename)\n   if (typeof fileref!=\"undefined\")\n    document.getElementsByTagName(\"head\")[0].appendChild(fileref)\n}\nfunction getGeoMarketLink() {\n    var geoMarket = /&market=([a-z]{2})&/im.exec(window.location.search) && /&market=([a-z]{2})&/im.exec(window.location.search)[1]; //Extract market location from the query param\n    var CSGeoGUID; //define placeholder for market specific GUID\n    switch (geoMarket) { //Assign GUID to its respective market\n    case 'US':\n    \xa0\xa0  CSGeoGUID = '05d32363-d534-4d93-9b65-cde674775e71';\n    \xa0\xa0  break;\n    case 'CA':\n    \xa0\xa0\xa0 CSGeoGUID = '63ed781a-0b4b-47a5-bbec-c555ac4835f3';\n    \xa0\xa0\xa0 break;\n    case 'BR':\n    \xa0\xa0\xa0 CSGeoGUID = 'e5577ace-d4c5-461f-b2a3-97eea3f39911';\n    \xa0\xa0\xa0 break;\n    case 'AU':\n    \xa0\xa0\xa0 CSGeoGUID = 'b8569749-38c8-434f-a4e5-457de94c4196';\n    \xa0\xa0\xa0 break;\n    case 'JP':\n    \xa0\xa0\xa0 CSGeoGUID = '82cbb6ea-e5bd-42bc-a3ed-9ab7ce1b5163';\n    \xa0\xa0\xa0 break;\n    case 'GB':\n    \xa0\xa0\xa0 CSGeoGUID = '554c90f5-1a44-4097-9def-c02c0e5a3718';\n    \xa0\xa0\xa0 break;\n    case 'FR':\n    \xa0\xa0\xa0 CSGeoGUID = 'a08fefef-0f4f-4c7d-8f54-2abbf4ab7d61';\n    \xa0\xa0\xa0 break;\n    case 'DE':\n    \xa0\xa0\xa0 CSGeoGUID = '77a061a5-1c09-4b9a-bf5f-1b5b67bba94c';\n    \xa0\xa0\xa0 break;\n    case 'IT':\n    \xa0\xa0\xa0 CSGeoGUID = '67b0cfc3-fb2e-44cb-b361-72a4c939e3dc';\n    \xa0\xa0\xa0 break;\n    case 'NL':\n    \xa0\xa0\xa0 CSGeoGUID = 'a1967146-1da8-459a-a731-7aed4cca30fb';\n    \xa0\xa0\xa0 break;\n    case 'NZ':\n    \xa0\xa0\xa0 CSGeoGUID = 'c4b2b846-8b73-415f-abbe-016f561ebfec';\n    \xa0\xa0\xa0 break;\n    case 'SG':\n    \xa0\xa0\xa0 CSGeoGUID = '53de0804-eb07-467b-bda1-1d5b5116d441';\n    \xa0\xa0\xa0 break;\n    case 'ES':\n    \xa0\xa0\xa0 CSGeoGUID = '1fac8122-e96d-4248-891b-bcfeadb26d0d';\n    \xa0\xa0\xa0 break;\n    default:\n    \xa0\xa0\xa0 break;\n    }\n    var CSLink = CSGeoGUID && 'https://cdnssl.clicktale.net/www32/ptc/' + CSGeoGUID + '.js';\n    return CSLink;\n}\nloadjsfile(getGeoMarketLink());\n  } \ncatch (err) { satellite.logger.error(\"ContentSquare - Confirmation Page\");}",language:"javascript"}}]},{id:"RLb4c32f3731ab4724bcfb8aa2c6e04d2a",name:"Media_/LL-CA/Surface Indirect Commercial Category Page (RT)",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-ca/store/b/surfaceforbusiness",valueIsRegex:!0},{value:"/fr-ca/store/b/surfaceforbusiness",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{var rand = parseInt(1E5 * 1E4 * Math.random() * Math.random());\n// Shop now and Shop Essential Bundle buttons\njQuery("a.c-call-to-action:lt(19)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="https://secure.adnxs.com/px?id=1268102&t=2";\nimage2 = new Image(1, 1); \nimage2.src="https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50188&ActionName=Store_Site_Visit&cachebuster="+rand;\n});\n  \n//Product Card Clicks\njQuery("div.m-content-placement.x-clearfix:lt(4)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="https://secure.adnxs.com/px?id=1268102&t=2";\nimage2 = new Image(1, 1); \nimage2.src="https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50188&ActionName=Store_Site_Visit&cachebuster="+rand;\n });\n  \n }\ncatch(err)\n{\n\t_satellite.logger.error("Media_/LL-CA/Surface Indirect Commercial Category Page (RT)");\n}\n',language:"javascript"}}]},{id:"RL0850ad6b15104b70b962304589f9e22d",name:"Media_/en-us/b/ Snap Pixel",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-us/store/b/black-friday",valueIsRegex:!0},{value:"/en-us/store/b/black-friday/",valueIsRegex:!0},{value:"/en-us/store/b/cyber-monday",valueIsRegex:!0},{value:"/en-us/store/b/cyber-monday/",valueIsRegex:!0},{value:"/en-us/store/b/sale",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try {\n    var timestamp = new Date();\n    var qs = "rand=" + Math.ceil(Math.random() * 99999999) + timestamp.getUTCFullYear() + timestamp.getUTCMonth()+ timestamp.getUTCDate() + timestamp.getUTCHours() + timestamp.getUTCMinutes() + timestamp.getUTCSeconds() + timestamp.getUTCMilliseconds();\n   image = new Image(1, 1);\n    image.src = "https://tr.snapchat.com/p?pid=c99b5ed8-ec61-4350-b6a8-77e2eabd90ab&ev=PAGE_VIEW&v=2.3&"+qs+"&pl="+_TMDL.host+_TMDL.path+"&u_hem=";\n  image2 = new Image(1, 1);\n    image2.src = "https://tr.snapchat.com/p?pid=0e03788f-4580-42d4-b751-693344c41c6f&ev=PAGE_VIEW&v=2.3&"+qs+"&pl="+_TMDL.host+_TMDL.path+"&u_hem=";\n   image3 = new Image(1, 1); \n    image3.src="https://tr.snapchat.com/cm/s?pnid=140";\n}\ncatch(err)\n{\n    _satellite.logger.error("Media_/en-us/b/SnapPixel");\n}',language:"javascript"}}]},{id:"RLf09c4e2b3a1a48e2aff0ef3e101b1029",name:"Media_/en-gb/p/surface-pro-7 Twitter",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-gb/p/surface-pro-7",valueIsRegex:!0},{value:"/en-gb/d/surface-pro-7",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n//Page View  \nvar image = new Image(1, 1);\nimage.src ="https://analytics.twitter.com/i/adsct?p_id=Twitter&p_user_id=0&txn_id=nzzcs&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";\n  \nvar image2 = new Image(1, 1);\nimage2.src ="//t.co/i/adsct?p_id=Twitter&p_user_id=0&txn_id=nzzcs&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";  \n\n }\ncatch(err)\n{\n\t_satellite.logger.error("Media_/en-gb/p/surface-pro-7 Twitter");\n}\n',language:"javascript"}},{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n  \n//Clicks\n jQuery("a.c-button:Lt(1),a.c-hyperlink:Lt(2)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="https://analytics.twitter.com/i/adsct?p_id=Twitter&p_user_id=0&txn_id=nzzcs&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";\n  \nvar image2 = new Image(1, 1);\nimage2.src ="//t.co/i/adsct?p_id=Twitter&p_user_id=0&txn_id=nzzcs&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";   \n });\n\n\n }\ncatch(err)\n{\n\t_satellite.logger.error("Media_/en-gb/p/surface-pro-7 Twitter");\n}\n',language:"javascript"}}]},{id:"RLa7f4e9bd070e4fedb22dccc5fbfd1f05",name:"DCM.HomeBar",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-us/store/b/sale"},{value:"/en-us/store/b/sale/"},{value:"/fr-ca/store/b/sale/"},{value:"/fr-ca/store/b/sale/"},{value:"/en-ca/store/b/sale"},{value:"/en-ca/store/b/sale/"},{value:"/en-gb/store/b/student"},{value:"/en-gb/store/b/student/"},{value:"/fr-fr/store/b/student"},{value:"/fr-fr/store/b/student/"},{value:"/de-de/store/b/student"},{value:"/de-de/store/b/student/"}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try {\njQuery("#uhf-g-nav").on("mousedown", function(){\n    Bootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=Homebar Options "+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?");\n\t});\n} \ncatch(err) {\n\t_satellite.logger.error("DCM.Homebar");\n}',language:"javascript"}}]},{id:"RLab4fd1d7566a4c858a54b382ad0c6b73",name:"BingSurfClkCustom (AEM/RT)",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:80}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return~window.location.pathname.toLowerCase().indexOf("/d/")&&~window.location.pathname.toLowerCase().indexOf("surface")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"/*\n\nRule: BingSurfClkCustom\n\nreturn (~window.location.pathname.toLowerCase().indexOf(\"/p/\") && ~window.location.pathname.toLowerCase().indexOf(\"surface\")\t)\n\n*/\n\nvar tempobj; \n\ntry {\n\n\tif (~window.location.pathname.toLowerCase().indexOf(\"surface\") && ~window.location.pathname.toLowerCase().indexOf(\"/d/\") && window.navigator.userAgent.toLowerCase().indexOf(\"soasta\")<0 && (typeof uetq=='object')) {\n\n\t\ttempobj={};\n\t\t\n\t\tif (_TMDL.pidsku.length > 0) {\n\t\t\ttempobj.ecomm_prodid = (_TMDL.pidsku.length>0) ? _TMDL.pidsku : \"\";\n\t\t\ttempobj.ecomm_pagetype = \"product\";\n\t\t\ttempobj.items = [\n\t\t\t\t{\n\t\t\t\t  'id': _TMDL.pidsku[0],\n\t\t\t\t  'category': 'surface',\n\t\t\t\t  'price' : _TMDL.sales[0]\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t\t\n\t\t// Configure Now CTA\n        /*\n\t\t$(document).on('mousedown','button[id*=\"ConfigureDeviceButton\"]','', function() {\n\t\t\twindow.uetq.push('event','configurenow', tempobj); \n\t\t});\n        */\n      \n\t\t// Configure Now CTA - Updated 7/19 to correct ID\n        jQuery(\"a:contains('Configure now'),button:contains('Configure now')\").on(\"mousedown\", function(){\n            window.uetq.push('event','configurenow', tempobj); \n         });\n      \n\t\t// BuildYourBundle CTA\n        $(document).on('mousedown','button[id*=\"buttons_BuildABundleButton\"],a[href*=\"/store/build/\"]','', function() {\n\t\t\twindow.uetq.push('event','buildyourbundle', tempobj); \n\t\t});\n\t\t\t\n\t\t\n\t\t// check your eligibility CTA\n\t\t\n\t\t$(document).on('mousedown',\"a[href*='student-discounts?successurl']\",'', function() {\n\t\t\twindow.uetq.push('event','checkeligibility', tempobj); \n\t\t});\n      \n      \t// Add to Cart button, particularly needed for Surface Go PDP\n\t\t$(document).on('mousedown','button[id*=\"buttons_AddToCartButton\"]','', function() {\n\t\t\twindow.uetq.push('event','addtocartbutton', tempobj); \n\t\t});\t\t\n\t}\n} catch(bingerr) {console.log(\"bing onclick err\");}\n",language:"javascript"}}]},{id:"RL18bbccdb78fa4a5aae196c215fa6cb99",name:"Media_/FR-FR/Surface Indirect Commercial Category Page (RT)",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/fr-fr/store/b/surfaceforbusiness",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{var rand = parseInt(1E5 * 1E4 * Math.random() * Math.random());\n// Shop now and Shop Essential Bundle buttons\njQuery("a.c-call-to-action:lt(12)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="https://secure.adnxs.com/px?id=1268102&t=2";\nimage2 = new Image(1, 1); \nimage2.src="https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50188&ActionName=Store_Site_Visit&cachebuster="+rand;\n});\n  \n//Product Card Clicks\njQuery("div.m-content-placement.x-clearfix:lt(3)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="https://secure.adnxs.com/px?id=1268102&t=2";\nimage2 = new Image(1, 1); \nimage2.src="https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50188&ActionName=Store_Site_Visit&cachebuster="+rand;\n });\n  \n }\ncatch(err)\n{\n\t_satellite.logger.error("Media_/FR-FR/Surface Indirect Commercial Category Page (RT)");\n}\n',language:"javascript"}}]},{id:"RLff024ff211024496b1ca0dd8147087b9",name:"OffDCMCV",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'/* Office DCM CV\n*/\ntry\n{\n\tvar a, imgsrc1, ps;\n\tvar inScope=0;\n\n\tvar mc1 = "";\n\tif (_TMutils.readCookie("MC1")) {\n\t\tmc1 = _TMutils.readCookie("MC1").split("&")[0].split("=")[1]; //use in u58\n\t}\n\n\tfor (var i=0; i<_TMDL.pidsku.length; i++) {\n\t\tps = _TMDL.pidsku[i].toUpperCase();\n\t\tif (ps=="CFQ7TTC0K5DM-007R" || ps=="CFQ7TTC0K5DM-007W"){\n\t\t\t// Home Annual\n\t\t\tinScope=1;\n\t\t} else if (ps=="CFQ7TTC0K5FB-0002" || ps=="CFQ7TTC0K5FC-0002" || ps=="CFQ7TTC0K5FB-000D" || ps=="CFQ7TTC0K5FC-000C") {\n\t\t\t// Home and Student 2016 (for Mac and Windows SKUs)\n\t\t\tinScope=1;\t\t\n\t\t} \n\t}\n\n\tif ((_TMDL.pageType=="receipt" || _TMDL.pageType=="congrats") && _TMDL.isprod && inScope==1) {\n\t\ta = "" + (Math.random() * 10000000000000);\n\t\timgsrc1 = "https://ad.doubleclick.net/ddm/activity/src=6952136;type=store00;cat=zzzst0;qty=1;cost="+_TMDL.totamount+";u1="+_TMDL.geo.toUpperCase()+";u2="+_TMDL.ll\n\t\t\t//+";u5="+encodeURIComponent(document.referrer)\n\t\t\t+";u25="+_TMDL.pids.join("_")\n\t\t\t+";u26="+encodeURIComponent(_TMDL.pnames.join("_"))\n\t\t\t+";u58="+mc1\n\t\t\t+";u31="+_TMDL.cc+";u32="+_TMDL.pids.join("_")+";u33="+_TMDL.pidsku.join("_")+";u34="+_TMDL.purchaseID+";u35="+_TMDL.totqty\n\t\t\t+";u39="+_TMDL.sales.join("_")+";u40="+_TMDL.quantities.join("_")\n\t\t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="+_TMDL.purchaseID+"?";\n\t\t//console.log(imgsrc1);\n\t\tBootstrapper.imageRequest(imgsrc1);\n\t\t\n\t\t// added 6/18/2018\n\t\tBootstrapper.imageRequest("//www.googleadservices.com/pagead/conversion/862646735/?value=1.00&currency_code=USD&label=KXsqCL2B2nEQz-OrmwM&uid=ON&script=0");\n\t}\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== "undefined") {_TMutils.logRuleCall("OffDCMCV",err.message,imgsrc1);}\n\t_satellite.logger.error("OffDCMCV");\t\n}\n\n\n',language:"javascript"}}]},{id:"RL6a1ffa017a6447ce99ac33bf53bffe46",name:"Surface_XANDR LP",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:70}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-us/p/surface-go/8v9dp4lnknsz",valueIsRegex:!0},{value:"/en-us/p/surface-book-2/8mcpzjjcc98c",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'if (~window.location.pathname.toLowerCase().indexOf("surface") && ~window.location.pathname.toLowerCase().indexOf("/p/")) {\n\tif (~window.location.pathname.toLowerCase().indexOf("/en-us/p/surface-go/8v9dp4lnknsz")){\n\t\tBootstrapper.imageRequest("https://secure.adnxs.com/px?id=1182093&seg=19686450&t=2");\t\n\t} else if (~window.location.pathname.toLowerCase().indexOf("/en-us/p/surface-book-2/8mcpzjjcc98c")){\n\t\tBootstrapper.imageRequest("https://secure.adnxs.com/px?id=1182149&seg=19686725&t=2");\t\t\n\t} \t\n}',language:"javascript"}}]},{id:"RLde28aecd30d74703bdf3a1ed721c0109",name:"Media.LL-LL.store.b.student",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-gb/store/b/student"},{value:"/en-gb/store/b/student/"},{value:"/fr-fr/store/b/student"},{value:"/fr-fr/store/b/student/"},{value:"/de-de/store/b/student"},{value:"/de-de/store/b/student/"}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n  {\n    \n //ADNXS\n    \n //Hero\njQuery(".m-hero").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "//secure.adnxs.com/px?id=1268102&t=2";\n    });\n \n//QuickLinks\njQuery(".m-updated-quicklinks li:lt(2)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "//secure.adnxs.com/px?id=1268102&t=2";\n    });\n\n    \n //"Shop Surface" - Only capturing first \'card\' (anchor + img). Remainder of isn\'t identified in spec.   \njQuery("#primaryR5 img:eq(0)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "//secure.adnxs.com/px?id=1268102&t=2";\n    });\n \njQuery("#primaryR5 a:eq(0)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "//secure.adnxs.com/px?id=1268102&t=2";\n    });\n    \n//Surface Bundles\njQuery("#primaryR7 a:gt(1)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "//secure.adnxs.com/px?id=1268102&t=2";\n    });\n    \n\n //DoubleClick\n    \njQuery(".m-hero").on("mousedown", function(){\nBootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=lrn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=Learn More"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?");\n});\n\njQuery(".m-updated-quicklinks li:lt(2)").on("mousedown", function(){\nBootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=Surface for Students Surface Accessories"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?");\n});\n\njQuery("#primaryR5").on("mousedown", function(){ Bootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=Shop Surface"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?");\n});\n\njQuery("#primaryR7 a:gt(1)").on("mousedown", function(){ Bootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=Shop Surface"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?");\n});\n \n    \n  }\ncatch(err)\n  {\n\t_satellite.logger.error("Media.LL-LL.store.b.student");\n  }',language:"javascript"}}]},{id:"RL0e061a54f66647a6bc1cbfe67336e39d",name:"Media_/EN-US/Surface Indirect Commercial Category Page (AEM)",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-us/store/b/surfaceforbusiness",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{var rand = parseInt(1E5 * 1E4 * Math.random() * Math.random());\n// Shop now and Shop Essential Bundle buttons\njQuery("a.cta").slice(1, 20).on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="https://secure.adnxs.com/px?id=1268102&t=2";\nimage2 = new Image(1, 1); \nimage2.src="https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50188&ActionName=Store_Site_Visit&cachebuster="+rand;\n});\n  \n//Product Card Clicks\njQuery("div.card:eq(1),div.card:eq(2),div.card:eq(3),div.card:eq(4),div.card:eq(8)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="https://secure.adnxs.com/px?id=1268102&t=2";\nimage2 = new Image(1, 1); \nimage2.src="https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50188&ActionName=Store_Site_Visit&cachebuster="+rand;\n });\n  \n }\ncatch(err)\n{\n\t_satellite.logger.error("Media_/EN-US/Surface Indirect Commercial Category Page (AEM)");\n}\n',language:"javascript"}}]},{id:"RL1b32ff43abc24c58966a373715796af4",name:"XANDR_SrfcCPE CTA",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"(us|ca|de|au|gb|sg|fr|jp)\\/p\\/surface",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'var debug=1,fireDCM=1;\n\nfunction attachADNXSAnalyticsToElement(elementAddress) {\n\t$(document).on(\'mousedown\', elementAddress, \'\', function() {\n\t\tactionURL = \'https://secure.adnxs.com/px?id=1268102&t=2\';\n\n\t\tif (debug) { \n\t\t\tconsole.log(elementAddress + " " + actionURL); \n\t\t}\n\n\t\tif (fireDCM) {\n\t\t\tBootstrapper.imageRequest(actionURL);\n\t\t}\n\t});\n}\n\ntry\n{\n\t// Configure\n\tif (~window.location.pathname.toLowerCase().indexOf("surface") && ~window.location.pathname.toLowerCase().indexOf("/p/")) {\n\t\t// Configure Now CTA eeeeee\n\t\tattachADNXSAnalyticsToElement(\'button[id*="ConfigureDeviceButton"]\');\n\n    \t// Bundle\n\t\tattachADNXSAnalyticsToElement(\'button[id*="buttons_BuildABundleButton"],a[href*="/store/build/"]\');\n\n\t\t// Shop Now CTA from PDP (Surface_GBL_PchNow_Count_)  eeeeee\n\t\t$(document).on(\'mousedown\',\'div.pi-promotion-bar a\',\'\', function() {\n\t\t\tvar inScope=1;\n\n\t\t\ttry {\n\t\t\t\tif (~this.href.indexOf("/build/") || ~this.href.indexOf("student-discounts?successurl")) {\n\t\t\t\t\t_satellite.logger.log("out of scope");\n\t\t\t\t\tinScope=0;\n\t\t\t\t}\n\t\t\t} catch(shperr) {_satellite.logger.log("shopnow err");}\n\n\t\t\tif (inScope) { \n\t\t\t\tif (debug) { \n\t\t\t\t\tconsole.log(\'div.pi-promotion-bar a\' + " " + \'https://secure.adnxs.com/px?id=1268102&t=2\'); \n\t\t\t\t}\n\n\t\t\t\tBootstrapper.imageRequest("https://secure.adnxs.com/px?id=1268102&t=2");\n\t\t\t} else {\n\t\t\t\tconsole.log(\'not in scope\'); \t\t\n\t\t\t}\n\t\t});\n\n        // Business\t\n\t\tattachADNXSAnalyticsToElement(\'div.store-finance-offer a\');\n\n        // Eligibility\t\t\t\n\t\tattachADNXSAnalyticsToElement(\'a[href*="student-discounts?successurl"]\');\n\t\t\n      \t// Cart\n\t\tattachADNXSAnalyticsToElement(\'button[id*="AddToCartButton"]\');\n\t}\n}\ncatch(clkerr) {\n\tconsole.log("XNDR Surface CPE ERROR");}',language:"javascript"}}]},{id:"RL55e46cd9bd74412b8e2e75232422973c",name:"FBLP",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:40}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}},{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"www.microsoft.com"==window.location.host.toLowerCase()}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{
source:'try\n{\n\tvar marketMap = {\n\t\t"AT": "562684790554330",  \n\t\t"AU": "284489665351238", // iProspect\n\t\t"BE": "1441341485948213", // iProspect  (FR) \n\t\t"BR": "1351385668312384", // iProspect\n\t\t"CA": "822106911286239", // iProspect\n\t\t"CH": "1701617263415580",   \n\t\t"CN": "1675926909345981", \n\t\t"DE": "108292966463738",  // iProspect\n\t\t"DK": "254705608267657",  // iProspect\n\t\t"ES": "1626525834066953",  // iProspect\n\t\t"FI": "1719588481615214", \n\t\t"FR": "824192544408978", // iProspect\n\t\t"GB": "120587825211084", // iProspect\n\t\t"HK": "539267979583843", \n\t\t"IE": "249404655562787", // IProspect (added 9/13/17)\n\t\t"IN": "1974106256199230",  // (EN) iProspect\n\t\t"IR": "172987109739933",  \n\t\t"IT": "1598310580201695",  // iProspect\n\t\t"JP": "288860468248601", // iProspect\n\t\t"KR": "1413279412072377", // iProspect\n\t\t"MX": "113583175941450",  // iProspect\n\t\t"NL": "656219287899900", // iProspect\n\t\t"NO": "1675926909345981",  \n\t\t"NZ": "1925863447693257", // iProspect 9/13/17\n\t\t"PH" : "109126313071654", // iProspect  (NEW)\n\t\t"PT" : "1368140109922230",\n\t\t"RU": "514282922073511",  \n\t\t"SE": "1400129366740315", // iProspect\n\t\t"SG": "1240252356085595", // iProspect\n\t\t"TW": "266771177060777",  // iProspect\n\t\t"US": "141890703034968" // iProspect\n\t};\n\n\tvar llfbmap = {\n\t\t"fr-ca": "165913903949482",  \n\t\t"hi-in": "1419329368162069", \n\t\t"nl-be": "129122374248830", \n\t\t"de-ch": "1674321202841213", // iProspect\n\t\t"never": "1111111111111111"\n\t};\n\t\n\tvar baseurl="",imgurlcart="",imgurlpurchase="",imgurllead="",dbugimgurl="";\n\tvar ts = new Date().valueOf();\n\tvar contentIDs="";\n\tvar i=0;\n\tvar pidstringarr=[];\n\tvar pnamearr=[];\n\tvar feedID="";\n\n\ttry {\n\t\tif(_TMDL && marketMap[(_TMDL.geo).toUpperCase()] ){\n\t\t\tfeedID = marketMap[(_TMDL.geo).toUpperCase()].toLowerCase();\n\t\t}\n\t} catch(err) {}\n\n\ttry {\n\t\tif(_TMDL && llfbmap[(_TMDL.ll).toLowerCase()]){\n\t\t\tfeedID = llfbmap[(_TMDL.ll).toLowerCase()].toLowerCase();\n\t\t}\n\t} catch(llerr) {}\n\n\tif (_TMDL.cc=="Unknown" && _TMDL.geo=="US") {_TMDL.cc="USD";}\n\n\tbaseurl = "https://www.facebook.com/tr?id="; \n\n\tpageviewurl = baseurl+"1770559986549030"+"&ev=PageView"+"&dpo=LDU&dpoco=0&dpost=0"+"&ts="+ts;\n\tiniturl = baseurl+"1770559986549030"+"&ev=PixelInitialized"+"&dpo=LDU&dpoco=0&dpost=0"+"&ts="+ts;\n\tpdpurl = baseurl+"1770559986549030"+"&ev=ViewContent"+"&dpo=LDU&dpoco=0&dpost=0"\n\t\t+"&ts="+ts\n\t\t+"&cd[product_catalog_id]="+feedID\n\t\t+"&cd[content_ids]=["+encodeURIComponent(_TMDL.pidsku.slice(0)) + "]"\n\t\t+"&cd[content_names]=["+encodeURIComponent(_TMDL.pnames.slice(0)) + "]"\n\t\t+"&cd[content_type]=product";\n\n\tif (_TMDL.isprod)\n\t{\n\t\tdbugimgurl = initurl; \n\t\tBootstrapper.imageRequest(initurl);\n\t\tBootstrapper.imageRequest(initurl.replace("1770559986549030"));\t\n\t\tdbugimgurl = pageviewurl;\n\t\tBootstrapper.imageRequest(pageviewurl);\t\n\t\tBootstrapper.imageRequest(pageviewurl.replace("1770559986549030"));\t\n\t\tif (_TMDL.pageType=="detail" || _TMDL.pageType=="pdp") {\n\t\t\tdbugimgurl = pdpurl; \n\t\t\tBootstrapper.imageRequest(pdpurl);\t\n\t\t\tBootstrapper.imageRequest(pdpurl.replace("1770559986549030"));\t\n\t\t} \n\t}\n\n\tfor (i=0; i<_TMDL.pidsku.length;i++){\n\t\tpidstringarr.push(\'"\'+_TMDL.pidsku[i]+\'"\');\n\t\tpnamearr.push(\'"\'+_TMDL.pnames[i]+\'"\');\n\t}\n\n\timgurlcart = baseurl+"1770559986549030"+"&ev=AddToCart"+"&dpo=LDU&dpoco=0&dpost=0"\n\t\t+"&ts="+ts\n\t\t+"&cd[product_catalog_id]="+feedID\n\t\t+"&cd[content_ids]=["+encodeURIComponent(pidstringarr.join(",")) + "]"\n\t\t+"&cd[content_names]=["+encodeURIComponent(pnamearr.join(",")) + "]"\n\t\t+"&cd[content_type]=product";\n\n\timgurlpurchase = baseurl+"1770559986549030"+"&ev=Purchase"+"&dpo=LDU&dpoco=0&dpost=0"\n\t\t+"&ts="+ts\n\t\t+"&cd[currency]="+_TMDL.cc\n\t\t+"&cd[product_catalog_id]="+feedID\n\t\t+"&cd[content_ids]=["+encodeURIComponent(pidstringarr.join(",")) + "]"\n\t\t+"&cd[content_names]=["+encodeURIComponent(pnamearr.join(",")) + "]"\n\t\t+"&cd[content_type]=product";\n\n\t// Digital Games or Xbox Passes\n  \tif (feedID && _TMDL.isprod && (typeof _TMDL.prdType[0] !== \'undefined\') && (typeof _TMDL.pnames[0] !== \'undefined\') && (_TMDL.prdType[0]=="Games" || ( ~_TMDL.prdType[0].indexOf("Pass") && ~_TMDL.pnames[0].indexOf("Xbox")))) {\n\t\t$(document).on(\'mousedown\',\'button[id*="BuyButton"]\',\'\', function() {\n\t\t\tdbugimgurl = imgurlcart;\n\t\t\tBootstrapper.imageRequest(imgurlcart);\n\t\t\tBootstrapper.imageRequest(imgurlcart.replace("1770559986549030"));\t\n\t\t});\n\t\t_TMDL.fbpchurl = imgurlpurchase;\n\t}\n\n\timgurllead = baseurl+"1770559986549030"+"&ev=Lead"+"&dpo=LDU&dpoco=0&dpost=0"\n\t\t+"&ts="+ts\n\t\t+"&cd[product_catalog_id]="+feedID\n\t\t+"&cd[content_ids]=["+encodeURIComponent(pidstringarr.join(",")) + "]"\n\t\t+"&cd[content_names]=["+encodeURIComponent(pnamearr.join(",")) + "]"\n\t\t+"&cd[content_type]=product";\n\t\t\n\tif (feedID && ~window.location.pathname.indexOf("/p/") && typeof _TMDL.prdType[0] !== \'undefined\' && (_TMDL.prdType[0]=="Devices" || _TMDL.prdType[0]=="Passes" || _TMDL.prdType[0]=="Bundles")) {\n\t\t$(document).on(\'mousedown\',\'button[id*="AddToCartButton"],button[id*="buttons_BuildABundleButton"],button[id*="ConfigureDeviceButton"],a[href*="student-discounts?successurl"]\',\'\', function() {\n\t\t\tdbugimgurl = imgurllead;\n\t\t\tBootstrapper.imageRequest(imgurllead);\n\t\t\tBootstrapper.imageRequest(imgurllead.replace("1770559986549030"));\t\n\t\t});\n\t}\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== "undefined") {_TMutils.logRuleCall("FB LP",err.message,dbugimgurl);}\n\t_satellite.logger.error("FB LP");\t\n}\n',language:"javascript"}}]},{id:"RL2444c1412bfa470391b29c2cc1b3311e",name:"Media_/LL-LL/Reddit Surface PV (AEM/RT)",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"(us|au|gb)\\/d\\/surface",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/dateRange.js",settings:{end:"2022-07-01T00:00:00Z",start:"2021-11-03T00:00:00Z"}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n//Reddit Surface Pixel\nvar image = new Image(1, 1);\nimage.src ="https://alb.reddit.com/rp.gif?id=t2_ch5mi&event=PageVisit&integration=noscript";\n\n}\ncatch(err)\n{\n\t_satellite.logger.error("Media_/LL-LL/Reddit Surface PV (AEM/RT)");\n}\n',language:"javascript"}}]},{id:"RL8911370103d74c219b6171527af1b357",name:"Media_/EN-US/Commercial Consultation Tag (AEM/RT)",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-us/store/b/business-consultation",valueIsRegex:!0},{value:"/en-us/store/b/business-consultation/",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}},{modulePath:"core/src/lib/conditions/dateRange.js",settings:{end:"2022-08-01T00:00:00Z",start:"2021-06-21T00:00:00Z"}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try {\n\t// Floodlight pv\n\tvar image = new Image(1, 1);\n\timage.src = "https://ad.doubleclick.net/ddm/activity/src=8406733;type=corpothe;cat=corpo0;u1=" + _TMDL.geo + ";u2=" + _TMDL.ll + ";u6=" + encodeURIComponent(_TMDL.pagename) + ";u25=" + _TMDL.pids[0] + ";u26=" + encodeURIComponent(_TMDL.pnames[0]) + ";u52=Visit;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=1?";\n\n\tvar image2 = new Image(1, 1);\n\timage2.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&he={INSERT_MACRO_HERE}&ea=USAlandingpagevisit";\n\n\t$(\'a[href*="https://digitalreservations.microsoft.com/en-us/appointment/create"]\').on("mousedown", function () {\n\t\tvar data = JSON.parse($(this).attr("data-m"));\n\t\tvar cN = data["cN"];\n\n\t\tvar imageCl = new Image(1, 1);\n\t\timageCl.src = "https://ad.doubleclick.net/ddm/activity/src=8406733;type=corpothe;cat=corpo000;u1=" + _TMDL.geo + ";u2=" + _TMDL.ll + ";u6=" + encodeURIComponent(_TMDL.pagename) + ";u25=" + _TMDL.pids[0] + ";u26=" + encodeURIComponent(_TMDL.pnames[0]) + ";u50="+ cN + ";u52=Click;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=1?";\n\t});\n}\ncatch (err) {\n\t_satellite.logger.error("Media_/EN-US/Commercial Consultation Tag (AEM/RT)");\n}\n',language:"javascript"}}]},{id:"RLb84483393e0944389f21094936208317",name:"Media_/ja-jpr/store/b/sale",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/ja-jp/store/b/sale"},{value:"/ja-jp/store/b/sale/"}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n  \n// ADNXS\n \n //Featured Product Image Links\njQuery(".m-content-placement-item:lt(11)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "//secure.adnxs.com/px?id=1268102&t=2";\n});\n //Product Cards  \njQuery("div.m-channel-placement-item.f-wide.f-full-bleed-image").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "//secure.adnxs.com/px?id=1268102&t=2";\n});\n  \n\n\n//DoubleClick\n \n  //Featured Product Image Links\njQuery(".m-content-placement-item:lt(11)").on("mousedown", function(){\n    Bootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=Shop Now"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?");\n});\n  \n  //Product Cards  \njQuery("div.m-channel-placement-item.f-wide.f-full-bleed-image").on("mousedown", function(){\n    Bootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=Product Options"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?");\n});\n  \n  \n//Yahoo\n \n  //Featured Product Image Links\njQuery(".m-content-placement-item:lt(11)").on("mousedown", function(){\n    Bootstrapper.imageRequest("https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick");\n});\n  \n  //Product Cards  \njQuery("div.m-channel-placement-item.f-wide.f-full-bleed-image").on("mousedown", function(){\n    Bootstrapper.imageRequest("https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick");\n});\n\n}\ncatch(err)\n{\n\t_satellite.logger.error("Media_/ja-jp/store/b/sale");\n}\n  ',language:"javascript"}}]},{id:"RL1281b827de3444418825cfe32745f48a",name:"QuantcastLPandCT",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'/* OFF_QuantCast */\n\n\nvar isTrial=0;\nvar inScope=0;\nvar quanturl;\n\nvar trialskus = {\n\t"cfq7ttc0k5bc-0003" : 1,\n\t"cfq7ttc0k5dm-007n" : 1,\n\t"cfq7ttc0k5dm-007q" : 1,\n\t"cfq7ttc0k5dm-007s" : 1,\n\t"cfq7ttc0k5dm-00hq" : 1,\n\t"cfq7ttc0k5dm-00hr" : 1\n};\n\n// added for Alta\nvar office365bigids = {\n\t"cfq7ttc0k5bf" : 1,\n\t"cfq7ttc0k5dm" : 1,\n\t"cfq7ttc0k5bc" : 1,\n\t"8pc5bjbhn74p" : 1, //new\n\t"94cm694vj57p" : 1, //new\n\t"900rpbx20ts6" : 1, //new\n\t"93r684wj71vj" : 1, //new\n\t"8v9j0t4jfz6w" : 1, //new\n\t"cfq7ttc0k5bd" : 1,\n\t"8nfjc88fkmrz" : 1, //new\n\t"8szwm812t6n1" : 1, //new\n\t"cfq7ttc0k5bg" : 1, //new\n\t"8v883x3j1v40" : 1  //new\n};\n\ntry {\n\tfor (var i = 0; i < _TMDL.pidsku.length; i++) {\n\t  // update check to also look for office365bigids to adapt to Alta\n\t\tif (_TMDL.pnames && (~_TMDL.pnames[i].toLowerCase().indexOf("office") || ~_TMDL.pnames[i].toLowerCase().indexOf("o365") || ~_TMDL.pnames[i].toLowerCase().indexOf("off365") || office365bigids[_TMDL.pids[i].toLowerCase()]==1 )  && trialskus[_TMDL.pidsku[i].toLowerCase()]!==1) {\n\t\t\tinScope=1;\n\t\t}\n\t}\n\n  if (inScope) {\n\t\t  quanturl = "https://pixel.quantserve.com/pixel/p-4T98ck4dZrJdS.gif?labels=_fp.event.OfficeConsumerPurchase,_fp.pcat."+_TMDL.pidsku.join(",_fp.pcat.")+",_fp.customer."+_TMDL.ll+",_fp.channel."+_TMDL.geo+"&orderid="+_TMDL.purchaseID+"";\n\t\t  Bootstrapper.imageRequest(quanturl);\n  }\n} catch(err) {_satellite.logger.log("QuantCast ERR");}\n\n\n\n',language:"javascript"}}]},{id:"RL76a8462d758d4a46b290f35986c7b088",name:"OffAmobeeCV",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'/*\nOffice Amobee Turn CV\n*/\ntry\n{\n\tvar ps;\n\tvar inScope=0;\n\n\tvar u1="https://d.turn.com/r/dd/id/L21rdC84ODQvY2lkLzE3NDc0Nzk4MzYvdC8y/kv/"\n\t\t+"qty="+_TMDL.totqty\n\t\t+",langlocale="+_TMDL.ll\n\t\t+",currency="+_TMDL.cc\n\t\t+",liqty="+_TMDL.quantities.join("_")\n\t\t+",lirev="+_TMDL.sales.join("_")\n\t\t+",orderid="+_TMDL.purchaseID\n\t\t+",product="+encodeURIComponent(_TMDL.pnames.join("_"))\n\t\t+",conversio=ConsPurchase,market="+_TMDL.ll\n\t\t+",typg=congrats,offerid="+_TMDL.pidsku.join("_");\n\tdbugimgurl = u1;\n\tvar u2="https://r.turn.com/r/beacon?b2=BR7c3AESZXq9Insb7vIh5jSMguWT7u7Yff10h-EMyivou6cxrU_k3avmwgRgF-V1ngmFZWpmYYcTkFV2hicvfQ&cid="+_TMDL.cc+"&bprice="+_TMDL.totamount;\n\t\t\n\tfor (var i=0; i<_TMDL.pidsku.length; i++) {\n\t\tps = _TMDL.pidsku[i].toUpperCase();\n\t\tif (ps=="CFQ7TTC0K5DM-007R" || ps=="CFQ7TTC0K5DM-007W"){\n\t\t\t// Home Annual\n\t\t\tinScope=1;\n\t\t} else if (ps=="CFQ7TTC0K5FB-0002" || ps=="CFQ7TTC0K5FC-0002" || ps=="CFQ7TTC0K5FB-000D" || ps=="CFQ7TTC0K5FC-000C") {\n\t\t\t// Home and Student 2016 (for Mac and Windows SKUs)\n\t\t\tinScope=1;\t\t\n\t\t} \n\t}\n\n\tif (~_TMDL.pageType.indexOf("receipt") && _TMDL.isprod) {\n\t\tBootstrapper.imageRequest(u1); \n\t\tif (inScope==1) {dbugimgurl = u2;Bootstrapper.imageRequest(u2);}\n\t}\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== "undefined") {_TMutils.logRuleCall("OffAmoBeeCV",err.message,dbugimgurl);}\n\t_satellite.logger.error("OffAmoBeeCV");\t\n}\n',language:"javascript"}}]},{id:"RL9287f2337be44c2fba49bde96a312917",name:"GOOGRTG",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:70}],conditions:[],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n\tvar totamount = 0,\n\t  totvalstring = "",\n\t  googpagetype = "other",\n\t  prodstring = "",\n\t  img="";\n\tvar pagetypemap = {\n\t  "home": "home",\n\t  "search": "searchresults",\n\t  "detail": "product",\n\t  "category": "category",\n\t  "checkout_shopping_cart": "cart",\n\t  "cart": "cart",\n\t  "list": "category",\n\t  "receipt": "purchase"\n\t};\n\n\ttry {\n\t  if (_TMDL.pageType && pagetypemap[_TMDL.pageType.toLowerCase()]) {\n\t\tgoogpagetype = pagetypemap[_TMDL.pageType.toLowerCase()];\n\t  }\n\t  for (var i = 0; i < _TMDL.pids.length; i++) {\n\t\tif (parseFloat(_TMDL.sales[i]) > 0) {\n\t\t  totamount += parseFloat(_TMDL.sales[i]);\n\t\t}\n\t  }\n\t} catch (e) {}\n\n\tif (_TMDL.pidsku.length) {\n\t  prodstring = "%3Becomm_prodid%3D" + _TMDL.pidsku.join("%2C"); \n\t}\n\n\tif (totamount > 0) {\n\t  totvalstring = "%3Becomm_totalvalue%3D" + totamount;\n\t}\n\n\timg = "//googleads.g.doubleclick.net/pagead/viewthroughconversion/923371515/?guid=ON&script=0&url=" + encodeURIComponent(window.location.hostname + window.location.pathname) + "&data=ecomm_pagetype%3D" + googpagetype + prodstring + totvalstring;\n\n\tvar c=new Image(0,0);\n\tc.src=img;\n}\ncatch(err)\n{\n\t_satellite.logger.error("GOOGRTG");\t\n}\n',language:"javascript"}}]},{id:"RLafca8ec24b594c8e8d900f5fd9373a36",name:"VRZN_LP_Srfc",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"^/en-us/d/surface.*",valueIsRegex:!0},{value:"^/en-ca/d/surface.*",valueIsRegex:!0},{value:"^/de-de/d/surface.*",valueIsRegex:!0},{value:"^/fr-fr/d/surface.*",valueIsRegex:!0},{value:"^/en-gb/d/surface.*",valueIsRegex:!0},{value:"^/en-au/d/surface.*",valueIsRegex:!0},{value:"^/jp-jp/d/surface.*",valueIsRegex:!0},{value:"^/en-ca/d/surface.*",valueIsRegex:!0},{value:"^/fr-ca/d/surface.*",valueIsRegex:!0},{value:"^/en-sg/d/surface.*",valueIsRegex:!0},{value:"^/nl-nl/d/surface.*",valueIsRegex:!0},{value:"^/sv-se/d/surface.*",valueIsRegex:!0},{value:"^/nb-no/d/surface.*",valueIsRegex:!0},{value:"^/da-dk/d/surface.*",valueIsRegex:!0},{value:"^/en-ie/d/surface.*",valueIsRegex:!0},{value:"^/es-es/d/surface.*",valueIsRegex:!0},{value:"^/de-ch/d/surface.*",valueIsRegex:!0},{value:"^/fr-ch/d/surface.*",valueIsRegex:!0},{value:"^/(d|p)/surface.*",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try {\n  var image = new Image(1,1);\n  image.src = "//sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=ViewProduct&product_id=" + _pageBITags.pageContracts.ProductInfo.id + "-" + _pageBITags.pageContracts.ProductInfo.sku;\n}\ncatch(err)\n{\n\t_satellite.logger.error("Verizon_LP");\n}',language:"javascript"}}]},{id:"RL157bd311b6164957a5cb7ea6964a05e9",name:"AMOCV",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"// AMOCV\n\ntry \n{\n\tvar marketMap = {\n\t\"TR\" : \"MEA_TR\",\n\t\"KE\" : \"MEA_KE\",\n\t\"ZA\" : \"MEA_ZA\",\n\t\"IL\" : \"MEA_IL\",\n\t\"AE\" : \"MEA_AE\",\n\t\"EG\" : \"MEA_EG\",\n\t\"SA\" : \"MEA_SA\",\n\t\"PK\" : \"MEA_PK\",\n\t\"NG\" : \"MEA_NG\",\n\t\"QA\" : \"MEA_QA\",\n\t\"KW\" : \"MEA_KW\",\n\t\"LE\" : \"MEA_LE\",\n\t\"ZW\" : \"MEA_ZW\",\n\t// phase 2 and 3\n\n\t'BE' : 'WE_BE',\n\t'CN' : 'APAC_CHINA',\n\t'CZ' : 'CEE_CZ',\n\t'GR' : 'WE_GR',\n\t'HU' : 'CEE_HU',\n\t'LU' : 'WE_LU',\n\t'NL' : 'WE_NL',\n\t'PL' : 'CEE_PL',\n\t'RO' : 'CEE_RO',\n\t'RU' : 'CEE_RU',\n\t'SK' : 'CEE_SK',\n\t'CL' : 'LATAM_CL',\n\t'CR' : 'LATAM_CR',\n\t'DK' : 'WE_DK',\n\t'FI' : 'WE_FI',\n\t'MX' : 'LATAM_MX',\n\t'NO' : 'WE_NO',\n\t'PE' : 'LATAM_PE',\n\t'PR' : 'LATAM_PR',\n\t'SE' : 'WE_SE',\n\t'TT' : 'LATAM_TT',\n\t'AR' : 'LATAM_AR',\n\t'AT' : 'WE_AT',\n\t'BR' : 'LATAM_BR',\n\t'CO' : 'LATAM_CO',\n\t'FR' : 'WE_FR',\n\t'ID' : 'APAC_ID',\n\t'IE' : 'WE_IE',\n\t'IT' : 'WE_IT',\n\t'MY' : 'SEA_MY',\n\t'PH' : 'SEA_PH',\n\t'PT' : 'WE_PT',\n\t'SG' : 'SEA_SG',\n\t'ES' : 'WE_ES',\n\t'CH' : 'WE_CH',\n\t'TH' : 'APAC_TH',\n\t'AU' : 'SEA_AU',\n\t'DE' : 'WE_DE',\n\t'IN' : 'INDIA_IN',\n\t'NZ' : 'SEA_NZ',\n\t'GB' : 'WE_GB',\n\t'CA' : 'NA_CA',\n\t'HK' : 'SEA_HK',\n\t'JP' : 'APAC_JP',\n\t'KR' : 'SEA_KO',\n\t'TW' : 'GCR_TW',\n\t'US' : 'NA_US',\n\n\t// added 2/28/18\n\t'AZ' : 'CEE_CZ',\n\t'BY' : 'CEE_CZ',\n\t'BG' : 'CEE_CZ',\n\t'HR' : 'CEE_CZ',\n\t'KZ' : 'CEE_CZ',\n\t'LV' : 'CEE_CZ',\n\t'SI' : 'CEE_CZ',\n\t'UA' : 'CEE_CZ',\n\t'EE' : 'CEE_CZ',\n\n\t// added 3/27/18\n\t'VN' : 'SEA_VN'\n\n\t};\n\n\tvar prefix=\"\",userid=\"4249\";\n\n\ttry {\n\t\tif(_TMDL && marketMap[(_TMDL.geo).toUpperCase()] ){\n\t\t\tprefix = marketMap[(_TMDL.geo).toUpperCase()].toLowerCase();\n\t\t}\n\t} catch(err) {if (typeof(_TMutils) !== \"undefined\") {_TMutils.logRuleCall(\"AMO CV\",err.message,\"No AMO GEO Match\");}}\n\n\t//var prefix = 'SEA_SG';  // hardcode for now until next wave of markets \n\n\tif ((_TMDL.geo).toUpperCase()==\"CN\") {userid=\"4559\";}\n\n\tvar imgurl=\"\",\n\ttotamount=0,\n\tdebugstring=\"\",\n\tcc=(_TMDL.cc)?_TMDL.cc.toLowerCase() : \"\",\n\tclvamount=0;\n\n\t//var skus2update=[[\"P2W-00004\",10],[\"QR2-00011\",10],[\"RU2-00004\",10],[\"6GQ-00364\",5],[\"QQ2-00031\",5],[\"6GQ-00241\",5],[\"AAA-04580\",5],[\"R4T-00009\",5],[\"R4T-00010\",5]]; // updated 11/17/15\n\tvar skus2update=[[\"P2W-00004\",1]];\n\n\tvar clvlineitem=0;\n\n\tfor (var i=0; i<_TMDL.sales.length;i++) {\n\t\tif (parseFloat(_TMDL.sales[i]) > 0) {\n\t\t\ttotamount += parseFloat(_TMDL.sales[i]);\n\t\t}\n\t\t// check for a match against the SKUs with a multiplier\n\t\tclvlineitem=parseFloat(_TMDL.sales[i]);\n\t\tfor (var j=0; j<skus2update.length; j++) {\t\t\t\n\t\t\tif (_TMDL.skus[i].toLowerCase()==skus2update[j][0].toLowerCase()) {\n\t\t\t\t// sku matches, update price by applying multiplier\n\t\t\t\t// multiplier is second item in the nested array\n\t\t\t\tclvlineitem = parseFloat(skus2update[j][1]*_TMDL.sales[i]);\n\t\t\t} \n\t\t}\n\t\tclvamount+=clvlineitem;\n\t}\n\n\t//---------------------------------------\n\t// added for Office CPA bidding 8/9/17\n\t//---------------------------------------\n\n\tvar ev_officeHomeAnnual=\"\",\n\t\tev_officePersonalAnnual=\"\",\n\t\tev_officeHomeStudent=\"\",\n\t\tev_officeHomeMonthly=\"\",\n\t\tev_officePersonalMonthly=\"\",\n\t\tev_officeOther=\"\";\n\n\tvar ev_officeHomeAnnual_rev=0,\n\t\tev_officePersonalAnnual_rev=0,\n\t\tev_officeHomeStudent_rev=0,\n\t\tev_officeHomeMonthly_rev=0,\n\t\tev_officePersonalMonthly_rev=0,\n\t\tev_officeOther_rev=0;\n\t\n\tvar otherSKUS=[\n\t['CFQ7TTC0K5F8'],\n\t['CFQ7TTC0K5FD'],\n\t['CFQ7TTC0K5FF'],\n\t['CFQ7TTC0K5BB'],\n\t['CFQ7TTC0K5BC'],\n\t['CFQ7TTC0K5BD'],\n\t['8N0LL43Q1H85'],\n\t['CFQ7TTC0K5DZ'],\n\t['CFQ7TTC0K5F2'],\n\t['CFQ7TTC0K5F3'],\n\t['CFQ7TTC0K5BH'],\n\t['CFQ7TTC0K5D6'],\n\t['CFQ7TTC0K5D7'],\n\t['CFQ7TTC0K5CD'],\n\t['CFQ7TTC0K5CF'],\n\t['CFQ7TTC0K5CP'],\n\t['CFQ7TTC0K5CS'],\n\t['CFQ7TTC0K5CT'],\n\t['CFQ7TTC0K5D0'],\n\t['CFQ7TTC0K5DN']\n\t];\n\n\tvar ps=\"\",officeCPAstring=\"\";\n\n\tfor (var i=0; i<_TMDL.pids.length; i++) {\n\t\tif (_TMDL.pidsku.length > i) {\n\t\t\tps = _TMDL.pidsku[i].toUpperCase();\n\t\t\tif (ps==\"CFQ7TTC0K5DM-007R\" || ps==\"CFQ7TTC0K5DM-007W\"){\n\t\t\t\tev_officeHomeAnnual=1;\n\t\t\t\tev_officeHomeAnnual_rev+=parseFloat(_TMDL.sales[i]);\n\t\t\t} else if (ps==\"CFQ7TTC0K5BF-007R\" || ps==\"CFQ7TTC0K5BF-007V\"){\n\t\t\t\tev_officePersonalAnnual=1;\n\t\t\t\tev_officePersonalAnnual_rev+=parseFloat(_TMDL.sales[i]);\n\t\t\t} else if (ps==\"CFQ7TTC0K5FB-0002\" || ps==\"CFQ7TTC0K5FC-0002\" || ps==\"CFQ7TTC0K5FB-000D\" || ps==\"CFQ7TTC0K5FC-000C\") {\n\t\t\t\tev_officeHomeStudent=1;\t\t\n\t\t\t\tev_officeHomeStudent_rev+=parseFloat(_TMDL.sales[i]);\n\t\t\t} else if (ps==\"CFQ7TTC0K5DM-007P\" || ps==\"CFQ7TTC0K5DM-007V\"){\n\t\t\t\tev_officeHomeMonthly=1;\n\t\t\t\tev_officeHomeMonthly_rev+=parseFloat(_TMDL.sales[i]);\n\t\t\t} else if (ps==\"CFQ7TTC0K5BF-007Q\" || ps==\"CFQ7TTC0K5BF-007S\"){\n\t\t\t\tev_officePersonalMonthly=1;\t\t\t\n\t\t\t\tev_officePersonalMonthly_rev+=parseFloat(_TMDL.sales[i]);\n\t\t\t}\n\t\t}\n\t\tfor (var j=0; j<otherSKUS.length; j++) {                                \n\t\t\tif (_TMDL.pids[i].toLowerCase()==otherSKUS[j][0].toLowerCase()) { \n\t\t\t\tev_officeOther = 1;\n\t\t\t\tev_officeOther_rev+=parseFloat(_TMDL.sales[i]);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (ev_officeHomeAnnual) {\n\t\tofficeCPAstring+=\"&ev_officeHomeAnnual=1\";\n\t\tofficeCPAstring+=\"&ev_officeHomeAnnual_rev=\"+ev_officeHomeAnnual_rev;\n\t}\n\tif (ev_officePersonalAnnual) {\n\t\tofficeCPAstring+=\"&ev_officePersonalAnnual=1\";\n\t\tofficeCPAstring+=\"&ev_officePersonalAnnual_rev=\"+ev_officePersonalAnnual_rev;\n\t}\n\tif (ev_officeHomeStudent) {\n\t\tofficeCPAstring+=\"&ev_officeHomeStudent=1\";\n\t\tofficeCPAstring+=\"&ev_officeHomeStudent_rev=\"+ev_officeHomeStudent_rev;\n\t}\n\tif (ev_officeHomeMonthly) {\n\t\tofficeCPAstring+=\"&ev_officeHomeMonthly=1\";\n\t\tofficeCPAstring+=\"&ev_officeHomeMonthly_rev=\"+ev_officeHomeMonthly_rev;\n\t}\n\tif (ev_officePersonalMonthly) {\n\t\tofficeCPAstring+=\"&ev_officePersonalMonthly=1\";\n\t\tofficeCPAstring+=\"&ev_officePersonalMonthly_rev=\"+ev_officePersonalMonthly_rev;\n\t}\n\tif (ev_officeOther) {\n\t\tofficeCPAstring+=\"&ev_officeOther=1\";\n\t\tofficeCPAstring+=\"&ev_officeOther_rev=\"+ev_officeOther_rev;\n\t}\n\n\t//---------------------------\n\t// end office CPA addition\n\t//---------------------------\n\n\tif (_TMDL.pageType==\"receipt\" && _TMDL.isprod) {\n\t\t//imgurl=\"//pixel.everesttech.net/px2/4249?px_evt=t&ev_\"+prefix+\"_order=1&ev_revenue=\"+totamount+\"&ev_\"+prefix+\"_revenue=\"+totamount+\"&ev_currency_code=\"+_TMDL.cc+\"&ev_transid=\"+_TMDL.purchaseID;\n\t\timgurl=\"https://pixel.everesttech.net/px2/\"+userid+\"?px_evt=t\"\n\t\t\t+\"&ev_order=1\"\n\t\t\t+\"&ev_revenue=\"+totamount\n\t\t\t+\"&ev_clv_revenue=\"+clvamount\n\t\t\t+\"&ev_\"+cc+\"_currency_code=1\"\n\t\t\t+\"&ev_\"+prefix+\"_order=1\"\n\t\t\t+\"&ev_\"+prefix+\"_revenue=\"+totamount\n\t\t\t+\"&ev_\"+prefix+\"_clv_revenue=\"+clvamount\n\t\t\t+\"&ev_transid=\"+_TMDL.purchaseID\n\t\t\t+officeCPAstring;\n\t}\n\n\t//SAMPLE:  http://pixel.everesttech.net/px2/4249?px_evt=t&ev_order=1&ev_revenue=2.38&ev_clv_revenue=2.38&ev_mkd_currency_code=1&ev_mea_tr_order=1&ev_mea_tr_revenue=2.38&ev_mea_tr_clv_revenue=2.38&ev_transid=test999999\n\n\tdebugstring=\"\"+totamount+\": \"+_TMDL.totamount+\"   clv: \"+clvamount;\n\n\tif (imgurl && prefix && _TMDL.isprod && _TMDL.pageType==\"receipt\") {\n\t\tBootstrapper.imageRequest(imgurl);\n\t}\n} catch(err)\n{\n\t_satellite.logger.error(\"AMO CV\");\t\n}\n\n\n",language:"javascript"}}]},{id:"RL2e354527c27c461fb61aa31ea1bf6cad",name:"XboxGrCPE_XDLConfig",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:70}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"(us|ca|au|gb)\\/store\\/configure\\/xbox-design-lab\\/900WZDF9XJVG",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'var debug=0,fireDCM=1;\nvar ll=_TMDL.geo.toLowerCase();\n\nif (ll=="us" || ll=="ca" || ll=="gb" || ll=="au") {\n\ttry {\n\t\t$(document).on(\'mousedown\',\'button.f-primary\',\'\', function() {\n\t\t\tif (typeof $(this).data(\'bi-mto\') === \'undefined\') {\n    \t\t\t// data attribute doesn\'t exist\n    \t\t\treturn;\n\t\t\t}\n\n\n\t\t\tif (debug) { \n\t\t\t\tconsole.log("Add to cart"); \n\t\t\t}\n\n\t\t\tvar j={},pid="",cN="",u="",hr="";\n\t\t\tvar\ta = "" + (Math.random() * 10000000000000);\n\n\t\t\ttry {\n\t\t\t\tj=JSON.parse($(this).attr("data-m"));\n\t\t\t\tpid = j.pid;\n\t\t\t\tcN= j.cN;\n\t\t\t\t//hr=this.href;\n\t\t\t} catch(proderr) {\n\t\t\t\tif (debug) { \n\t\t\t\t\tconsole.log("catch Add to cart "+hr); \n\t\t\t\t}\n\t\t\t}\n\n\t\t\tu="https://ad.doubleclick.net/ddm/activity/src=8391491;type=xbxp;cat=pchn_std;u1="\n\t\t\t+_TMDL.geo\n\t\t\t+";u2="+_TMDL.ll\n\t\t\t+";u6="+encodeURIComponent(window.location.pathname)\n\t\t\t+";u25="+pid\n\t\t\t+";u26="+encodeURIComponent(cN)\n\t\t\t+";u50="+encodeURIComponent(cN)\n\t\t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="\t+ a + "?";\n\n\t\t\tif (debug) { \n\t\t\t\tconsole.log("Add to cart: u25="+pid+" u26="+cN+"\\t"+u); \n\t\t\t}\n\n\t\t\tif (fireDCM) {\n\t\t\t\tBootstrapper.imageRequest(u);\n\t\t\t}\n\t\t});\n\t} catch(clkerr) {\n\t\tconsole.log("Xbox Design Lab");\n\t}\n}',language:"javascript"}}]},{id:"RLa05d6900d727495f891e610e6e502aa6",name:"Media_/LL-LL/Reddit Xbox PV (AEM/RT)",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"(us|gb|au)/store/configure/xbox-design-lab",valueIsRegex:!0},{value:"(us|gb|au)/d/.*xbox",valueIsRegex:!0},{value:"(us|gb|au)/d/bang-olufsen-beoplay-portal-headset",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/dateRange.js",settings:{end:"2022-07-01T00:00:00Z",start:"2021-11-03T00:00:00Z"}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n//Reddit Xbox Pixel PL\nvar image = new Image(1, 1);\nimage.src ="https://alb.reddit.com/rp.gif?id=t2_7knbgndc&event=PageVisit&integration=noscript";\n\n}\ncatch(err)\n{\n\t_satellite.logger.error("Media_/LL-LL/Reddit Xbox PV (AEM/RT)");\n}\n',language:"javascript"}}]},{id:"RL7ec829bc27b74a98b6340a1eee3869b0",name:"Media_/DE-DE/Surface International",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/pathAndQuerystring.js",settings:{paths:[{value:"/de-de/d/surface-laptop-4/946627fb12t1?ocid=paidmedia_sponsored_SLG4_PaidMediade_de_MayFY21&activetab=pivot:overviewtab"},{value:"/de-de/p/surface-laptop-4/946627fb12t1?activetab=pivot:techspecstab"}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}},{modulePath:"core/src/lib/conditions/dateRange.js",settings:{end:"2021-08-01T00:00:00Z",start:"2021-06-16T00:00:00Z"}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n  {\n   //Twitter pv\n   var image = new Image(1, 1);\n   image.src ="https://analytics.twitter.com/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o5fpi&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";  \n \n   var image = new Image(1, 1);\n   image.src ="//t.co/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o5fpi&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0"; \n \n   //Pinterest pv\n   var image = new Image(1, 1);\n   image.src ="https://ct.pinterest.com/v3/?event=init&tid=2613156653032&pd[em]=<hashed_email_address>&noscript=1"; \n\n    \n   //Facebook clk \n  jQuery("button[id*=\'ConfigureDeviceButton\']").on("mousedown", function(){  \n  var image = new Image(1, 1);\n  image.src ="https://www.facebook.com/tr?id=1770559986549030&ev=Lead&dpo=LDU&dpoco=0&dpost=0&ts=1619098009484&cd[product_catalog_id]=108292966463738&cd[content_ids]=[\'946627FB12T1-WZZJ\']&cd[content_names]=[\'Surface Laptop 4\']&cd[content_type]=[\'product\']";\n  \n  \n  });\n  \n  }\n  catch(err)\n  {\n      _satellite.logger.error("Media_/DE-DE/Surface International");\n  }\n',language:"javascript"}}]},{id:"RL6960d527cf5e4f06b954e4283c73cc62",name:"MediaIQAppnexusFY20_CV",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:70}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'/*\nMedia IQ Appnexus FY20 Conversion Pixel  \nMediaIQAppnexusFY20_CV\n\nMSFT - Office Direct - Consumer - TY Page\n\n*/\n\ntry {\n\tvar imgurl = "https://secure.adnxs.com/px?id=1095391&seg=17503076&redir=https%3A%2F%2Fpixel.mediaiqdigital.com%2Fpixel"\n\t\t+"%3Fu1%3D"+_TMDL.purchaseID\n\t\t+"%26u2%3D"+_TMDL.ll.split("-")[1]\n\t\t+"%26u3%3D"\n\t\t+"%26u4%3D"\n\t\t+"%26u5%3D"+_TMDL.pidsku.join("_")\n\t\t+"%26u6%3D"+_TMDL.totamount\n\t\t+"%26u7%3D"+_TMDL.totqty\n\t\t+"%26u8%3D"+_TMDL.quantities.join("_")\n\t\t+"%26u9%3D"+_TMDL.sales.join("_")\n\t\t+"%26u10%3D"+_TMDL.cc\n\t\t+"%26pixel_id%3D1095391%26uid%3D%24%7BUID%7D&t=2";\n\n\t/*\n\t\t//old:\n\tvar imgurl = "https://secure.adnxs.com/px?id=929469&seg=10765629&redir=https%3A%2F%2Fsecure.adnxs.com%2Fgetuid%3Fhttps%3A%2F%2Fpixel.mediaiqdigital.com%2Fpixel%3Fu1%3DConsPurchase%26u2%3D"\n\t+_TMDL.ll\n\t+"%26u3%3D"+_TMDL.ll.split("-")[1]\n\t+"%26u6%3D"+"thankyoupage"\n\t+"%26u20%3D"+_TMDL.pidsku.join("_")\n\t+"%26u26%3D"+encodeURIComponent(_TMDL.pnames.join("_"))\n\t+"%26u31%3D"+_TMDL.cc\n\t+"%26u34%3D"+_TMDL.purchaseID\n\t+"%26u35%3D"+_TMDL.totqty\n\t+"%26u39%3D"+_TMDL.sales.join("_")\n\t+"%26u40%3D"+_TMDL.quantities.join("_")\n\t+"%26pixel_id%3D929469%26uid%3D%24UID&t=2";\n\t*/\n\n\tif (imgurl && _TMDL.isprod && _TMDL.pageType=="receipt") {\n\t\tBootstrapper.imageRequest(imgurl);\n\t}\n} catch(e) {console.log("MediaIQAppnexusFY20_CV err");}',language:"javascript"}}]},{id:"RLf78ee9c5c2c44d33972fc7ed9cab2aab",name:"GOOGCV",events:[{
modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'/* GOOGCV  */\nvar gclidstring = (_satellite.cookie.get("_tm_gclid"))? "&gclaw=" + _satellite.cookie.get("_tm_gclid") : "";\nvar googcvurl = "https://www.googleadservices.com/pagead/conversion/923371515/?value="+_TMDL.totamount\n\t+"&currency_code="+_TMDL.cc.toUpperCase()\n\t+gclidstring\n\t+"&label=yOJJCOecrGYQ-4-muAM&guid=ON&script=0";\n\n\t\nif (_TMDL.isprod) {\n\tBootstrapper.imageRequest(googcvurl);\n}\n\n',language:"javascript"}}]},{id:"RLff8b1c846ac24f94ae93df1af6fc2580",name:"Media_/EN-US/Consumer Consultation Tag (AEM/RT)",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"\\/en-us/store/b/online-computer-shopping-appointments",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}},{modulePath:"core/src/lib/conditions/dateRange.js",settings:{end:"2022-08-01T00:00:00Z",start:"2021-07-15T00:00:00Z"}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'// JavaScript source code\ntry {\n    //Floodlight pv\n    var image = new Image(1, 1);\n    image.src = "https://ad.doubleclick.net/ddm/activity/src=8406733;type=corpothe;cat=corpo0;u1=" + _TMDL.geo + ";u2=" + _TMDL.ll + ";u6=" + encodeURIComponent(_TMDL.pagename) + ";u25=" + _TMDL.pids[0] + ";u26=" + encodeURIComponent(_TMDL.pnames[0]) + ";u52=Visit;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=1?";\n\n    //Xandr pv\n    var image = new Image(1, 1);\n    image.src = "https://secure.adnxs.com/px?id=1472085&t=2";\n\n    // Yahoo pv\n    var image = new Image(1, 1);\n    image.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&js=no";\n\n    // training - training\n    $(\'a[href*="https://answerdesk.microsoft.com/appointment/create"]\').on("mousedown", function () {\n        //file the calls\n        var data = JSON.parse($(this).attr("data-m"));\n        var cN = data["cN"];\n\n        var image = new Image(1, 1);\n        image.src = "https://ad.doubleclick.net/ddm/activity/src=8406733;type=corpothe;cat=corpo000;u1=" + _TMDL.geo + ";u2=" + _TMDL.ll + ";u6=" + encodeURIComponent(_TMDL.pagename) + ";u25=" + _TMDL.pids[0] + ";u26=" + encodeURIComponent(_TMDL.pnames[0]) + ";u50=" + cN +";u52=Click;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=1?";\n\n        //Xandr clk\n        image2 = new Image(1, 1);\n        image2.src = "https://secure.adnxs.com/px?id=1478377&t=2";\n\n        //Yahoo clk\n        image3 = new Image(1, 1);\n        image3.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=surfaceshoppingclick";\n    });\n\n    // training - training\n    $(\'a[href*="https://digitalreservations.microsoft.com/en-us/appointment/create"]\').on("mousedown", function () {\n        var data = JSON.parse($(this).attr("data-m"));\n        var cN = data["cN"];\n\n        var image = new Image(1, 1);\n        image.src = "https://ad.doubleclick.net/ddm/activity/src=8406733;type=corpothe;cat=corpo000;u1=" + _TMDL.geo + ";u2=" + _TMDL.ll + ";u6=" + encodeURIComponent(_TMDL.pagename) + ";u25=" + _TMDL.pids[0] + ";u26=" + encodeURIComponent(_TMDL.pnames[0]) + ";u50=" + cN + ";u52=Click;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=1?";\n\n        //Xandr clk\n        image2 = new Image(1, 1);\n        image2.src = "https://secure.adnxs.com/px?id=1478377&t=2";\n\n        //Yahoo clk\n        image3 = new Image(1, 1);\n        image3.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=surfaceshoppingclick";\n    });\n\n}\ncatch (err) {\n    _satellite.logger.error("Media_/EN-US/Consumer Consultation Tag");\n}',language:"javascript"}}]},{id:"RL728de4ff5abc4533a25bb0691483ad02",name:"BINGLPCVF",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:70}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"www.microsoft.com"==window.location.host.toLowerCase()||"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'// BINGUET\ntry\n{\n\t(function (w, d, t, r, u) {\n\t\tvar f,\n\t\tn,\n\t\ti;\n\t\tw[u] = w[u] || [],\n\t\tf = function () {\n\t\t\tvar o = {\n\t\t\t\tti: "4000034", navTimingApi:true  // set navTimingApi flag\n\t\t\t};\n\t\t\to.q = w[u],\n\t\t\tw[u] = new UET(o),\n\t\t\tw[u].push("pageLoad")\n\t\t},\n\t\tn = d.createElement(t),\n\t\tn.src = r,\n\t\tn.async = 1,\n\t\tn.onload = n.onreadystatechange = function () {\n\t\t\tvar s = this.readyState;\n\t\t\ts && s !== "loaded" && s !== "complete" || (f(), n.onload = n.onreadystatechange = null)\n\t\t},\n\t\ti = d.getElementsByTagName(t)[0],\n\t\ti.parentNode.insertBefore(n, i)\n\t})(window, document, "script", "//bat.bing.com/bat.js", "uetq");\n\n\tvar totamount = 0,\n\t  totvalstring = "",\n\t  googpagetype = "other",\n\t  prodstring = "",\n\t  img="";\n\tvar pagetypemap = {\n\t  // old : [new, eventname]\n\t  "home": ["general_visitor","page_view"],\n\t  "search": ["search_results","view_search_results"],\n\t  "detail": ["general_visitor","view_item"],\n\t  "category": ["general_visitor","view_item_list"],\n\t  "checkout_shopping_cart": ["cart","add_to_cart"],\n\t  "cart": ["cart","add_to_cart"],\n\t  "receipt": ["purchase","Purchase"]\n\t};\n\n\tvar lineitemObj={};\n\tvar itemsArray=[];\n\n\tvar tempobj = {};\n\tvar eventname="page_view";\n\n\tif (_TMDL.pageType && pagetypemap[_TMDL.pageType.toLowerCase()]) {\n\t\tgoogpagetype = pagetypemap[_TMDL.pageType.toLowerCase()][0];\n\t\teventname = pagetypemap[_TMDL.pageType.toLowerCase()][1];\n\t}\n\tfor (var i = 0; i < _TMDL.pids.length; i++) {\n\t  //TODO add name\n\t\titemsArray.push({\'id\' : _TMDL.pidsku[i], \'category\': (typeof _TMDL.dcmcat ==\'object\')?_TMDL.dcmcat[i]:\'\', \'price\' : _TMDL.sales[i], \'name\' : _TMDL.pnames[i]});\n\t\tif (parseFloat(_TMDL.sales[i]) > 0) {\n\t\t\ttotamount += parseFloat(_TMDL.sales[i]);\n\t\t}\n\t}\n    \n\tif (~window.location.pathname.indexOf("/b/")) {\n\t\tgoogpagetype="category";\n\t} else if (~window.location.pathname.indexOf("/p/")) {\n\t\tgoogpagetype="product";\n\t}\n    \n\twindow.uetq = window.uetq || [];\n\n\tif (_TMDL.pidsku.length > 0) {\n\t\ttempobj.ecomm_prodid = (_TMDL.pidsku.length>0) ? _TMDL.pidsku : "";\n\t\ttempobj.ecomm_pagetype = googpagetype;\n\t\t//tempobj.ecomm_items = itemsArray;\n\t\ttempobj.items = itemsArray;\n\t}\n\n\tif (~_TMDL.pageType.indexOf("cart") || ~_TMDL.pageType.indexOf("receipt")) {\n\t\ttempobj.currency = _TMDL.cc;\n\t\ttempobj.revenue_value = totamount;\n\t\ttempobj.transaction_id = _TMDL.purchaseID;\n\t}\n\n\twindow.uetq.push(\'event\',eventname, tempobj); \n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== "undefined") {_TMutils.logRuleCall("BINGLPCVF",err.message,imgsrc1);}\n\t_satellite.logger.error("BINGLPCVF");\t\n}\n\n',language:"javascript"}}]},{id:"RLd8f2cc1b3c7942cd8016c9c927841162",name:"LINKEDIN",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'/*\nLinkedIn tag\n*/\ntry\n{\n\tvar c=new Image(0,0);\n\tc.src="https://dc.ads.linkedin.com/collect/?pid=7850&fmt=gif";\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== "undefined") {_TMutils.logRuleCall("LINKEDIN",err.message,c.src);}\n\t_satellite.logger.error("LINKEDIN");\t\n}\n',language:"javascript"}}]},{id:"RLa67f4dc061f942af82f4b73a8ddb9b42",name:"VRZNCVF",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'/*\nVerizonCVF\n*/\n\ntry {\n\tvar i=0,inScope=0,imageURL="",g=_TMDL.geo.toLowerCase();\n\tif (g=="us" || g=="de" || g=="fr" || g=="gb" || g=="au" || g=="jp" || g=="ca") {\n\t\tfor (i=0; i<_TMDL.pidsku.length; i++) {\n\t\t\tif (~_TMDL.pnames[i].toLowerCase().indexOf("surface") || ~_TMDL.pnames[i].toLowerCase().indexOf("xbox")) {\n\t\t\t\tinScope=1;\n\t\t\t} \n\t\t}\n\t}\n\tif (g=="sg" || g=="nl" || g=="se" || g=="no" || g=="dk" || g=="ie" || g=="es" || g=="ch") {\n\t\tfor (i=0; i<_TMDL.pidsku.length; i++) {\n\t\t\tif (~_TMDL.pnames[i].toLowerCase().indexOf("surface")) {\n\t\t\t\tinScope=1;\n\t\t\t} \n\t\t}\n\t}\n\n\tif (inScope) {\n\t\tif (_TMDL.pT=="cart") {\n\t\t\timageURL = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=AddToCart&langgeo="+_TMDL.ll+"&product_id="+_TMDL.pidsku.join(",");  \n\t\t} else if (_TMDL.pT=="rP") {\n\t\t\timageURL = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=Purchase&langgeo="+_TMDL.ll+"&product_id="+_TMDL.pidsku.join(",")+"&gv="+_TMDL.totamount;\n\t\t} \n\t\tBootstrapper.imageRequest(imageURL);\n\t}\n} catch(e) {\n  _satellite.logger.error("VerizonCVF");\n}',language:"javascript"}}]},{id:"RLaf7f0d279db04d648d392ca7ea5a4091",name:"Media_/EN-AU/Surface Indirect Commercial Category Page (RT)",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-au/store/b/surfaceforbusiness",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{var rand = parseInt(1E5 * 1E4 * Math.random() * Math.random());\n// Shop now and Shop Essential Bundle buttons\njQuery("a.c-call-to-action:lt(14)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="https://secure.adnxs.com/px?id=1268102&t=2";\nimage2 = new Image(1, 1); \nimage2.src="https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50188&ActionName=Store_Site_Visit&cachebuster="+rand;\n});\n  \n//Product Card Clicks\njQuery("div.m-content-placement.x-clearfix:lt(3)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="https://secure.adnxs.com/px?id=1268102&t=2";\nimage2 = new Image(1, 1); \nimage2.src="https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50188&ActionName=Store_Site_Visit&cachebuster="+rand;\n });\n  \n }\ncatch(err)\n{\n\t_satellite.logger.error("Media_/EN-AU/Surface Indirect Commercial Category Page (RT)");\n}\n',language:"javascript"}}]},{id:"RL4d95565cb7de40e784c80ee275c7b124",name:"TikTok_LP",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"www.microsoft.com"==window.location.host.toLowerCase()}}},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/(en-us|en-gb|fr-fr|de-de)",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n!function (w, d, t) {\n  w.TiktokAnalyticsObject=t;var ttq=w[t]=w[t]||[];ttq.methods=["page","track","identify","instances","debug","on","off","once","ready","alias","group","enableCookie","disableCookie"],ttq.setAndDefer=function(t,e){t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}};for(var i=0;i<ttq.methods.length;i++)ttq.setAndDefer(ttq,ttq.methods[i]);ttq.instance=function(t){for(var e=ttq._i[t]||[],n=0;n<ttq.methods.length;n++)ttq.setAndDefer(e,ttq.methods[n]);return e},ttq.load=function(e,n){var i="https://analytics.tiktok.com/i18n/pixel/events.js";ttq._i=ttq._i||{},ttq._i[e]=[],ttq._i[e]._u=i,ttq._t=ttq._t||{},ttq._t[e]=+new Date,ttq._o=ttq._o||{},ttq._o[e]=n||{};var o=document.createElement("script");o.type="text/javascript",o.async=!0,o.src=i+"?sdkid="+e+"&lib="+t;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(o,a)};\n\n//part2\n  ttq.load(\'C5S71GC247CAE4T3VM1G\');\n  ttq.page();\n}(window, document, \'ttq\');\n\n}\ncatch(err)\n{\n\t_satellite.logger.error("TikTok LP");\n}',language:"javascript"}}]},{id:"RL7f1d72806afe48ec8f325f24b75b3e26",name:"XANDR_SrfcCPE /d/ CTA",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"(us|ca|de|au|gb|sg|fr|jp)\\/d\\/surface",valueIsRegex:!0},{value:"de-at/d/surface-pro-8-for-business",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'var debug=1,fireDCM=1;\n\nfunction attachADNXSAnalyticsToElement(elementAddress) {\n\t$(document).on(\'mousedown\', elementAddress, \'\', function() {\n\t\tactionURL = \'https://secure.adnxs.com/px?id=1268102&t=2\';\n\n\t\tif (debug) { \n\t\t\tconsole.log(elementAddress + " " + actionURL); \n\t\t}\n\n\t\tif (fireDCM) {\n\t\t\tBootstrapper.imageRequest(actionURL);\n\t\t}\n\t});\n}\n\ntry\n{\n\t// Configure\n\tif (~window.location.pathname.toLowerCase().indexOf("surface") && ~window.location.pathname.toLowerCase().indexOf("/d/")) {\n\t\t// Configure Now CTA eeeeee\n\t\tattachADNXSAnalyticsToElement(\'button[id*="ConfigureDeviceButton"]\');\n\n    \t// Bundle\n\t\tattachADNXSAnalyticsToElement(\'button[id*="buttons_BuildABundleButton"],a[href*="/store/build/"]\');\n\n\t\t// Shop Now CTA from PDP (Surface_GBL_PchNow_Count_)  eeeeee\n\t\t$(document).on(\'mousedown\',\'div.pi-promotion-bar a\',\'\', function() {\n\t\t\tvar inScope=1;\n\n\t\t\ttry {\n\t\t\t\tif (~this.href.indexOf("/build/") || ~this.href.indexOf("student-discounts?successurl")) {\n\t\t\t\t\t_satellite.logger.log("out of scope");\n\t\t\t\t\tinScope=0;\n\t\t\t\t}\n\t\t\t} catch(shperr) {_satellite.logger.log("shopnow err");}\n\n\t\t\tif (inScope) { \n\t\t\t\tif (debug) { \n\t\t\t\t\tconsole.log(\'div.pi-promotion-bar a\' + " " + \'https://secure.adnxs.com/px?id=1268102&t=2\'); \n\t\t\t\t}\n\n\t\t\t\tBootstrapper.imageRequest("https://secure.adnxs.com/px?id=1268102&t=2");\n\t\t\t} else {\n\t\t\t\tconsole.log(\'not in scope\'); \t\t\n\t\t\t}\n\t\t});\n\n        // Business\t\n\t\tattachADNXSAnalyticsToElement(\'div.store-finance-offer a\');\n\n        // Eligibility\t\t\t\n\t\tattachADNXSAnalyticsToElement(\'a[href*="student-discounts?successurl"]\');\n\t\t\n      \t// Cart\n\t\tattachADNXSAnalyticsToElement(\'button[id*="AddToCartButton"]\');\n\t}\n}\ncatch(clkerr) {\n\tconsole.log("XNDR Surface CPE /d/ ERROR");}',language:"javascript"}}]},{id:"RL683ad07cec0f4be5a6c44515d9d77917",name:"Media_/LL-LL/Surface- Configurations (AEM/RT)",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/p/surface-pro-x/",valueIsRegex:!0},{value:"/p/surface-laptop-go/",valueIsRegex:!0},{value:"/d/surface-pro-x/",valueIsRegex:!0},{value:"/d/surface-laptop-go/",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n//See all configurations button\n jQuery("[href*=\'/configure/Surface-Pro-X/8qg3bmrhnwhk\']").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25=" + _TMDL.pids[0] + ";u26=" + encodeURIComponent(_TMDL.pnames[0]) + ";u32=" + _TMDL.skus[0] + ";u50=View all configurations"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=1?";\n});\n  \njQuery("[href*=\'/configure/surface-laptop-go/94FC0BDGQ7WV\']").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25=" + _TMDL.pids[0] + ";u26=" + encodeURIComponent(_TMDL.pnames[0]) + ";u32=" + _TMDL.skus[0] + ";u50=View all configurations"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=1?";\n});  \n  \n//The Surface Book 3 Page is no longer required to be tagged as this element is duplicated in an already existing rule (SurfaceGrowthCPE)\n// jQuery("[href*=\'/configure/Surface-Book-3/8XBW9G3Z71F1\']").on("mousedown", function(){\n//var image = new Image(1, 1);\n//image.src ="https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25=" + _TMDL.pids[0] + ";u26=" + encodeURIComponent(_TMDL.pnames[0]) + ";u32=" + _TMDL.skus[0] + ";u50=View all configurations"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=1?";\n//});   \n    \n  \n }\ncatch(err)\n{\n\t_satellite.logger.error("Media_/LL-LL/Surface- Configurations");\n}\n',language:"javascript"}}]},{id:"RL6216f8312ce14cfeb3cf6fb09225775a",name:"Media_/en-au/store/collections Tax Day",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-au/store/collections/surfaceforbusiness",valueIsRegex:!0},{value:"/en-au/store/collections/accessoriesforbusiness",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'\ntry\n{\n\njQuery("div[id*=\'productPlacementList\']").on("mousedown", function(){  \nvar image = new Image(1, 1);\nimage.src ="https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u50=CTA;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;ord=1?";\n\n});\n\n}\ncatch(err)\n{\n\t_satellite.logger.error("Media_/en-au/store/collections Tax Day");\n}\n\n',language:"javascript"}}]},{id:"RL5edc7c294e774dfba549b529ad58df5b",name:"AU-GB/Business-Consultation",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-AU/store/b/business-consultation",valueIsRegex:!0},{value:"/en-gb/store/b/business-consultation",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/dateRange.js",settings:{end:"2022-08-01T00:00:00Z",start:"2022-02-04T00:00:00Z"}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try {\n    // landing page\n    var locale = _TMDL.geo;\n    var floodlightLand = "https://ad.doubleclick.net/ddm/activity/src=8406733;type=corpothe;cat=corpo0;u1=" + locale + ";u2=" + _TMDL.ll + ";u6=" + encodeURIComponent(_TMDL.pagename) + ";u25=" + _TMDL.pids[0] + ";u26=" + encodeURIComponent(_TMDL.pnames[0]) + ";u52=Click;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=1?";\n    var fb = "https://www.facebook.com/tr?id=1770559986549030&ev=PageView&noscript=1";\n    var linked = "https://px.ads.linkedin.com/collect/?pid=7850&fmt=gif";\n\n    Bootstrapper.imageRequest(floodlightLand);\n    Bootstrapper.imageRequest(fb);\n\n    if (locale == "au") {\n        Bootstrapper.imageRequest("https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&he={INSERT_MACRO_HERE}&ea=AUlandingpagevist");\n    } else {\n        Bootstrapper.imageRequest("https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&he={INSERT_MACRO_HERE}&ea=UKlandingpagevisit");\n    }\n\n    // "Book a consultation" clicks\n    $(\'a[href*="https://digitalreservations.microsoft.com/en-gb/appointment/create"]\').on("mousedown", function () {\n        var data = JSON.parse($(this).attr("data-m"));\n        var cN = data["cN"];\n\n        Bootstrapper.imageRequest(fb);\n        Bootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8406733;type=corpothe;cat=corpo000;u1=" + locale + ";u2=" + _TMDL.ll + ";u6=" + encodeURIComponent(_TMDL.pagename) + ";u25=" + _TMDL.pids[0] + ";u26=" + encodeURIComponent(_TMDL.pnames[0]) + ";u50=" + cN + "u52=Click;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=1?");\n    });\n\n    $(\'a[href*="https://digitalreservations.microsoft.com/en-au/appointment/create"]\').on("mousedown", function () {\n        var data = JSON.parse($(this).attr("data-m"));\n        var cN = data["cN"];\n\n        Bootstrapper.imageRequest(fb);\n        Bootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8406733;type=corpothe;cat=corpo000;u1=" + locale + ";u2=" + _TMDL.ll + ";u6=" + encodeURIComponent(_TMDL.pagename) + ";u25=" + _TMDL.pids[0] + ";u26=" + encodeURIComponent(_TMDL.pnames[0]) + ";u50=" + cN + "u52=Click;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=1?");\n    });\n}\ncatch (err) {\n    console.log("AU-GB/Business-Consultation");\n}\n\n',language:"javascript"}}]},{id:"RL5eab5a9198f842fa8eb98ab1205d77aa",name:"AMOXbox",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:70}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'/* \n  RULE NAME:  AMOXBOXPLATCV \n  add after DCM so categories are set\n  \t\t\txboxplatform (only this for now)\n\t\t\txboxgames \n\t\t\txboxdesignlabs \n\t\t\txboxgamepass \n\t\t\txboxlive \n\t\t\txboxdigitalgames \n*/\n\n\n(function(debug) {\n\tvar tot=0;\n\tvar units=0;\n\tvar inscope=0;\n\tvar imgurl="";\n\tif (_TMDL.pids) {\n\t\tfor (var i = 0; i < _TMDL.pids.length; i++) {\n\t\t\tif (_TMDL.dcmcat[i].indexOf("xboxplatform")>-1) {\n\t\t\t\tunits += _TMDL.quantities[i];\n\t\t\t\ttot += _TMDL.sales[i];\t\n\t\t\t\tinscope=1;\n\t\t\t}\n\t\t}\n\t}\n\t\n\tif (inscope && _TMDL.pageType=="receipt") {\n\t\t// fire AMO pixel\n\t\timgurl = "https://pixel.everesttech.net/px2/5584?px_evt=t&ev_store_xbox_purchase=1&ev_"+_TMDL.cc+"_store_xbox_purchase_value="+tot+"&ev_transid="+_TMDL.purchaseID;\n\t\tBootstrapper.imageRequest(imgurl);\n\t}\n})();\n\n',language:"javascript"}}]},{id:"RL804049235a48433cb1e82263436fba08",name:"ADOBEDCORTG",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:70}],conditions:[],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'/*  Adobe DCO Retargeting tag\n*/\n\ntry {\n\t// landing pages\n\tvar rand = parseInt(1E5 * 1E4 * Math.random() * Math.random());\n\tvar u="";\n\tvar lang = (_TMDL.ll.indexOf("-")>-1) ? _TMDL.ll.split("-")[0].toLowerCase() : "";\n\tvar utstring = "&ut1="+_TMDL.pidsku.join("%2C")+"&ut2="+lang+"&ut3="+_TMDL.geo.toLowerCase()+"&cachebuster="+rand;\n\n\tif (_TMDL.pT.indexOf("cart")<0 && _TMDL.pageType!==\'rP\' ) {\n\t\t// landing pages\n\t\tu="https://ats.everesttech.net/ats/ats?cmd=RT&AdvertiserID=4249&platform=TUMRI&ActionID=20114&ActionName=Microsoft_Store_RT_Pixel"+utstring;\n\t\tBootstrapper.imageRequest(u); \n\t}\n\n\tif (~_TMDL.pT.indexOf("rP") && _TMDL.isprod) {\n\t\tu="https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50081&ActionName=Microsoft_Store_Conv_Pixel&Revenue="+_TMDL.totamount+"&TransactionID="+_TMDL.purchaseID+"&Currency="+_TMDL.cc+utstring;\n\t\tBootstrapper.imageRequest(u); \n\t} else if (~_TMDL.pageType.toLowerCase().indexOf("cart") && _TMDL.isprod) {\n\t\tu="https://ats.everesttech.net/ats/ats?cmd=RT&AdvertiserID=4249&platform=TUMRI&ActionID=20132&ActionName=Microsoft_Store_Cart_Abandoner"+utstring;\n\t\tBootstrapper.imageRequest(u); \n\t}\n} catch(err){\n\tif (_satellite) {\n\t  _satellite.logger.error("Adobe DCO Retargeting Error");\n\t  if (_TMutils){_TMutils.logRuleCall("Adobe DCO Retargeting",err.message,u);}\n\t} \n}\n',language:"javascript"}}]},{id:"RL0bcfb7ed292f400495880750aaae4dbc",name:"ENSSHIM",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:-90}],conditions:[],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{global:!0,
source:'if (typeof Bootstrapper !== \'object\') {\n\twindow.Bootstrapper = {};\n\tBootstrapper.imageRequest = function(a) {var c=new Image(0,0);c.src=a;return c};\n\tBootstrapper.insertScript = function(a, c, d, h) {\n                var p = document.getElementsByTagName("script"), g;\n                h = void 0 !== h ? h : !0;\n                if (void 0 !== c ? c : 1)\n                    for (g = 0; g < p.length; g++)\n                        if (p[g].src === a && p[g].readyState && /loaded|complete/.test(p[g].readyState))\n                            return;\n                if (d) {\n                    d = 1 == d && "object" == typeof b.scDataObj ? b.scDataObj : d;\n                    e.rand = Math.random() * ("1E" + (10 * Math.random()).toFixed(0));\n                    c = window.location.href;\n                    "object" === typeof d && d.PageID && (c = d.PageID,\n                    delete d.PageID);\n                    if ("object" === typeof d)\n                        for (g in d) {\n                            g = ~c.indexOf("#") ? c.slice(c.indexOf("#"), c.length) : "";\n                            c = c.slice(0, g.length ? c.length - g.length : c.length);\n                            c += ~c.indexOf("?") ? "&" : "?";\n                            for (k in d)\n                                c += k + "=" + d[k] + "&";\n                            c = c.slice(0, -1) + g;\n                            break\n                        }\n                    a += "?";\n                    h && (a += "r=" + e.rand + "&");\n                    a += "ClientID=" + encodeURIComponent(e.options.clientId) + "&PageID=" + encodeURIComponent(c)\n                }\n                (function(a, c, b) {\n                    var d = c.head || c.getElementsByTagName("head");\n                    setTimeout(function() {\n                        if ("item"in d) {\n                            if (!d[0]) {\n                                setTimeout(arguments.callee, 25);\n                                return\n                            }\n                            d = d[0]\n                        }\n                        var a = c.createElement("script");\n                        a.src = b;\n                        a.onload = a.onerror = function() {\n                            this.addEventListener && (this.readyState = "loaded")\n                        }\n                        ;\n                        d.insertBefore(a, d.firstChild)\n                    }, 0)\n                }\n                )(window, document, a)\n            }\n            ;\n            Bootstrapper.loadScriptCallback = function(a, c, b) {\n                var d = document.getElementsByTagName("script"), e;\n                b = d[0];\n                for (e = 0; e < d.length; e++)\n                    if (d[e].src === a && d[e].readyState && /loaded|complete/.test(d[e].readyState))\n                        try {\n                            c()\n                        } catch (g) {\n                            //window[ensightenOptions.ns].reportException(g)\n                        } finally {\n                            return\n                        }\n                d = document.createElement("script");\n                d.type = "text/javascript";\n                d.async = !0;\n                d.src = a;\n                d.onerror = function() {\n                    this.addEventListener && (this.readyState = "loaded")\n                }\n                ;\n                d.onload = d.onreadystatechange = function() {\n                    if (!this.readyState || "complete" === this.readyState || "loaded" === this.readyState) {\n                        this.onload = this.onreadystatechange = null;\n                        this.addEventListener && (this.readyState = "loaded");\n                        try {\n                            c.call(this)\n                        } catch (g) {\n                            //window[ensightenOptions.ns].reportException(g)\n                        }\n                    }\n                }\n                ;\n                b.parentNode.insertBefore(d, b)\n            }\n            ;\n}\n\n\nwindow._TMutils = {\n\tgetQueryParam : function (p,url) {\n\t\t\t//var url = window.location.search,\n\t\t\tvar match;\n\t\t\tif (window.location.href.indexOf("#") !== -1) {\n\t\t\t\turl += "&" + window.location.href.split("#")[1]\n\t\t\t}\n\t\t\tmatch = new RegExp("[?&]" + p + "=([^&]*)", "i").exec(url);\n\t\t\treturn match ? IRF.util.safeDecodeURIComponent(match[1].replace(/\\+/g, " ")) : null\n\t},\n  readCookie : function(name) {\n\t\tvar nameEQ = name + "=";\n\t\tvar ca = document.cookie.split(\';\');\n\t\tfor(var i=0;i < ca.length;i++) {\n\t\t\tvar c = ca[i];\n\t\t\twhile (c.charAt(0)==\' \') c = c.substring(1,c.length);\n\t\t\tif (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);\n\t\t}\n\t\treturn null;\n\t},\n\tcreateCookie : function(name,value,days) {\n\t\tvar expires = "";\n\t\tvar date;\n\t\tvar domainstr = (~window.location.host.indexOf("microsoft.com")) ? "; domain=.microsoft.com; path=/; " : "; path=/; ";\n\t\tif (days) {\n\t\t\tdate = new Date();\n\t\t\tdate.setTime(date.getTime()+(days*24*60*60*1000));\n\t\t\texpires = "; expires="+date.toGMTString();\n\t\t}\n\t\tdocument.cookie = name+"="+value+expires+domainstr;\n\t},\n\tsafeDecodeURIComponent : function (s) {\n\t\tif (s) {\n\t\t\ts = s.replace(/%([EF][0-9A-F])%([89AB][0-9A-F])%([89AB][0-9A-F])/gi, function (code, hex1, hex2, hex3) {\n\t\t\t\t\tvar n1 = parseInt(hex1, 16) - 224;\n\t\t\t\t\tvar n2 = parseInt(hex2, 16) - 128;\n\t\t\t\t\tif (n1 == 0 && n2 < 32) {\n\t\t\t\t\t\treturn code\n\t\t\t\t\t}\n\t\t\t\t\tvar n3 = parseInt(hex3, 16) - 128;\n\t\t\t\t\tvar n = (n1 << 12) + (n2 << 6) + n3;\n\t\t\t\t\tif (n > 65535) {\n\t\t\t\t\t\treturn code\n\t\t\t\t\t}\n\t\t\t\t\treturn String.fromCharCode(n)\n\t\t\t\t});\n\t\t\ts = s.replace(/%([CD][0-9A-F])%([89AB][0-9A-F])/gi, function (code, hex1, hex2) {\n\t\t\t\t\tvar n1 = parseInt(hex1, 16) - 192;\n\t\t\t\t\tif (n1 < 2) {\n\t\t\t\t\t\treturn code\n\t\t\t\t\t}\n\t\t\t\t\tvar n2 = parseInt(hex2, 16) - 128;\n\t\t\t\t\treturn String.fromCharCode((n1 << 6) + n2)\n\t\t\t\t});\n\t\t\ts = s.replace(/%([0-7][0-9A-F])/gi, function (code, hex) {\n\t\t\t\t\treturn String.fromCharCode(parseInt(hex, 16))\n\t\t\t\t});\n\t\t\ts = s.replace("+", " ")\n\t\t}\n\t\treturn s\n\t},\n\tlogRuleCall : function (ruleName,debugParams,imageURL) {\n\t\tvar pType = "other";var market = "en-us";var cookieMSFPC = "msfpc";\n\t\tvar ff2,ff3,ff4,ff5,ff6;ff2=ff3=ff4=ff5=ff6="";\n\t\tvar jsDomain = encodeURIComponent(window.location.hostname.toLowerCase());\n        if (typeof _TMDL == "object") {pType = _TMDL.pageType;market = _TMDL.ll;}\n        function impGuid() {var result,i,j;result="";\n            for (j = 0; j < 32; j++) {if (j == 8 || j == 12 || j == 16 || j == 20)result = result + "-";\n                i = Math.floor(Math.random() * 16).toString(16).toUpperCase();result=result+i;}return result;}\n\t\t(function(imageURL){\t\n\t\tvar climit,temp2,temp3,temp4,URLlen;climit=255;URLlen=imageURL.length;\n\t\tif (URLlen <= climit) {ff2=imageURL;}\n\t\tif (URLlen > climit){ff2 = imageURL.slice(0,climit);temp2 = imageURL.slice(climit,URLlen);if (temp2.length <= climit){ff3=temp2;}else {ff3 = temp2.slice(0,climit);temp3 = temp2.slice(climit,URLlen);if (temp3.length <= climit) {ff4=temp3;}else{ff4 = temp3.slice(0,climit);temp4 = temp3.slice(climit,URLlen);if (temp4.length <= climit) {ff5=temp4;}else{ff5=temp4.slice(0,climit);ff6= temp4.slice(climit,URLlen);}}}}})(encodeURIComponent(imageURL));\n\t\tvar dtUTCTime = new Date;\n        var curUTCTime = dtUTCTime.getUTCFullYear() + "-" + dtUTCTime.getUTCMonth() + 1 + "-" + dtUTCTime.getUTCDate() + "T" + dtUTCTime.getUTCHours() + ":" + dtUTCTime.getUTCMinutes() + ":" + dtUTCTime.getUTCSeconds() + "." + dtUTCTime.getUTCMilliseconds() + "Z";\n        var str = "https://web.vortex.data.microsoft.com/collect/v1/t.js?ver\\x3d%272.1%27\\x26name\\x3d%27Ms.Webi.PageView%27\\x26";\n        str += "time\\x3d\'" + curUTCTime + "\'" + "\\x26appId\\x3d%27JS%3AUniStore%27\\x26-ver\\x3d%271.0%27\\x26-" + "impressionGuid\\x3d%27" + impGuid() + "%27" + "\\x26-pageName\\x3d%27" + encodeURIComponent(ruleName) + "%27" + "\\x26-pageType\\x3d%27" + pType + "%27" + "\\x26-market\\x3d%27" + encodeURIComponent(market) + "%27" + "\\x26-uri\\x3d%27" + encodeURIComponent(document.URL) + "%27" + "\\x26-referrerUri\\x3d%27" + encodeURIComponent(document.referrer) + "%27" + "\\x26-pageTags\\x3d%27%7B%22flightring%22%3A%22" + encodeURIComponent(debugParams) + "%22" + ",%22field2%22%3A%22" + encodeURIComponent(ff2) + "%22,%22field3%22%3A%22" + encodeURIComponent(ff3) +"%22,%22field4%22%3A%22" + encodeURIComponent(ff4) + "%22,%22field5%22%3A%22" + encodeURIComponent(ff5) +"%22,%22field6%22%3A%22" + encodeURIComponent(ff6) +"%22%7D%27\\x26-behavior\\x3d0" + "\\x26*baseType\\x3d%27Ms.Content.PageView%27\\x26*cookieEnabled\\x3dtrue\\x26*isJs\\x3dtrue" + "\\x26*title\\x3d%27" + encodeURIComponent(document.title) + "%27" + "\\x26*isLoggedIn\\x3dfalse\\x26*flashInstalled\\x3dfalse\\x26ext-app-env\\x3d%27DEV%27\\x26ext-javascript-libVer\\x3d%274.2.11%27" + "\\x26ext-javascript-domain\\x3d%27" + jsDomain + "%27" + "\\x26ext-javascript-msfpc\\x3d%27" + cookieMSFPC + "%27" + "\\x26ext-javascript-userConsent\\x3dfalse";\n        var imgTag = new Image;imgTag.src = str;\n\t}\n};\n',language:"javascript"}}]},{id:"RLde75a20693bd4fb18a1f30e9505db8c0",name:"Media_/en-us/ TikTok Clicks",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-us/d/",valueIsRegex:!0},{value:"/en-us/p/",valueIsRegex:!0},{value:"/en-us/store/configure/Surface",valueIsRegex:!0},{value:"/en-gb/d/",valueIsRegex:!0},{value:"/fr-fr/d/",valueIsRegex:!0},{value:"/de-de/d/",valueIsRegex:!0},{value:"/en-gb/p/",valueIsRegex:!0},{value:"/fr-fr/p/",valueIsRegex:!0},{value:"/de-de/p/",valueIsRegex:!0},{value:"/en-gb/store/configure/Surface",valueIsRegex:!0},{value:"/fr-fr/store/configure/Surface",valueIsRegex:!0},{value:"/de-de/store/configure/Surface",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"try {\n//PlaceAnOrder\njQuery(\"button:contains('Buy')\").on(\"mousedown\", function(){\n    var ttp = {};\n    ttp.content_id = _TMDL.pids[0];\n    ttp.content_name = _TMDL.pnames;\n    ttp.quantity =_TMDL.totqty[0];\n    ttp.price = _TMDL.itemprices[0];\n      ttq.track('PlaceAnOrder', ttp);\n  });\n        \n//AddToCart\njQuery(\"button:contains('Add to cart')\").on(\"mousedown\", function(){\n    var ttp = {};\n    ttp.content_id = _TMDL.pids[0];\n    ttp.content_name = _TMDL.pnames;\n    ttp.content_type = _TMDL.prdType;\n    ttp.quantity =_TMDL.totqty[0];\n    ttp.price = _TMDL.itemprices[0];\n      ttq.track('AddToCart', ttp);\n  });\n  \n//ClickButton\njQuery(\"button:contains('Rent'), button:contains('Get'), button:contains('Free'), button:contains('Configure now')\").on(\"mousedown\", function(){\n    var ttp = {};\n    ttp.content_id = _TMDL.pids[0];\n    ttp.content_name = _TMDL.pnames;\n    ttp.quantity =_TMDL.totqty[0];\n    ttp.price = _TMDL.itemprices[0];\n      ttq.track('ClickButton', ttp);  \n  });                                                                  \n}\ncatch(err)\n{\n\t_satellite.logger.error(\"Media_/en-us/ TikTok Clicks\");\n}",language:"javascript"}}]},{id:"RL7d79c8419a9a418b8b1c73ae64a0c9e1",name:"DIGSHELL",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:45}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"\\/p\\/",valueIsRegex:!0},{value:"\\/d\\/",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n\twindow.shell_Tracking = {\n\n\t\t_init: function () {\n\t\t\tshell_Tracking.hostname = window.location.hostname.replace(/\\.microsoft\\.com$/i, \'\');\n\t\t\tshell_Tracking.URI = window.location.pathname.toString();\n\t\t\t//setup page path dimensions\n\t\t\tshell_Tracking._getPath();\n\t\t},\n\n\t\t_getIsProd: function () {\n\t\t\tvar env = \'test\';\n\t\t\tif (shell_Tracking.hostname.match(/\\./g)) {\n\t\t\t\tenv = \'test\';\n\t\t\t\tshell_Tracking.env = \'test\';\n\t\t\t} else if (window.location.hostname.match(/\\.microsoft\\.com$/i)) {\n\t\t\t\tenv = \'\';\n\t\t\t\tshell_Tracking.env = \'prod\';\n\t\t\t\tshell_Tracking.hostname = \'onestore\';\n\t\t\t}\n\t\t\treturn env;\n\t\t},\n\n\t\t_getLocale: function () {\n\t\t\tshell_Tracking.locale = shell_Tracking.URI.replace(/^\\/(..\\-..).*/i, \'$1\');\n\t\t\tvar locale = shell_Tracking.locale.replace(/\\-/ig, \'\').replace(/\\//ig, \'\').toLowerCase();\n\t\t\treturn locale;\n\t\t},\n\n\t\t_removeLocale: function () {\n\t\t\tvar path = shell_Tracking.URI.replace(/^\\/..\\-..\\/?(.*)/i, \'$1\').toLowerCase();\n\t\t\treturn path;\n\t\t},\n\n\t\t_getPath: function () {\n\t\t\tvar path = shell_Tracking._removeLocale();\n\t\t\tpath = path.replace(/\\/$/, \'\').replace(/^\\//, \'\');\n\t\t\tshell_Tracking.path = path;\n\t\t},\n\n\t\t_onBeforePageView: function () {\n\t\t\t/*\n\t\t\tvar authCookie = shell_Tracking._getCookie(\'StoreMsaUser\');\n\t\t\tif (authCookie) {\n\t\t\t\tshell_Tracking.auth = \'y\';\n\t\t\t} else {\n\t\t\t\tshell_Tracking.auth = \'n\';\n\t\t\t}\n\t\t\t*/\n\t\t},\n\n\t\t_getCookie: function (name) {\n\t\t\tvar nameEQ = name + "=";\n\t\t\tvar ca = document.cookie.split(\';\');\n\t\t\tfor (var i = 0; i < ca.length; i++) {\n\t\t\t\tvar c = ca[i];\n\t\t\t\twhile (c.charAt(0) == \' \') { c = c.substring(1, c.length); }\n\t\t\t\tif (c.indexOf(nameEQ) == 0) { return unescape(c.substring(nameEQ.length, c.length)); }\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\n\t\t_getMetaValue: function(name) {\n\t\t\treturn $(\'meta[name="\' + name + \'"]\').attr(\'content\');\n\t\t},\n\n\t\t_recordXboxDigitalPurchase: function (data) {\n\t\t\tvar worksonxbox = ((shell_Tracking._getMetaValue("ms\\\\.prod_worksonxbox") && shell_Tracking._getMetaValue("ms\\\\.prod_worksonxbox")!==\'false\') || (window.location.pathname.indexOf("xbox") > -1)) ? true : false;\n\t\t\tvar pass_type = shell_Tracking._getMetaValue("ms\\\\.prod_pass_type");\n\t\t\tvar productFamily = shell_Tracking._getMetaValue("ms\\\\.prod_family");\n\t\t\tvar lcpath = window.location.pathname.toLowerCase();\n\n\t\t   var tax = data.lineItems[0].taxAmount;\n\t\t   var price = data.lineItems[0].totalAmount - tax;\n\t\t   \n\t\t\t// original floodlight\n\t\t\t//shell_Tracking._dispatchDCMpurchase(worksonxbox,pass_type,productFamily,data,"src=6952136;type=store00;cat=store00");  // added 6/26/17 -- keep as the generic version\n\n\t\t\t\n\t\t\t//xbox live gold : \n\t\t\t\t// \tCFQ7TTC0K5ZM -- physical\n\t\t\t\t// \tcfq7ttc0k5dj -- digital\n\t\t\t\t//   /src=8391497;type=xlg_sale;cat=pch_dgtl;qty=1;cost=[Revenue];\n\t\t\t// games and gamepass:  //src=8406391;type=xgpg_sls;cat=pch_dgtl;qty=1;cost=[Revenue];\n\n\n\n\t\t\tif (~window.location.pathname.toLowerCase().indexOf("cfq7ttc0k5zm") || ~window.location.pathname.toLowerCase().indexOf("cfq7ttc0k5dj")) {\n\t\t\t\t// XboxLiveGold_GBL_PchComplete_Transaction_DigitalStore:  src=8391497;type=xlg_sale;cat=pch_dgtl\n\t\t\t\tshell_Tracking._dispatchDCMpurchase(worksonxbox,pass_type,productFamily,data,"src=8391497;type=xlg_sale;cat=pch_dgtl");\n\t\t\t\tif(_TMDL.fbpchurl) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\t//fire facebook purchase pixel\n\t\t\t\t\t\tBootstrapper.imageRequest(_TMDL.fbpchurl+"&cd[value]="+price+"&cd[order_id]="+data.orderId);\n\t\t\t\t\t\tBootstrapper.imageRequest((_TMDL.fbpchurl+"&cd[value]="+price+"&cd[order_id]="+data.orderId).replace("464550763913771","1770559986549030"));\t\t\t\t\t\t\t\n\t\t\t\t\t} catch(fberr) {}\n\t\t\t\t}\n\t\t\t} else if (~lcpath.indexOf("cfq7ttc0k6l8") || ~lcpath.indexOf("cfq7ttc0kgq8") ||~lcpath.indexOf("cfq7ttc0khs0") || (productFamily && productFamily.toLowerCase() == \'passes\' && pass_type && pass_type.toLowerCase() == \'xbox\') || (productFamily.toLowerCase() == \'games\' && (worksonxbox || ~lcpath.indexOf("xbox") ) )) {\n\t\t\t\t//XboxGamePassGames_GBL_PchComplete_Transaction_DigitalStore\t/src=8406391;type=xgpg_sls;cat=pch_dgtl;qty=1;cost=[Revenue];\n\t\t\t\tshell_Tracking._dispatchDCMpurchase(worksonxbox,pass_type,productFamily,data,"src=8406391;type=xgpg_sls;cat=pch_dgtl");\n\t\t\t\tif(_TMDL.fbpchurl) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\t//fire facebook purchase pixel\n\t\t\t\t\t\tBootstrapper.imageRequest(_TMDL.fbpchurl+"&cd[value]="+price+"&cd[order_id]="+data.orderId);\n\t\t\t\t\t\tBootstrapper.imageRequest((_TMDL.fbpchurl+"&cd[value]="+price+"&cd[order_id]="+data.orderId).replace("464550763913771","1770559986549030"));\t\t\t\t\t\t\t\n\t\t\t\t\t} catch(fberr) {}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t//WindowsSoftware_GBL_PchComplete_Transaction_DigitalStore:  src=8406157;type=stot_sl;cat=pch_dgtl\n\t\t\t\t//WindowsSoftware_GBL_PchComplete_Transaction_DigitalStore:   src=8406727;type=wsft_sls;cat=pch_dgtl;  (CORRECT ONE)\n\t\t\t\t//Store-Other_GBL_PchComplete_Transaction_DigitalStore:  src=8406391;type=xgpg;cat=pdv_dgtl\n\t\t\t\t\n\t\t\t\t//shell_Tracking._dispatchDCMpurchase(worksonxbox,pass_type,productFamily,data,"src=8406391;type=xgpg;cat=pdv_dgtl");\n\t\t\t\tshell_Tracking._dispatchDCMpurchase(worksonxbox,pass_type,productFamily,data,"src=8406727;type=wsft_sls;cat=pch_dgtl;");\n\t\t\t}\n\t\t\t\n\t\t\ttry {\n\t\t\t\tif (typeof _TMDL.convcallbacks!==\'undefined\') {\n\t\t\t\t\tfor (var i=0; i< _TMDL.convcallbacks.length; i++) {\n\t\t\t\t\t\t_TMDL.convcallbacks[i](data,price,tax,data.orderId);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} catch(callbackerr) {}\n\t\t\t\n\t\t},\n\t\t_dispatchDCMpurchase: function(worksonxbox,pass_type,productFamily,data,floodlightparams) {\n\t\t\t// added 6/26/17 -- this will be the older tag from before the DCM restructure\n\t\t\tvar a = "" + parseInt(1E5 * 1E4 * Math.random() * Math.random(),10)+ parseInt((Math.random() * 100000000),10);\n\t\t\t//var shell_locale = shell_Tracking.locale || shell_Tracking.URI.replace(/^\\/(..\\-..).*/i, \'$1\');\n\t\t\t//var geo = shell_locale.split("-")[1];\n\t\t   //var locale = shell_locale.replace(/\\-/ig, \'\').replace(/\\//ig, \'\').toLowerCase();\n\t\t   var title = data.lineItems[0].title;\n\t\t   var productType = data.lineItems[0].productType;\n\t\t   var productId = data.lineItems[0].productId;\n\t\t   var availabilityId = data.lineItems[0].availabilityId;\n\t\t   var tax = data.lineItems[0].taxAmount;\n\t\t   var price = data.lineItems[0].totalAmount - tax;\n\t\t   var currencyCode = data.lineItems[0].currencyCode;\n\t\t   //var paymentTypeEvent = \'\';\n\t\t\tvar url = "https://ad.doubleclick.net/ddm/activity/"+floodlightparams+";qty=1;cost="+price+";u1="+_TMDL.geo.toUpperCase()+";u2="+_TMDL.ll\n\t\t\t +";u25="+productId\n\t\t\t +";u26="+encodeURIComponent(title)\n\t\t\t +";u30="+productType\n\t\t\t +";u31="+currencyCode\n\t\t\t +";u32="+productId\n\t\t\t +";u33="+productId\n\t\t\t +";u34="+data.orderId\n\t\t\t //+";u35="+_TMDL.totqty\n\t\t\t +";u35=1"\n\t\t\t +";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="+data.orderId;\n\n\t\t var px = new Image(1, 1);\n\t\t px.src = url;\n\t  },\n\t\t\n\t\t_dispatchGamePassGamesRT: function () {\n\t\t\tvar url = "https://www.facebook.com/tr?id=1218689904914212&ev=PageView&noscript=1";\n\t\t\tvar px = new Image(1, 1);\n\t\t\tpx.src = url;\n\t\t\tBootstrapper.imageRequest("https://googleads.g.doubleclick.net/pagead/viewthroughconversion/968413686/?value=0&guid=ON&script=0");\n\t\t\tBootstrapper.imageRequest("https://bat.bing.com/action/0?ti=4000034&Ver=2");\n\t\t},\n\n\t};\n\t\n\tvar url="";\n\tvar worksonxbox = shell_Tracking._getMetaValue("ms\\\\.prod_worksonxbox")=="true" || (window.location.pathname.toLowerCase().indexOf("xbox") > -1) || (typeof _TMDL.pnames[0] !== \'undefined\' && _TMDL.pnames[0].toLowerCase().indexOf("xbox")>-1);\n\tvar type = $(\'meta[name="ms\\\\.prod_type"]\').attr(\'content\') || \'\';\n\tvar pass_type = $(\'meta[name="ms\\\\.prod_pass_type"]\').attr(\'content\') || \'\';\n\tif (worksonxbox && type && (type.toLowerCase() == \'games\' || type.toLowerCase() == \'addons\') || (window.location.pathname.match(/\\/xbox$/i)) || (pass_type && pass_type.toLowerCase() == \'xbox\')) {\n\n\t\tshell_Tracking._init();\n\n\t\trequire([\'jquery\'], function ($) {\n\t\t\t$(\'document\').ready(function () {\n\t\t\t\ttry {\n\t\t\t\t\t//shell_Tracking._onBeforePageView();\n\t\t\t\t\t//shell_Tracking._recordOmniturePageView();\n\t\t\t\t\t//shell_Tracking._initClickTracking();\n\t\t\t\t} catch (ex) { }\n\t\t\t});\n\t\t});\n\t}\n}\ncatch(err)\n{\n\t_satellite.logger.error("DIGSHELL");\t\n}\n\n',language:"javascript"}}]},{id:"RLef0315aa87014acb9bc9a60708599d11",name:"VRZNLPXbox",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"^/en-us/p/xbox.*",valueIsRegex:!0},{value:"^/de-de/p/xbox.*",valueIsRegex:!0},{value:"^/fr-fr/p/xbox.*",valueIsRegex:!0},{value:"^/en-gb/p/xbox.*",valueIsRegex:!0},{value:"^/en-au/p/xbox.*",valueIsRegex:!0},{value:"^/jp-jp/p/xbox.*",valueIsRegex:!0},{value:"^/en-ca/p/xbox.*",valueIsRegex:!0},{value:"^/fr-ca/p/xbox.*",valueIsRegex:!0},{value:"^/en-us/d/xbox.*",valueIsRegex:!0},{value:"^/de-de/d/xbox.*",valueIsRegex:!0},{value:"^/fr-fr/d/xbox.*",valueIsRegex:!0},{value:"^/en-gb/d/xbox.*",valueIsRegex:!0},{value:"^/en-au/d/xbox.*",valueIsRegex:!0},{value:"^/jp-jp/d/xbox.*",valueIsRegex:!0},{value:"^/en-ca/d/xbox.*",valueIsRegex:!0},{value:"^/fr-ca/d/xbox.*",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try {\n  var image = new Image(1,1);\n  image.src = "//sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=ViewProduct&product_id=" + _pageBITags.pageContracts.ProductInfo.id + "-" + _pageBITags.pageContracts.ProductInfo.sku;\n}\ncatch(err)\n{\n\t_satellite.logger.error("Verizon_LP");\n}',language:"javascript"}}]},{id:"RLf6485d219649415ab9f7aef1461c1c3a",name:"DCMLP",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"www.microsoft.com"==window.location.host.toLowerCase()}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{
source:'try\n{\n\tvar doFloodlights = function(debug) {\n\t\ttry {\n\t\t\t_TMDL.dcmcat = [];\n\n\t\t\tvar imgsrc1,imgsrc2,imgsrc3,imgscr4;\n\t\t\tvar\ta = "" + (Math.random() * 10000000000000);\n\t\t\tvar mc1 = "";\n\t\t\tvar pth = window.location.pathname.toLowerCase();\n\t\t\tvar pthmatch;\n\t\t\t\n\t\t\t// office and surface don\'t have the same structure for "cat" parameter\n\t\t\tvar landingpageCountFloodlights = {\n\t\t\t\t\twindowsdevices : "/src=8406115;type=wndv;cat=phy_std",\n\t\t\t\t\twindowssoftware : "/src=8406727;type=wsft;cat=phy_std",\n\t\t\t\t\tothersoftware : "/src=8406724;type=sftw;cat=phy_std",\n\t\t\t\t\tsurface : "/src=8400690;type=surf;cat=lp_phy",  // nonstandard\n\t\t\t\t\txboxplatform : "/src=8391491;type=xbxp;cat=phy_std",\n\t\t\t\t\txboxgames : "exclude",\n\t\t\t\t\txboxdesignlabs : "/src=8404966;type=xdl;cat=phy_std",\n\t\t\t\t\txboxgamepass : "/src=8406391;type=xgpg;cat=phy_std",\n\t\t\t\t\txboxlive : "/src=8391497;type=xlg;cat=phy_std",\n\t\t\t\t\thololens : "/src=8391509;type=hll;cat=phy_std",\n\t\t\t\t\toffice : "/src=8406097;type=ofco;cat=lpst_std",  // nonstandard\n\t\t\t\t\tminecraft : "exclude",\n\t\t\t\t\tother : "/src=8406157;type=stoth;cat=phy_std"\t\n\t\t\t};\n\n\t\t\tvar genericLandingpageFloodlights = {\n\t\t\t\t\twindowsdevices : "/src=8406115;type=wndv;cat=lp_std",\n\t\t\t\t\twindowssoftware : "exclude",\n\t\t\t\t\tothersoftware : "exclude",\n\t\t\t\t\tsurface : "/src=8400690;type=surf;cat=lp_std",  // nonstandard\n\t\t\t\t\txboxplatform : "/src=8391491;type=xbxp;cat=lp_std",\n\t\t\t\t\txboxgames : "/src=8406391;type=xbxgms;cat=lp_std",\n\t\t\t\t\txboxdesignlabs : "/src=8404966;type=xdl;cat=lp_std",\n\t\t\t\t\txboxgamepass : "/src=8406391;type=xgpg;cat=gplp_std",\n\t\t\t\t\txboxlive : "/src=8391497;type=xlg;cat=lp_std",\n\t\t\t\t\thololens : "/src=8391509;type=hll;cat=lp_std",\n\t\t\t\t\toffice : "exclude",  // nonstandard\n\t\t\t\t\tminecraft : "/src=8400687;type=mc;cat=lp_std",\n\t\t\t\t\tother : "exclude"\t\n\t\t\t};\n\t\t\t\n\t\t\tvar landingpageUniqueFloodlights = {\n\t\t\t\t\twindowsdevices : "/src=8406115;type=wndv;cat=phy_uni",\n\t\t\t\t\twindowssoftware : "/src=8406727;type=wsft;cat=phy_uni",\n\t\t\t\t\tothersoftware : "/src=8406724;type=sftw;cat=phy_uni",\n\t\t\t\t\tsurface : "/src=8400690;type=surf;cat=lp_uni",  // nonstandard\n\t\t\t\t\txboxplatform : "/src=8391491;type=xbxp;cat=phy_uni",\n\t\t\t\t\txboxgames : "exclude",\n\t\t\t\t\txboxdesignlabs : "/src=8404966;type=xdl;cat=phy_uni",\n\t\t\t\t\txboxgamepass : "/src=8406391;type=xgpg;cat=phy_uni",\n\t\t\t\t\txboxlive : "/src=8391497;type=xlg;cat=phy_uni",\n\t\t\t\t\thololens : "/src=8391509;type=hll;cat=phy_uni",\n\t\t\t\t\toffice : "/src=8406097;type=ofco;cat=lp_uni",  // nonstandard\n\t\t\t\t\tminecraft : "exclude",\n\t\t\t\t\tother : "exclude"\t\n\t\t\t};\n\n\t\t\t// only windowssoftware has a PrdCatVue tag (WindowsSoftware_GBL_PrdCatVue_Count_PhysicalStore)\n\t\t\tvar categoryFloodlights = {\n\t\t\t\t\twindowsdevices : "exclude",\n\t\t\t\t\twindowssoftware : "/src=8406727;type=wsft;cat=pdcv_phy",\n\t\t\t\t\tothersoftware : "exclude",\n\t\t\t\t\tsurface : "exclude",\n\t\t\t\t\txboxplatform : "exclude",\n\t\t\t\t\txboxgames : "exclude",\n\t\t\t\t\txboxdesignlabs : "exclude",\n\t\t\t\t\txboxgamepass : "exclude",\n\t\t\t\t\txboxlive : "exclude",\n\t\t\t\t\thololens : "exclude",\n\t\t\t\t\toffice : "exclude",\n\t\t\t\t\tminecraft : "exclude",\n\t\t\t\t\tother : "exclude"\t\n\t\t\t};\n\n\t\t\tvar pdpFloodlights = {\n\t\t\t\twindowsdevices : "/src=8406115;type=wndv;cat=prdv_std",  // nonstandard\n\t\t\t\twindowssoftware : "/src=8406727;type=wsft_sls;cat=pdv_phy",\n\t\t\t\tothersoftware : "/src=8406724;type=sftw_sls;cat=pdv_phy",\n\t\t\t\tsurface : "/src=8400690;type=surf;cat=prdv_std",  // nonstandard\n\t\t\t\txboxplatform : "/src=8391491;type=xbxp;cat=pdv_phy",\n\t\t\t\txboxgames : "xboxgames",\n\t\t\t\txboxdesignlabs : "/src=8404966;type=xdl_sls;cat=pdv_phy",\n\t\t\t\txboxgamepass : "/src=8406391;type=xgpg_sls;cat=pdv_phy",\n\t\t\t\txboxlive : "/src=8391497;type=xlg;cat=pdv_phy",\n\t\t\t\thololens : "/src=8391509;type=hll;cat=pdv_phy",\n\t\t\t\toffice : "/src=8406097;type=ofco;cat=prdv_std",  // nonstandard\n\t\t\t\tminecraft : "exclude",\n\t\t\t\tother : "exclude"\n\t\t\t};\n\t\t\t\n\t\t\tvar categoryCounts = {\n\t\t\t\twindowsdevices : 0,\n\t\t\t\twindowssoftware : 0,\n\t\t\t\tothersoftware : 0,\n\t\t\t\tsurface : 0,\n\t\t\t\txboxplatform : 0,\n\t\t\t\txboxgames : 0,\n\t\t\t\txboxdesignlabs : 0,\n\t\t\t\txboxgamepass : 0,\n\t\t\t\txboxlive : 0,\n\t\t\t\thololens : 0,\n\t\t\t\toffice : 0,\n\t\t\t\tminecraft : 0,\n\t\t\t\tother : 0\n\t\t\t};\n\t\t\t\n\t\t\tvar matchWindowBrand = function(pname) {\n\t\t\t\tvar brandnames = [\n\t\t\t\t\t["acer","windowsdevices"],\n\t\t\t\t\t["alienware","windowsdevices"],\n\t\t\t\t\t["asus","windowsdevices"],\n\t\t\t\t\t["cyberpowerpc","windowsdevices"],\n\t\t\t\t\t["dell","windowsdevices"],\n\t\t\t\t\t["hp","windowsdevices"],\n\t\t\t\t\t["huawei","windowsdevices"],\n\t\t\t\t\t["ibuypower","windowsdevices"],\n\t\t\t\t\t["lenovo","windowsdevices"],\n\t\t\t\t\t["linx","windowsdevices"],\n\t\t\t\t\t["logah","windowsdevices"],\n\t\t\t\t\t["millet","windowsdevices"],\n\t\t\t\t\t["porsche","windowsdevices"],\n\t\t\t\t\t["razer","windowsdevices"],\n\t\t\t\t\t["samsung","windowsdevices"],\n\t\t\t\t\t["toshiba","windowsdevices"],\n\t\t\t\t\t["/collections/laptops","windowsdevices"],\n\t\t\t\t\t["/store/b/pc","windowsdevices"],\t\t\n\t\t\t\t\t["/store/b/pc","windowsdevices"]\t\t\n\t\t\t\t];\n\t\t\t\tfor (var i=0; i<brandnames.length; i++){\n\t\t\t\t\tif (~pname.toLowerCase().indexOf(brandnames[i][0])) {\n\t\t\t\t\t\tif (debug) { console.log("matched windows brand");}\n\t\t\t\t\t\treturn brandnames[i][1];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t};\n\n\t\t\t// update pidlist\n\t\t\tvar pidlist={\n\t\t\t\t\n\t\t\t\'D76QX4BZNWK4\' : \'windowssoftware\',\n\t\t\t\'DF77X4D43RKT\' : \'windowssoftware\',\n\t\t\t\'DG7GMGF0DS12\' : \'windowssoftware\',\n\t\t\t\'DG7GMGF0DS1H\' : \'windowssoftware\',\n\t\t\t\n\t\t\t\'DG7GMGF0DST3\' : \'othersoftware\',\n\t\t\t\'DG7GMGF0DST4\' : \'othersoftware\',\n\t\t\t\'DG7GMGF0DST5\' : \'othersoftware\',\n\t\t\t\'DG7GMGF0DST6\' : \'othersoftware\',\n\t\t\t\'DG7GMGF0DWP2\' : \'othersoftware\',  \n\n\n\t\t\t\'8MB6CR05S1QD\' : \'xboxplatform\',\n\n\t\t\t\'8MC6K8M228SK\' : \'surface\',\n\t\t\t\'8MCPZJJCC98C\' : \'surface\',\n\t\t\t\'8N1V4QJ3GQ5X\' : \'surface\',\n\t\t\t\'8NKT9WTTRBJK\' : \'surface\',\n\t\t\t\'8RKCLMWPW1PP\' : \'surface\',\n\t\t\t\'8XCW9BBPVFV9\' : \'surface\',\n\t\t\t\'907TDS4DGWWV\' : \'surface\',\n\t\t\t\'90FC23DV6SNZ\' : \'surface\',\n\t\t\t\'93LTM69S3RFF\' : \'surface\',\n\n\t\t\t\'8XF18PQZ17TS\' : \'hololens\',\n\t\t\t\'90MDTZVL02K9\' : \'hololens\',\n\t\t\t\'944XGCF64Z5B\' : \'hololens\',\n\t\t\t\n\t\t\t\'900WZDF9XJVG\' : \'xboxdesignlabs\',\n\t\t\t\'93JLLWMDZ0V7\' : \'xboxdesignlabs\',\n\t\t\t\'941H3FP99RM3\' : \'xboxdesignlabs\',\n\t\t\t\'8TBJW32WJF8C\' : \'xboxdesignlabs\',\n\t\t\t\'90T6CGN08P38\' : \'xboxdesignlabs\',\n\t\t\t\'90K4SGTLSKML\' : \'xboxdesignlabs\',\n\t\t\t\'8VK59S4SSLWD\' : \'xboxdesignlabs\',\n\t\t\t\'8TVCQSJ7V6PT\' : \'xboxdesignlabs\',\n\t\t\t\'8T07Q5SRTV11\' : \'xboxdesignlabs\',\n\t\t\t\'8VKFWF7M03NJ\' : \'xboxdesignlabs\',\n\t\t\t\'90GBR9CZBHJ9\' : \'xboxdesignlabs\',\n\t\t\t\'9355VZP4KXB8\' : \'xboxdesignlabs\',\n\t\t\t\'8QT59S4FDX8Z\' : \'xboxdesignlabs\',\n\t\t\t\n\t\t\t\'CFQ7TTC0K5ZM\' : \'xboxlive\',\n\t\t\t\n\t\t\t\'CFQ7TTC0K5F8\' : \'office\',\n\t\t\t\'CFQ7TTC0K5FD\' : \'office\',\n\t\t\t\'CFQ7TTC0K5FF\' : \'office\',\n\t\t\t\'CFQ7TTC0K5BB\' : \'office\',\n\t\t\t\'CFQ7TTC0K5BC\' : \'office\',\n\t\t\t\'CFQ7TTC0K5BD\' : \'office\',\n\t\t\t\'8N0LL43Q1H85\' : \'office\',\n\t\t\t\'CFQ7TTC0K5DZ\' : \'office\',\n\t\t\t\'CFQ7TTC0K5F2\' : \'office\',\n\t\t\t\'CFQ7TTC0K5F3\' : \'office\',\n\t\t\t\'CFQ7TTC0K5BH\' : \'office\',\n\t\t\t\'CFQ7TTC0K5D6\' : \'office\',\n\t\t\t\'CFQ7TTC0K5D7\' : \'office\',\n\t\t\t\'CFQ7TTC0K5CD\' : \'office\',\n\t\t\t\'CFQ7TTC0K5CF\' : \'office\',\n\t\t\t\'CFQ7TTC0K5CP\' : \'office\',\n\t\t\t\'CFQ7TTC0K5CS\' : \'office\',\n\t\t\t\'CFQ7TTC0K5CT\' : \'office\',\n\t\t\t\'CFQ7TTC0K5D0\' : \'office\',\n\t\t\t\'CFQ7TTC0K5DN\' : \'office\',\n\t\t\t\'CFQ7TTC0K5DM\' : \'office\',\n\t\t\t\'CFQ7TTC0K5BF\' : \'office\',\n\t\t\t\'CFQ7TTC0K5FB\' : \'office\',\n\t\t\t\'CFQ7TTC0K5FC\' : \'office\',\n\t\t\t\n            // added 4/20/20 for alta\n            \'8PC5BJBHN74P\' : \'office\',\n            \'94CM694VJ57P\' : \'office\',\n            \'900RPBX20TS6\' : \'office\',\n            \'93R684WJ71VJ\' : \'office\',\n            \'8V9J0T4JFZ6W\' : \'office\',\n            \'8NFJC88FKMRZ\' : \'office\',\n            \'8SZWM812T6N1\' : \'office\',\n            \'CFQ7TTC0K5BG\' : \'office\',\n            \'8V883X3J1V40\' : \'office\',\n            // end alta\n              \n\t\t\t\'BPSWGQBW7R3G\': \'xboxplatform\',\n\t\t\t\'9NBLGGH4PBBM\': \'xboxplatform\', \n\n\n\t\t\t\'SHOULDNEVERMATCH\' : \'pc\'\n\t\t\t};\n\n\t\t\t// _TMDL.prdType and _TMDL.prdFam\n\t\t\t\n\t\t\tif ((~pth.indexOf("/d/") || ~pth.indexOf("/p/")) && _TMDL.pids && pidlist[_TMDL.pids[0]]) {\n\t\t\t\t// check pids for anything explicitly mapped\n\t\t\t\tcategoryCounts[pidlist[_TMDL.pids[0]]]++;\n\t\t\t\tif (debug) { console.log("matched PID", _TMDL.pids[0], pidlist[_TMDL.pids[0]]); }\n\t\t\t} else if (~pth.indexOf("surface") ) {\n\t\t\t\tcategoryCounts["surface"]++;\n\t\t\t} else if (~pth.indexOf("office") || ~pth.indexOf("o365")) {\n\t\t\t\tcategoryCounts["office"]++;\n\t\t\t} else if (~pth.indexOf("minecraft") ) {\n\t\t\t\tcategoryCounts["minecraft"]++;\n\t\t\t} else if (~pth.indexOf("xbox") ) {\n\t\t\t\tcategoryCounts["xboxplatform"]++;\n\t\t\t} else if (~pth.indexOf("hololens") ) {\n\t\t\t\tcategoryCounts["hololens"]++;\n\t\t\t} else {\n\t\t\t\tpthmatch = matchWindowBrand(pth);\n\t\t\t\tif (pthmatch) {\n\t\t\t\t\tcategoryCounts[pthmatch]++;\n\t\t\t\t} else {\n\t\t\t\t\t// TODO:  check if physical\n\t\t\t\t\tcategoryCounts["other"]++;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\ttry {\n\t\t\t\tif (_TMutils.readCookie("MC1")) {\n\t\t\t\t\tmc1 = _TMutils.readCookie("MC1").split("&")[0].split("=")[1]; //use in u58\n\t\t\t\t}\n\t\t\t} catch(mc1err) {}\t\n\n\n\t\t\t/* set the floodlights based on the page */\n\t\t\tif (_TMDL.pageType=="receipt" || _TMDL.pageType=="congrats") {\n\t\t\t\tfloodlights = purchaseFloodlights;\n\t\t\t} else if (~_TMDL.pageType.indexOf("cart")) {\n\t\t\t\tfloodlights = cartFloodlights;\n\t\t\t}\n\t\t\t\n\t\t\tif(debug) {\tconsole.log(categoryCounts); }\n\n\t\t\tfor (key in categoryCounts) {\n\n\t\t\t\tif (categoryCounts[key]>0) {\t\t\n\t\t\t\t\tif (debug) {console.log(key,categoryCounts[key],landingpageUniqueFloodlights[key],"\\n");}\n\t\t\t\t\n\t\t\t\t\t// Activity Name: Store_AllProd_GBL_LandingPageVue_Unique_\n\t\t\t\t\tif (landingpageUniqueFloodlights[key] !== "exclude") {\n\t\t\t\t\t\timgsrc1 = "https://ad.doubleclick.net/ddm/activity"+landingpageUniqueFloodlights[key]+";u1="+_TMDL.geo.toUpperCase()+";u2="+_TMDL.ll\n\t\t\t\t\t\t\t//+";u5="+encodeURIComponent(document.referrer)\n\t\t\t\t\t\t\t+";u6="+encodeURIComponent(_TMDL.pageName)\n\t\t\t\t\t\t\t+";u7="+encodeURIComponent(window.location.pathname.toLowerCase())\n\t\t\t\t\t\t\t+";u25="+_TMDL.pids+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u31="+_TMDL.cc+";u33="+_TMDL.pidsku\n\t\t\t\t\t\t\t+";u58="+mc1\n\t\t\t\t\t\t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1;num="+a+"?";\n\t\t\t\t\t\timgsrc = imgsrc1;\n\t\t\t\t\t\tif (debug) { console.log(imgsrc1); }\n\t\t\t\t\t\tBootstrapper.imageRequest(imgsrc1);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\n\t\t\t\t\t/* Activity name of this tag: Store_AllProd_GBL_LandingPageVue_Count_  */\n\t\t\t\t\tif (landingpageCountFloodlights[key] !== "exclude") {\n\t\t\t\t\t\timgsrc2 = "https://ad.doubleclick.net/ddm/activity"+landingpageCountFloodlights[key]+";u1="+_TMDL.geo.toUpperCase()+";u2="+_TMDL.ll\n\t\t\t\t\t\t\t+";u6="+encodeURIComponent(_TMDL.pageName)\n\t\t\t\t\t\t\t+";u7="+encodeURIComponent(window.location.pathname.toLowerCase())\n\t\t\t\t\t\t\t+";u25="+_TMDL.pids+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u31="+_TMDL.cc+";u33="+_TMDL.pidsku\n\t\t\t\t\t\t\t+";u58="+mc1\n\t\t\t\t\t\t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1;num="+a+"?";\n\t\t\t\t\t\timgsrc = imgsrc2;\n\t\t\t\t\t\tif (debug) { console.log(imgsrc2); }\n\t\t\t\t\t\tBootstrapper.imageRequest(imgsrc2);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t/*  genericLandingpageFloodlights  */\n\t\t\t\t\tif (genericLandingpageFloodlights[key] !== "exclude") {\n\t\t\t\t\t\timgsrc1 = "https://ad.doubleclick.net/ddm/activity"+genericLandingpageFloodlights[key]+";u1="+_TMDL.geo.toUpperCase()+";u2="+_TMDL.ll\n\t\t\t\t\t\t\t//+";u5="+encodeURIComponent(document.referrer)\n\t\t\t\t\t\t\t+";u6="+encodeURIComponent(_TMDL.pageName)\n\t\t\t\t\t\t\t+";u7="+encodeURIComponent(window.location.pathname.toLowerCase())\n\t\t\t\t\t\t\t+";u25="+_TMDL.pids+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u31="+_TMDL.cc+";u33="+_TMDL.pidsku\n\t\t\t\t\t\t\t+";u58="+mc1\n\t\t\t\t\t\t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1;num="+a+"?";\n\t\t\t\t\t\timgsrc = imgsrc1;\n\t\t\t\t\t\tif (debug) { console.log(imgsrc1); }\n\t\t\t\t\t\tBootstrapper.imageRequest(imgsrc1);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif (_TMDL.pageType=="detail" && (~_TMDL.prdType[0].toLowerCase().indexOf("device") || ~_TMDL.prdType[0].toLowerCase().indexOf("pass"))) {\n\t\t\t\t\t\t_TMDL.dcmcat.push(key);\n\t\t\t\t\t\tif (pdpFloodlights[key] !== "exclude") {\n\t\t\t\t\t\t\t// Store_AllProd_GBL_PrdVue_Count_PhysicalStore\n\t\t\t\t\t\t\timgsrc3 = "https://ad.doubleclick.net/ddm/activity"+pdpFloodlights[key]+";u1="+_TMDL.geo.toUpperCase()+";u2="+_TMDL.ll\n\t\t\t\t\t\t\t\t+";u6="+encodeURIComponent(_TMDL.pageName)\n\t\t\t\t\t\t\t\t+";u7="+encodeURIComponent(window.location.pathname.toLowerCase())\n\t\t\t\t\t\t\t\t+";u25="+_TMDL.pids+";u26="+encodeURIComponent(_TMDL.pnames)+";u32="+_TMDL.pids+";u33="+_TMDL.pidsku+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="+a;\n\t\t\t\t\t\t\timgsrc = imgsrc3;\n\t\t\t\t\t\t\tBootstrapper.imageRequest(imgsrc3);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (~_TMDL.pageType.toLowerCase().indexOf("category") && ~window.location.pathname.indexOf("/b/")){\n\t\t\t\t\t\t_TMDL.dcmcat.push(key);\n\t\t\t\t\t\tif (categoryFloodlights[key] !== "exclude") {\n\t\t\t\t\t\t\timgsrc4 = "https://ad.doubleclick.net/ddm/activity"+categoryFloodlights[key]+";u1="+_TMDL.geo.toUpperCase()+";u2="+_TMDL.ll\n\t\t\t\t\t\t\t\t+";u6="+encodeURIComponent(_TMDL.pageName)\n\t\t\t\t\t\t\t\t+";u7="+encodeURIComponent(window.location.pathname.toLowerCase())\n\t\t\t\t\t\t\t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="+a+"?";\n\t\t\t\t\t\t\timgsrc = imgsrc4;\n\t\t\t\t\t\t\tBootstrapper.imageRequest(imgsrc4);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (debug) { console.log(_TMDL.dcmcat) ; }\n\t\t\t\t}\n\t\t\t}\n\t\t\n\t\t} catch(flerr) {\n\t\t\t_TMutils.logRuleCall("DCMLP err",flerr.name,flerr.message);\n\t\t}\n\n\t};\n\n\n\tvar pth = window.location.pathname.toLowerCase();\n\tvar debug = ~window.location.href.indexOf("debug") ? 1 : 0;\n\n\n\n\t// -----------------------------------------\n\t//   previously separate digital pages tags\n\t// -----------------------------------------\n\n\tvar _getMetaValue = function(name) {\n\t\t\treturn $(\'meta[name="\' + name + \'"]\').attr(\'content\');\n\t\t};\n\t\t\n\tvar fireDCM = function(params) {\n\t\tvar a, imgsrc1, imgsrc2;\n\t\ta = "" + (Math.random() * 10000000000000);\n\t\timgsrc1 = "https://ad.doubleclick.net/ddm/activity/"+params+";u1="+_TMDL.geo.toUpperCase()+";u2="+_TMDL.ll\n\t\t\t+";u20="+_TMDL.pidsku\n\t\t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="+a+"?";\n\t\timgsrc = imgsrc1;\n\t\tBootstrapper.imageRequest(imgsrc1);\n\t\t\n\t\tif (debug) {console.log(params);}\n\t};\n\n\tvar matchXboxBrand = function(pname) {\n\t\tvar brandnames = [\n\t\t\t"forza",\n\t\t\t"call of duty",\n\t\t\t"tomb raider",\n\t\t\t"toy soldiers war chest",\n\t\t\t"red dead"\n\t\t\t];\n\t\tfor (var i=0; i<brandnames.length; i++){\n\t\t\tif (~pname.toLowerCase().indexOf(brandnames[i])) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t};\n\n\tvar pdpname = (_TMDL.pnames.length>0 && ~_TMDL.pnames[0]) ? _TMDL.pnames[0].toLowerCase() : "";\n\tvar isPhysicalPage = (~pth.indexOf("/store/") && pth.indexOf("/p/")<0) || (~pth.indexOf("/p/") && _TMDL.prdType[0]!=="Apps" && _TMDL.prdType[0]!=="Games");\n\tvar\ta = "" + (Math.random() * 10000000000000);\n\tvar configdeviceurl="",buildyourbundleurl="", checkeligibilityurl="", addtocarturl="";\n\tvar imgsrc="";\n\t\n\tif (isPhysicalPage) {doFloodlights(debug);}\n\n\tif (_TMDL.prdType=="Games" || _TMDL.prdType=="Passes" || _TMDL.prdType=="Apps") {\n\t\tif ( ~pth.indexOf("cfq7ttc0k5zm") || ~pth.indexOf("cfq7ttc0k5dj")) {\n\t\t\t// XboxLiveGold_GBL_PrdVue_Count_DigitalStore:  /src=8391497;type=xlg;cat=pdv_dgtl;\n\t\t\tfireDCM("src=8391497;type=xlg;cat=pdv_dgtl");  \n          $(document).on(\'mousedown\',\'button#buttons_AddToCartButton,button:contains("Buy"),a:contains("Buy"), button[id*="RedeemCodeButton"]\',\'\', function() {\n\t\t\t\t//console.log("AddToCart");  // XboxLiveGold_GBL_CartVue_Count_DigitalStore\n\t\t\t\tfireDCM("src=8391497;type=xlg;cat=crtd_std");\n\t\t\t});\n\t\t} else if (\t( _TMDL.prdType=="Games" && (_getMetaValue("ms\\\\.prod_worksonxbox")=="true" || matchXboxBrand(pdpname))) || (pth.indexOf("xbox") > -1) || ~pdpname.indexOf("xbox") ) {\n\t\t\t//XboxGamePassGames_GBL_PrdVue_Count_DigitalStore:  /src=8406391;type=xgpg;cat=pdv_dgtl;\n\t\t\t//console.log("XboxGamePassGames_GBL_PrdVue_Count_DigitalStore");\n\t\t\tfireDCM("src=8406391;type=xgpg;cat=pdv_dgtl");\n          $(document).on(\'mousedown\',\'button#buttons_AddToCartButton,button:contains("Buy"),a:contains("Buy"), button[id*="RedeemCodeButton"]\',\'\', function() {\n\t\t\t\t//console.log("AddToCart"); //XboxGamePassGames_GBL_CartVue_Count_DigitalStore\n\t\t\t\tfireDCM("src=8406391;type=xgpg;cat=crtd_std");\n\t\t\t});\n\t\t} else if (_TMDL.prdType=="Apps" || _TMDL.prdType=="Games") {\n\t\t\t//WindowsSoftware_GBL_PrdVue_Count_DigitalStore\n\t\t\t//console.log("WindowsSoftware_GBL_PrdVue_Count_DigitalStore");\n\t\t\tfireDCM("src=8406727;type=wsft;cat=pdv_dgtl");\n\t\t\t$(document).on(\'mousedown\',\'button#buttons_AddToCartButton,button:contains("Buy"),a:contains("Buy"), button[id*="RedeemCodeButton"]\',\'\', function() {\n\t\t\t\t//console.log("AddToCart"); //WindowsSoftware_GBL_CartVue_Count_DigitalStore\n\t\t\t\tfireDCM("src=8406727;type=wsft;cat=crtd_std");\n\t\t\t});\n\t\t}\n\t}\n\n\n\t// Surface Configure Device tag as Surface Learn More  (request from Ahmed Homsi)\n\tif (~window.location.pathname.toLowerCase().indexOf("surface") && ~window.location.pathname.toLowerCase().indexOf("/d/")) {\n\n\t\tconfigdeviceurl = "https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=lrn_std;u1="\n\t\t\t+_TMDL.geo\n\t\t\t+";u2="+_TMDL.ll\n\t\t\t+";u6="+encodeURIComponent(_TMDL.pagename)\n\t\t\t+";u25="+_TMDL.pids[0]\n\t\t\t+";u26="+encodeURIComponent(_TMDL.pnames[0])\n\t\t\t+";u50=Configure%20now"\n\t\t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="\t+ a + "?";\n\t\timgsrc = configdeviceurl;\n\n\t\t// Configure Now CTA\n\t\t$(document).on(\'mousedown\',\'a:contains("Configure now"),button:contains("Configure now")\',\'\', function() {\n\t\t\tBootstrapper.imageRequest(configdeviceurl);\n\t\t});\n      \n      \tbuildyourbundleurl = "https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=lrn_std;u1="\n    \t\t+_TMDL.geo\n    \t\t+";u2="+_TMDL.ll\n    \t\t+";u6="+encodeURIComponent(_TMDL.pagename)\n    \t\t+";u25="+_TMDL.pids[0]\n    \t\t+";u26="+encodeURIComponent(_TMDL.pnames[0])\n    \t\t+";u50=BuildYourBundle"\n    \t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="\t+ a + "?";\n\n\n    \t// BuildYourBundle CTA\n        $(document).on(\'mousedown\',\'a:contains("Build your bundle"),button:contains("Build your bundle"),a[href*="/store/build/"]\',\'\', function() {\n    \t\tBootstrapper.imageRequest(buildyourbundleurl);\n    \t});\n      \n\t// Shop Now CTA from PDP (Surface_GBL_PchNow_Count_)  (src=8400690;type=surf;cat=pchn_std;)  added 5/6/19, modified 12/319 for exclusions\n\t$(document).on(\'mousedown\',\'div.pi-promotion-bar a\',\'\', function() {\n\t\tvar inScope=1;\n\t\ttry {\n\t\t\tif (~this.href.indexOf("/build/") || ~this.href.indexOf("student-discounts?successurl")) {\n\t\t\t\t_satellite.logger.log("out of scope");\n\t\t\t\tinScope=0;\n\t\t\t}\n\t\t} catch(shperr) {_satellite.logger.log("shopnow err");}\n\n\t\tif (inScope) { \n\t\t\tBootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="\n\t\t\t+_TMDL.geo\n\t\t\t+";u2="+_TMDL.ll\n\t\t\t+";u6="+encodeURIComponent(_TMDL.pagename)\n\t\t\t+";u25="+_TMDL.pids[0]\n\t\t\t+";u26="+encodeURIComponent(_TMDL.pnames[0])\n\t\t\t+";u50=ShopNow"\n\t\t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="\t+ a + "?");\n\t\t}\n\t});\n\n        // added 12/2/19 to add in shop for business in non-promobar area\t\n        $(document).on(\'mousedown\',\'div.store-finance-offer a\',\'\', function() {\n                Bootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="\n                +_TMDL.geo\n                +";u2="+_TMDL.ll\n                +";u6="+encodeURIComponent(_TMDL.pagename)\n                +";u25="+_TMDL.pids[0]\n                +";u26="+encodeURIComponent(_TMDL.pnames[0])\n                +";u50=BusinessOffer"\n                +";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="\t+ a + "?");\n        });\n      \n        // check your eligibility CTA\n      \tcheckeligibilityurl = "https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=lrn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]\t+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=CheckYourEligibility;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="+a+"?";\n        $(document).on(\'mousedown\',"a[href*=\'student-discounts?successurl\']",\'\', function() {\n            Bootstrapper.imageRequest(checkeligibilityurl);\n        });\n      \n      \t// added 11/26/19\n\t\n        addtocarturl = "https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=AddToCartClick"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="+ a + "?";\n\n        $(document).on(\'mousedown\',\'a:contains("Add to cart"),button:contains("Add to cart")\',\'\', function() {\n            Bootstrapper.imageRequest(addtocarturl);\n        });\t\n\t}\n}\ncatch(err)\n{\n\t_satellite.logger.error("DCM LP");\n}',language:"javascript"}}]},{id:"RL68ed140e62e94d2db9455a01d87bffcf",name:"OffTryCV",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'/*\nOfficeTrialCompletionPixels\n*/\ntry\n{\n\tvar inScope=0;\n\n\tvar MSFPC="";  \n\n\tvar skulist = {\n\t\t"cfq7ttc0k5bc-0003" : 1,\n\t\t"cfq7ttc0k5dm-007n" : 1,\n\t\t"cfq7ttc0k5dm-007q" : 1,\n\t\t"cfq7ttc0k5dm-007s" : 1,\n\t\t"cfq7ttc0k5dm-00hq" : 1,\n\t\t"cfq7ttc0k5dm-00hr" : 1\n\t};\n\n\tfor (var j = 0; j < _TMDL.pidsku.length; j++) {\n\t\tif (skulist[_TMDL.pidsku[j].toLowerCase()]==1) {\n\t\t\tinScope=1;\n\t\t}\n\t}\n\n\tif (inScope) {\n\t\tBootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8406097;type=ofco;cat=tsu_uni;u17=OfficeConsumerTrial;u59=" + MSFPC + ";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1;num=" + Math.random());\n\t\t//MediaMath\n\t\tBootstrapper.imageRequest("https://pixel.mathtag.com/event/img?mt_id=1259909&mt_adid=166372&product_name=Office365HomeTrial&s26=Office365HomeTrial&v1=OfficeConsTrial");\n\t\t//Quantcast\n\t\tBootstrapper.imageRequest("https://pixel.quantserve.com/pixel/p-tTB93UFC5vepM.gif?labels=_fp.event.OfficeConsTrial,_fp.productname.Office365HomeTrial");\n\t\t//Bidtellect\n\t\tBootstrapper.imageRequest("https://bttrack.com/pixel/uconversion/2682");\n\t\t//Facebook\n\t\tBootstrapper.imageRequest("https://www.facebook.com/tr?id=535974873423448&ev=Lead&noscript=1");\n\t\t//Amobee\n\t\tBootstrapper.imageRequest("https://d.turn.com/r/dd/id/L21rdC84ODQvY2lkLzE3NDc0Nzk4MzYvdC8y/kv/orderid=[ORDER_ID],product=Office365HomeTrial,conversio=OfficeConsTrial,offerid=cfq7ttc0k5dm-007n");\n\t\tBootstrapper.imageRequest("https://r.turn.com/r/beacon?b2=UQ33J2E3GCSx7-KKGp5vpXBNpsaOMjkmcU2_M7zYy7_ou6cxrU_k3avmwgRgF-V19uqO5Y8wqz4CcEqYo96czw&cid=&bprice=");\n\t\t//MediaIQ\n\t\tBootstrapper.imageRequest("https://secure.adnxs.com/px?id=930630&seg=10824846&redir=https%3A%2F%2Fsecure.adnxs.com%2Fgetuid%3Fhttps%3A%2F%2Fpixel.mediaiqdigital.com%2Fpixel%3Fu1%3DOfficeConsTrial%26pixel_id%3D930630%26uid%3D%24UID&t=2");\n\t\t//AMO\n\t\tBootstrapper.imageRequest("https://pixel.everesttech.net/px2/4249?px_evt=t&ev_officetrial=1");\n\t}\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== "undefined") {_TMutils.logRuleCall("OffTryCV",err.message,err.stack);}\n\t_satellite.logger.error("OffTryCV");\t\n}',language:"javascript"}}]},{id:"RLe377a68ea5f544699a1d32b4a92b2986",name:"Media_/en-au/store/b/surfaceforbusiness Tax Day",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-au/store/b/surfaceforbusiness",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'\ntry\n{\n\njQuery("div.m-content-placement:Lt(1)").on("mousedown", function(){  \nvar image = new Image(1, 1);\nimage.src ="https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u50=CTA;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;ord=1?";\n\n});\n\n}\ncatch(err)\n{\n\t_satellite.logger.error("Media_/en-au/store/b/surfaceforbusiness Tax Day");\n}\n\n',language:"javascript"}}]},{id:"RLc0091ae7ec8549d2947cec9fe6d70168",name:"Media_/en-us/ TikTok Purchase",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/(en-us|en-gb|fr-fr|de-de)",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n!function (w, d, t) {\n  w.TiktokAnalyticsObject=t;var ttq=w[t]=w[t]||[];ttq.methods=["page","track","identify","instances","debug","on","off","once","ready","alias","group","enableCookie","disableCookie"],ttq.setAndDefer=function(t,e){t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}};for(var i=0;i<ttq.methods.length;i++)ttq.setAndDefer(ttq,ttq.methods[i]);ttq.instance=function(t){for(var e=ttq._i[t]||[],n=0;n<ttq.methods.length;n++)ttq.setAndDefer(e,ttq.methods[n]);return e},ttq.load=function(e,n){var i="https://analytics.tiktok.com/i18n/pixel/events.js";ttq._i=ttq._i||{},ttq._i[e]=[],ttq._i[e]._u=i,ttq._t=ttq._t||{},ttq._t[e]=+new Date,ttq._o=ttq._o||{},ttq._o[e]=n||{};var o=document.createElement("script");o.type="text/javascript",o.async=!0,o.src=i+"?sdkid="+e+"&lib="+t;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(o,a)};\n\n//part2\n  ttq.load(\'C5S71GC247CAE4T3VM1G\');\n  ttq.track(\'CompletePayment\');\n}(window, document, \'ttq\');\n\n}\ncatch(err)\n{\n\t_satellite.logger.error("TikTok Purchase");\n}\n\n',language:"javascript"}}]},{id:"RL35bc6edf5aa447988a79b35b44fb6815",name:"GBLDL",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:-80}],conditions:[],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{
source:'try\n{\n\tvar _TMDL = {\n\t\tbusgrp : [], \n\t\tcc : "Unknown",\n\t\tisprod : false,\n\t\tgeo : "",\n\t\thost : window.location.hostname.toLowerCase(),\n\t\titemprices : [],\n\t\tlineItems : [],\n\t\tll : "other",\n\t\tmuid : "",\n\t\tpagename : "other",\n\t\tpageName : "other",\n\t\tpageType : "other",\n\t\tpath : window.location.pathname.toLowerCase(),\n\t\tpids : [],\n\t\tpidsku : [],\n\t\tpnames : [],  \n\t\tprdCt : [],  \n\t\tprdFam : [],\n\t\tprdPrCat : [],  \n\t\tprdSecCat : [],  \n\t\tprdSubCat : [],  \n\t\tprdType : [],\n\t\tpT : "",\n\t\tpurchaseID : "",\n\t\tquantities : [],\n\t\treflc : "",\n\t\trevsumdiv : [],\n\t\tsales : [],\n\t\tskus : [],\n\t\ttotamount : 0,\n\t\ttotqty : 0,\n\t\tlogRuleCall : function (r,d,i) {\n\t\t\tif (typeof _TMutils ===\'object\') {\n\t\t\t_TMutils.logRuleCall(r,d,i);\n\t\t\t} else {\n\t\t\t\ttry {\n\t\t\t\t\t_satellite.logger.error("error in logging and no _satellite obj");\n\t\t\t\t} catch(_saterr) {}\n\t\t\t}\n\t\t},\n\t\tgetQSParam : function(arr,param2find) {\n\t\t\tvar n, \n\t\t\t\ti=0, \n\t\t\t\tj=arr.length, \n\t\t\t\tnvpair=[];\n\t\t\tfor (i=0; i < j; i++) {\n\t\t\t\tnvpair = arr[i].split("=");\n\t\t\t\tif (nvpair[0].toLowerCase()==param2find.toLowerCase() && nvpair[1]) { \n\t\t\t\t\treturn nvpair[1];\n\t\t\t\t} \n\t\t\t}\n\t\t\treturn "";\n\t\t},\n\t\treadCookie : function(name) {\n\t\t\tvar nameEQ = name + "=";\n\t\t\tvar ca = document.cookie.split(\';\');\n\t\t\tfor(var i=0;i < ca.length;i++) {\n\t\t\t\tvar c = ca[i];\n\t\t\t\twhile (c.charAt(0)==\' \') c = c.substring(1,c.length);\n\t\t\t\tif (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\t\tcreateCookie : function(name,value,days) {\n\t\t\tvar expires = "";\n\t\t\tvar date;\n\t\t\tvar domainstr = (~window.location.host.indexOf("microsoft.com")) ? "; domain=.microsoft.com; path=/; " : "; path=/; ";\n\t\t\tif (days) {\n\t\t\t\tdate = new Date();\n\t\t\t\tdate.setTime(date.getTime()+(days*24*60*60*1000));\n\t\t\t\texpires = "; expires="+date.toGMTString();\n\t\t\t}\n\t\t\tdocument.cookie = name+"="+value+expires+domainstr;\n\t\t}\n\t};\n\n\tvar qs="",\n\t\tqsdecoded="",\n\t\tqs2="",\n\t\tqsarr=[],\n\t\tjsonstr="",\n\t\tjsonobj={},\n\t\tjsonstr,\n\t\tpt,\n\t\tpc,\n\t\tptlower,\n\t\t_pagetypemap = {}\n\t;\n\n\tif (document.referrer) {\n\t\treflc = document.referrer.toLowerCase();\n\t}\n\n\tqs = (window.location.search) ? window.location.search : "";\n\tif (qs.indexOf("?n=ensighten.html?")==0) {\n\t\tqs = qs.substring(17);\n\t}\n\tif (qs.indexOf("?")==0) {\n\t\tqs = qs.substring(1);\n\t}\n\tqs = qs.replace(/%20&%20/g,"%20%26%20");\n\tqs = qs.replace(/ & /g,"%20%26%20");\n\tqsarr=qs.split("&");\n\n\n\tif (~window.location.host.indexOf("compass-ssl.xboxlive.com") || ~window.location.host.indexOf("query.prod.cms.rt.microsoft.com")) {\n\t\t// top level params from iframe:  pN=cart&cl=en-US&market=US\n\t\t_TMDL.purchaseID = _TMDL.getQSParam(qsarr,"orderId") || _TMDL.getQSParam(qsarr,"id");\n\t\t_TMDL.muid = _TMDL.getQSParam(qsarr,"muid");\n\t\t_TMDL.pageName = _TMDL.getQSParam(qsarr,"pN");\n\t\t_TMDL.pageType = _TMDL.pageName;\n\t\t_TMDL.geo = _TMDL.getQSParam(qsarr,"market");\n\t\t_TMDL.ll = _TMDL.getQSParam(qsarr,"culture") || _TMDL.getQSParam(qsarr,"cl");\n\t\t_TMDL.totamount = _TMDL.getQSParam(qsarr,"totAmtWoTx");\n\t\tjsonstr = _TMDL.getQSParam(qsarr,"orderLineItems");\n\t\tif (~reflc.indexOf("www.microsoft.com") && window.navigator.userAgent.toLowerCase().indexOf("soasta")<0) { _TMDL.isprod=true;}\n\t\tif (!jsonstr) {\n\t\t\t_TMDL.logRuleCall("orderLineItems json missing");  \n\t\t} else {\t\n\t\t\ttry {\n\t\t\t\t\tif (jsonstr.indexOf("[")>-1) {\n\t\t\t\t\t\tjsonstr = jsonstr.replace(/%22%20Dis/g,\'%20Dis\');\n\t\t\t\t\t\tjsonstr = jsonstr.replace(/portable%2013%22%20/g,\'portable%2013%20\');\n\t\t\t\t\t\tjsonstr = jsonstr.replace(/%22%204K/g,\'%204K\');\n\t\t\t\t\t\tjsonstr = jsonstr.replace(/%22Samsung%2049%22%20/g,\'%22Samsung%2049%20\');\n\t\t\t\t\t\tjsonstr = jsonstr.replace(/%22%2F/g,\'%2F\');\n\t\t\t\t\t\tjsonstr = jsonstr.replace(/5%22%20%2F/g,\'5%2F\');\n\t\t\t\t\t\tjsonstr = jsonstr.replace(/%223%2F4%22%20/g,\'%223%2F4%20\');  \n\t\t\t\t\t\tjsonstr = jsonstr.replace(/15.6%22%20/g,\'15.6%20\');\t\n\t\t\t\t\t\tjsonstr = jsonstr.replace(/%22/g,\'"\');\t\n\t\t\t\t\t\t_TMDL.lineItems = JSON.parse(jsonstr);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tjsonstr = jsonstr.replace(/%22%20Dis/g,\'%20Dis\');\n\t\t\t\t\t\tjsonstr = jsonstr.replace(/portable%2013%22%20/g,\'portable%2013%20\');\n\t\t\t\t\t\tjsonstr = jsonstr.replace(/%22Samsung%2049%22%20/g,\'%22Samsung%2049%20\');\n\t\t\t\t\t\tjsonstr = jsonstr.replace(/%22%204K/g,\'%204K\');\n\t\t\t\t\t\tjsonstr = jsonstr.replace(/%22%2F/g,\'%2F\');\n\t\t\t\t\t\tjsonstr = jsonstr.replace(/5%22%20%2F/g,\'5%2F\');\n\t\t\t\t\t\tjsonstr = jsonstr.replace(/%223%2F4%22%20/g,\'%223%2F4%20\');  \t\n\t\t\t\t\t\tjsonstr = jsonstr.replace(/15.6%22%20/g,\'15.6%20\');\t\n\t\t\t\t\t\t_TMDL.lineItems = JSON.parse(decodeURIComponent(jsonstr));\n\t\t\t\t\t}\n          \t} catch(jsonparseerr) {_TMDL.logRuleCall("jsonparse error","jsonparse error",window.location.search); _satellite.logger.error("jsonparse error");\t}\n\t\t}\n\t} else if (typeof _pageBITags == "object") {\n\t\t// consume _pageBITags object from the non-iframe pages (e.g. OneRF)\n\t\tpt = _pageBITags.pageTags;\n\t\tptlower = pt.pageType.toLowerCase();\n\n\t\t_TMDL.pageName = pt.pageName;\n\t\t_TMDL.ll = pt.mkt;\n\t\t_TMDL.lang = pt.mkt.split("-")[0];\n\t\t_TMDL.geo = pt.mkt.split("-")[1];\n\t\t_TMDL.pageType = pt.pageType;\n\t\tif (~window.location.host.toLowerCase().indexOf("www.microsoft.com") && window.navigator.userAgent.toLowerCase().indexOf("soasta")<0) { _TMDL.isprod=true;}\n\t\t\n\t\ttry {\n\t\t\t_TMDL.muid = _TMDL.readCookie("MUID");\n\t\t} catch(muiderr) {_TMDL.logRuleCall("muid err");  }\n\t\t\n\t\tif (~ptlower.indexOf("category")) {\n\t\t\t// CATEGORY PAGE\n\t\t\t// https://onestore-ppe.microsoft.com/en-sg/store/b/surface?icid=CNavDevicesSurface&setswitch=optimizely_disabled%3A1%2Censighten_disabled%3D0\n\t\t\t\n\t\t} else if ((~ptlower.indexOf("pdp") || ~ptlower.indexOf("detail")) && (typeof _pageBITags == "object" && typeof _pageBITags.pageContracts == "object" && typeof _pageBITags.pageContracts.ProductInfo == "object")) {\n\t\t\t// PDP PAGE\n\t\t\tpc = _pageBITags.pageContracts.ProductInfo;\n\t\t\t_TMDL.pids.push(pc.id);\n\t\t\t_TMDL.skus.push(pc.sku);\n\t\t\t_TMDL.pidsku.push(pc.id+"-"+pc.sku);\n\t\t\t_TMDL.prdCt.push(pc.prdCt);\n\t\t\t_TMDL.prdPrCat.push(pc.priCat);\n\t\t\t_TMDL.prdSecCat.push(pc.prdSecCat);\n\t\t\t_TMDL.prdSubCat.push(pc.prdSubCat);\n\t\t\t_TMDL.prdType.push(pc.family);\n\t\t\t_TMDL.pnames.push(pc.title);\t\n\t\t\t_TMDL.cc = pc.cur;\n\t\t\t_TMDL.quantities.push(1);\n\t\t\t_TMDL.sales.push(_pageBITags.pageContracts.ProductInfo.rtPrice);\n\t\t\t_TMDL.quantities.push(1);\n\t\t\t_TMDL.itemprices.push(_TMDL.sales[0]);\n\t\t} else if ((~ptlower.indexOf("pdp") || ~ptlower.indexOf("detail")) && ~_TMDL.path.indexOf("/configure/")){\n            ptlower="configure";\n            _TMDL.pageType="configure";\n        }\n\t}\n\n\ttry {\n\t\t// remap pagetypes\n\t\t_pagetypemap = {\n\t\t\t// old : new\n\t\t\t"pdp" : "detail",\n\t\t\t"product details" : "detail",\n\t\t\t"sfw-pdp-pagetemplate" : "detail",\n\t\t\t"sfw-category-pagetemplate" : "category",\n\t\t\t"onestore-shoppingcart-template" : "cart",\n\t\t\t"congrats" : "receipt"\n\t\t};\n\n\t\tif (_pagetypemap[_TMDL.pageType.toLowerCase()]) {\n\t\t\t_TMDL.pageType = _pagetypemap[_TMDL.pageType.toLowerCase()];\n\t\t}\n\t\t\n\t\t_TMDL.pT=(_TMDL.pageType=="receipt")? "rP":_TMDL.pageType;\n\t\t\n\t\t// added 7/12/18 due to Convergence making category pagetype less reliable\n\t\tif (~window.location.pathname.indexOf("/b/") && window.location.pathname.indexOf("RETg7o")<0) {\n\t\t\t_TMDL.pageType="category";\n\t\t} \n\n\t} catch(err) {_TMDL.logRuleCall("pageTypeMapError",_TMDL.pageType);}\n\n\t//--------------------------------------------------------\n\t// create backwards compatible arrays from orderLineItems\n\t//--------------------------------------------------------\n\tvar temppname;\n\n\tfor (var i=0; i<_TMDL.lineItems.length;i++) {\n\t\ttemppname="";\n\t\t_TMDL.pids.push((_TMDL.lineItems[i].pId)?_TMDL.lineItems[i].pId:"");\n\t\t_TMDL.skus.push((_TMDL.lineItems[i].sku)?_TMDL.lineItems[i].sku:"");\n\t\ttry {\n\t\t\ttemppname = decodeURIComponent(_TMDL.lineItems[i].ti);\n\t\t} catch(pnameerr) {\n\t\t\ttemppname = (_TMDL.lineItems[i].ti) ? _TMDL.lineItems[i].ti:"" ;\n\t\t}\n\t\t_TMDL.pnames.push(temppname);  \n\n\t\t_TMDL.sales.push((_TMDL.lineItems[i].tot && typeof _TMDL.lineItems[i].txA !== \'undefined\' && typeof _TMDL.lineItems[i].q !== \'undefined\')? (_TMDL.lineItems[i].tot - (_TMDL.lineItems[i].q * _TMDL.lineItems[i].txA)) : _TMDL.lineItems[i].tot);\t\n\t\t_TMDL.prdPrCat.push((_TMDL.lineItems[i].pC)?_TMDL.lineItems[i].pC:"");\n\t\t_TMDL.prdFam.push((_TMDL.lineItems[i].pF)?_TMDL.lineItems[i].pF:"");\n\t\t_TMDL.prdType.push((_TMDL.lineItems[i].pT)?_TMDL.lineItems[i].pT:"");\n\t\t_TMDL.pidsku.push(_TMDL.pids[i]+"-"+_TMDL.skus[i]);\n\t\t_TMDL.quantities.push((_TMDL.lineItems[i].q) ? _TMDL.lineItems[i].q : 1);\n\t\t\n\t\tif (_TMDL.lineItems[i].cur) { \n\t\t\t_TMDL.cc = _TMDL.lineItems[i].cur;\n\t\t}\n\n\t\t_TMDL.totqty+=_TMDL.quantities[i];\n\t\t_TMDL.itemprices.push(_TMDL.sales[i]/_TMDL.quantities[i]);\n\t}\n\n\tvar missingCCpagetype="";\n\tif (_TMDL.cc=="Unknown" && ~window.location.host.indexOf("query.prod.cms.rt.microsoft.com") ) {\n\t\tmissingCCpagetype = (~window.location.href.indexOf("pN=congrats"))?"receipt" : "cart";\n        if (missingCCpagetype=="receipt") { _TMDL.logRuleCall("missingCC"+missingCCpagetype+"_"+_TMDL.geo,"missingCC"+"_"+_TMDL.geo,window.location.search); }\n\t}\n\n\tvar ccmap = {\n\t\t\'US\' : \'USD\',\n\t\t\'AU\' : \'AUD\',\n\t\t\'BR\' : \'BRL\',\n\t\t\'CA\' : \'CAD\',\n\t\t\'CH\' : \'CHF\',\n\t\t\'DK\' : \'DKK\',\n\t\t\'GB\' : \'GBP\',\n\t\t\'JP\' : \'JPY\',\n\t\t\'MX\' : \'MXN\',\n\t\t\'NO\' : \'NOK\',\n\t\t\'RU\' : \'RUB\',\n\t\t\'SE\' : \'SEK\',\t\n\t\t\'AT\' : \'EUR\',\t\n\t\t\'BE\' : \'EUR\',\t\n\t\t\'CY\' : \'EUR\',\t\n\t\t\'DE\' : \'EUR\',\t\n\t\t\'ES\' : \'EUR\',\t\n\t\t\'FI\' : \'EUR\',\n\t\t\'FR\' : \'EUR\',\t\n\t\t\'GR\' : \'EUR\',\n\t\t\'IR\' : \'EUR\',\n\t\t\'IT\' : \'EUR\',\t\n\t\t\'LU\' : \'EUR\',\n\t\t\'NL\' : \'EUR\',\t\n\t\t\'PT\' : \'EUR\',\n\t\t\'NEVERHIT\' : \'Unknown\'\n\t};\n\tif (_TMDL.cc=="Unknown" || _TMDL.cc=="") {\n\t\ttry {\n\t\t\tif (ccmap[_TMDL.geo.toUpperCase()]) {\n\t\t\t\t_TMDL.cc = ccmap[_TMDL.geo.toUpperCase()];\n\t\t\t}\n\t\t} catch(ccerr) {}\n\t} \n\tif (_TMDL.cc=="Unknown" && (window.location.href.indexOf(\'"EUR"\')>-1 || window.location.href.indexOf("%22EUR%22")>-1)) { \n\t\t_TMDL.cc="EUR"; \n\t}\n\n\t_TMDL.pagename = _TMDL.pageName; // backwards compatibility for some tags\n\n\t// make global for access in other tags\n\n\twindow._TMDL = window._TMDL || _TMDL;\n}\ncatch(err){console.log("DataLayer: "+err.message);}\n',language:"javascript"}}]},{id:"RLff01f3eef86c424db18d4d6e39bcb2ae",name:"Media_/LL-LL/ Xandr Purchase",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/dateRange.js",settings:{end:"2023-07-31T00:00:00Z",start:"2021-08-18T00:00:00Z"}},{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'// Xandr Purchase\ntry\n{\nvar LimitString = function (item, index, arr) {\narr[index] = item.substr(0,98)};\n_TMDL.pnames.forEach(LimitString);\nvar image = new Image(1, 1);\nimage.src ="https://ib.adnxs.com/pixie?pi=94211d4b-5aba-46aa-8d38-30818c4beba9&e=Purchase&ii="+_TMDL.pids+"&in="+_TMDL.pnames.toString().substr(0,1800)+","+_TMDL.geo+","+_TMDL.cc+"&itp="+_TMDL.prdType+"&va="+_TMDL.totamount+"&script=0";\n}\ncatch(err)\n{\n_satellite.logger.error("Media_/LL-LL/ Xandr Purchase");\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n',language:"javascript"}}]},{id:"RL64b67def4fa648f4b67cc6d001fac8f0",name:"XboxGrCPE_OneSCat",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:70}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"(us|ca|au|gb)\\/store\\/collections\\/xboxonesconsoles",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'var debug=0,fireDCM=1;\nvar ll=_TMDL.geo.toLowerCase();\n\nif (ll=="us" || ll=="ca" || ll=="gb" || ll=="au") {\n\ttry {\n\t\t$(document).on(\'mousedown\',\'div.m-channel-placement-item\',\'\', function() {\n\t\t\tif (debug) { \n\t\t\t\tconsole.log("Xbox One S consoles"); \n\t\t\t}\n\n\t\t\tvar j={},pid="",cN="",u="",hr="";\n\t\t\tvar\ta = "" + (Math.random() * 10000000000000);\n\n\t\t\ttry {\n\t\t\t\tj=JSON.parse($(this).attr("data-m"));\n\t\t\t\tpid = j.pid;\n\t\t\t\tcN= j.cN;\n\t\t\t\t//hr=this.href;\n\t\t\t} catch(proderr) {\n\t\t\t\tif (debug) { \n\t\t\t\t\tconsole.log("catch Xbox One S consoles "+hr); \n\t\t\t\t}\n\t\t\t}\n\n\t\t\tu="https://ad.doubleclick.net/ddm/activity/src=8391491;type=xbxp;cat=pchn_std;u1="\n\t\t\t+_TMDL.geo\n\t\t\t+";u2="+_TMDL.ll\n\t\t\t+";u6="+encodeURIComponent(window.location.pathname)\n\t\t\t+";u25="+pid\n\t\t\t+";u26="+encodeURIComponent(cN)\n\t\t\t+";u50="+encodeURIComponent(cN)\n\t\t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="\t+ a + "?";\n\n\t\t\tif (debug) { \n\t\t\t\tconsole.log("Xbox One S consoles: u25="+pid+" u26="+cN+"\\t"+u); \n\t\t\t}\n\n\t\t\tif (fireDCM) {\n\t\t\t\tBootstrapper.imageRequest(u);\n\t\t\t}\n\t\t});\n\t} catch(clkerr) {\n\t\tconsole.log("Xbox One S consoles");\n\t}\n}',language:"javascript"}}]},{id:"RL009343dd3b9f47f4b08f2029bb4787ad",name:"Surface-Consumer/Commercial Xandr Yahoo US",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-us/d/surface-laptop-studio-for-business",valueIsRegex:!0},{value:"/en-us/d/surface-pro-8-for-business",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/dateRange.js",settings:{end:"2022-07-01T00:00:00Z",start:"2021-12-30T00:00:00Z"}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"var debug = 0, fireTags = 1;\n\nfunction attachADNXSAnalyticsToElement(elementAddress) {\n\t$(document).on('mousedown', elementAddress, '', function () {\n\t\tvar rand = parseInt(Math.random() * 10000000000000);\n\t\tvar yahooURL = 'https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick';\n\t\tvar adobeURL = 'https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50188&ActionName=Store_Site_Visit&cachebuster=' + rand;\n\n\t\tif (debug) {\n\t\t\tconsole.log(\"tag has fired\");\n\t\t}\n\n\t\tif (fireTags) {\n\t\t\tBootstrapper.imageRequest(yahooURL);\n\t\t\tBootstrapper.imageRequest(adobeURL);\n\t\t}\n\t});\n}\n\ntry {\n\t// Configure\n\tif (~window.location.pathname.toLowerCase().indexOf(\"surface\") && ~window.location.pathname.toLowerCase().indexOf(\"/d/\")) {\n\t\t// Configure Now CTA\n\t\tattachADNXSAnalyticsToElement('button[id*=\"ConfigureDeviceButton\"]');\n\n\t\t// Business\t\n\t\tattachADNXSAnalyticsToElement('div.store-finance-offer a');\n\n\t\t// Eligibility\t\t\t\n\t\tattachADNXSAnalyticsToElement('a[href*=\"student-discounts?successurl\"]');\n\n\t\t// Cart\n\t\tattachADNXSAnalyticsToElement('button[id*=\"AddToCartButton\"]');\n\n\t\t// Shop Now CTA from PDP (Surface_GBL_PchNow_Count_)  eeeeee\n\t\t$(document).on('mousedown', 'div.pi-promotion-bar a', '', function () {\n\t\t\tvar inScope = 1;\n\n\t\t\ttry {\n\t\t\t\tif (~this.href.indexOf(\"/build/\") || ~this.href.indexOf(\"student-discounts?successurl\")) {\n\t\t\t\t\t_satellite.logger.log(\"out of scope\");\n\t\t\t\t\tinScope = 0;\n\t\t\t\t}\n\t\t\t} catch (shperr) { _satellite.logger.log(\"shopnow err\"); }\n\n\t\t\tif (inScope) {\n\t\t\t\tif (debug) {\n\t\t\t\t\tconsole.log('tag has fired');\n\t\t\t\t}\n\t\t\t\tvar rand = parseInt(Math.random() * 10000000000000);\n\t\t\t\tvar yahooURL = 'https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick';\n\t\t\t\tvar adobeURL = 'https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50188&ActionName=Store_Site_Visit&cachebuster=' + rand;\n\n\t\t\t\tBootstrapper.imageRequest(yahooURL);\n\t\t\t\tBootstrapper.imageRequest(adobeURL);\n\t\t\t} else {\n\t\t\t\tconsole.log('not in scope');\n\t\t\t}\n\t\t});\n\t}\n}\ncatch (clkerr) {\n\tconsole.log(\"Com/Con Surface Campaign\");\n}",language:"javascript"}}]},{id:"RL9092ef86ecbc48cebb72d1cd61b6a4f1",name:"Media.SurfaceDuo_CPE (AEM/RT)",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-us/surface/devices/surface-duo"},{value:"/en-us/surface/devices/surface-duo/"}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n//Note - This page belongs with the Surface property. Rule likely can be removed.\n  \n// ADNXS\n   //Main & Sticky Header\n  jQuery("a:contains(\'SHOP NOW\')").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "//secure.adnxs.com/px?id=1268102&t=2";\n});\n //Bottom of page - Removing as this is no longer on page\n /*\njQuery("a.c-call-to-action.c-glyph:eq(17)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "//secure.adnxs.com/px?id=1268102&t=2";\n});\n*/\n  \n\n//DoubleClick\n  //Main & Sticky Header\n jQuery("a:contains(\'SHOP NOW\')").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u50=PRE-ORDER"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=;gdpr_consent=${gdpr_consent_755};ord=1?";\n});\n  \n   \n //Bottom of page  Removing as this is no longer on page\n /*\njQuery("a.c-call-to-action.c-glyph:lt(17)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u50=PRE-ORDER"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=;gdpr_consent=${gdpr_consent_755};ord=1?";\n});\n*/\n  \n}\ncatch(err)\n{\n\t_satellite.logger.error("Media.SurfaceDuo_CPE (AEM/RT)");\n}\n',language:"javascript"}}]},{id:"RLdd9cb2d8786b4d0493ea469b80845b11",name:"Media_/en-gb/store/cart Twitter",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-gb/store/cart",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n//Page View  \nvar image = new Image(1, 1);\nimage.src ="https://analytics.twitter.com/i/adsct?p_id=Twitter&p_user_id=0&txn_id=nzzcs&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";\n  \nvar image2 = new Image(1, 1);\nimage2.src ="//t.co/i/adsct?p_id=Twitter&p_user_id=0&txn_id=nzzcs&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";  \n\n\n }\ncatch(err)\n{\n\t_satellite.logger.error("Media_/en-gb/store/cart Twitter");\n}\n',language:"javascript"}}]},{id:"RLd6c91861404c4f20956ca995bc63a602",name:"Media_/EN-US/Surface Adobe DCO (AEM/RT) ",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-us/p/surface",valueIsRegex:!0},{value:"/en-us/d/surface",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n// Configure Now buttons\njQuery("a:contains(\'Configure now\'),button:contains(\'Configure now\')").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50188&ActionName=Store_Site_Visit&cachebuster=<INSERT_RANDOM_NUMBER>";\n//console.log(\'tag fires\');\n});\n  \n//Check Your Eligibility button\n jQuery(\'a[href*="student-discounts?successurl"]\').on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50188&ActionName=Store_Site_Visit&cachebuster=<INSERT_RANDOM_NUMBER>";\n});\n  \n//Promotional Bar links\njQuery("a:contains(\'Book your online appointment\')").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50188&ActionName=Store_Site_Visit&cachebuster=<INSERT_RANDOM_NUMBER>";\n});\njQuery("a:contains(\'Build your bundle\')").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50188&ActionName=Store_Site_Visit&cachebuster=<INSERT_RANDOM_NUMBER>";\n});\njQuery("a:contains(\'Learn more about promise\')").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50188&ActionName=Store_Site_Visit&cachebuster=<INSERT_RANDOM_NUMBER>";\n});\n\njQuery("a[href*=\'/en-us/p/surface\']").filter(":contains(\'business\')").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50188&ActionName=Store_Site_Visit&cachebuster=<INSERT_RANDOM_NUMBER>";\n});\n  \n  \n }\ncatch(err)\n{\n\t_satellite.logger.error("Media_/LL-LL/Surface Adobe DCO (AEM/RT)");\n}\n',language:"javascript"}}]},{id:"RL591f593703cb481b8a8e6531e1c69d10",name:"FBCVF",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n\tvar marketMap = {\n\t\t"AT": "562684790554330",  \n\t\t"AU": "284489665351238", // iProspect\n\t\t"BE": "1441341485948213", // iProspect  (FR) \n\t\t"BR": "1351385668312384", // iProspect\n\t\t"CA": "822106911286239", // iProspect\n\t\t"CH": "1701617263415580",   \n\t\t"CN": "1675926909345981", \n\t\t"DE": "108292966463738",  // iProspect\n\t\t"DK": "254705608267657",  // iProspect\n\t\t"ES": "1626525834066953",  // iProspect\n\t\t"FI": "1719588481615214", \n\t\t"FR": "824192544408978", // iProspect\n\t\t"GB": "120587825211084", // iProspect\n\t\t"HK": "539267979583843", \n\t\t"IE": "249404655562787", // IProspect (added 9/13/17)\n\t\t"IN": "1974106256199230",  // (EN) iProspect\n\t\t"IR": "172987109739933",  \n\t\t"IT": "1598310580201695",  // iProspect\n\t\t"JP": "288860468248601", // iProspect\n\t\t"KR": "1413279412072377", // iProspect\n\t\t"MX": "113583175941450",  // iProspect\n\t\t"NL": "656219287899900", // iProspect\n\t\t"NO": "1675926909345981",  \n\t\t"NZ": "1925863447693257", // iProspect 9/13/17\n\t\t"PH" : "109126313071654", // iProspect  (NEW)\n\t\t"PT" : "1368140109922230",\n\t\t"RU": "514282922073511",  \n\t\t"SE": "1400129366740315", // iProspect\n\t\t"SG": "1240252356085595", // iProspect\n\t\t"TW": "266771177060777",  // iProspect\n\t\t"US": "141890703034968" // iProspect\n\t};\n\n\tvar llfbmap = {\n\t\t"fr-ca": "165913903949482",  \n\t\t"hi-in": "1419329368162069", \n\t\t"nl-be": "129122374248830", \n\t\t"de-ch": "1674321202841213", // iProspect\n\t\t"never": "1111111111111111"\n\t};\n\n\tvar feedID="";\n\tvar baseurl="",imgurl="";\n\tvar ts = new Date().valueOf();\n\tvar contentIDs="";\n\tvar i=0;\n\tvar pidstringarr=[];\n\tvar pnamearr=[];\n\n\ttry {\n\t\tif(_TMDL && marketMap[(_TMDL.geo).toUpperCase()] ){\n\t\t\tfeedID = marketMap[(_TMDL.geo).toUpperCase()].toLowerCase();\n\t\t}\n\t} catch(err) {}\n\n\ttry {\n\t\tif(_TMDL && llfbmap[(_TMDL.ll).toLowerCase()]){\n\t\t\tfeedID = llfbmap[(_TMDL.ll).toLowerCase()].toLowerCase();\n\t\t}\n\t} catch(llerr) {}\n\n\n\tif (_TMDL.cc=="Unknown" && _TMDL.geo=="US") {\n\t\t_TMDL.cc="USD";\n\t}\n\n\n\tfor (i=0; i<_TMDL.pidsku.length;i++){\n\t\tpidstringarr.push(\'"\'+_TMDL.pidsku[i]+\'"\');\n\t\tpnamearr.push(\'"\'+_TMDL.pnames[i]+\'"\');\n\t}\n\n\n\tif (feedID && _TMDL.isprod) {\n\t\tbaseurl = "https://www.facebook.com/tr?id="; \n\t\tif (_TMDL.pageType=="cart") {\n\t\t\timgurl = "&ev=AddToCart"+"&dpo=LDU&dpoco=0&dpost=0"\n\t\t\t\t+"&ts="+ts\n\t\t\t\t+"&cd[product_catalog_id]="+feedID\n\t\t\t\t+"&cd[content_ids]=["+encodeURIComponent(pidstringarr.join(",")) + "]"\n\t\t\t\t+"&cd[content_names]=["+encodeURIComponent(pnamearr.join(",")) + "]"\n\t\t\t\t+"&cd[content_type]=product";\n\n\t\t\t   \tBootstrapper.imageRequest(baseurl+"1770559986549030"+imgurl);\n\t\n\t\t} else if (_TMDL.pageType=="receipt") {\t\n\t\t\timgurl = "&ev=Purchase"+"&dpo=LDU&dpoco=0&dpost=0"\n\t\t\t\t+"&ts="+ts\n\t\t\t\t+"&cd[currency]="+_TMDL.cc\n\t\t\t\t+"&cd[value]="+_TMDL.totamount\n\t\t\t\t+"&cd[product_catalog_id]="+feedID\n\t\t\t\t+"&cd[content_ids]=["+encodeURIComponent(pidstringarr.join(",")) + "]"\n\t\t\t\t+"&cd[content_names]=["+encodeURIComponent(pnamearr.join(",")) + "]"\n\t\t\t\t+"&cd[content_type]=product"\n\t\t\t\t+"&cd[order_id]="+_TMDL.purchaseID;\n\n\t\t\t          \tBootstrapper.imageRequest(baseurl+"1770559986549030"+imgurl);\n          \n\t\t\tif (_TMDL.geo.toLowerCase()=="sg") {\n\t\t\t\t// SG CMO pixel\n\t\t\t\tBootstrapper.imageRequest("https://www.facebook.com/tr?id=1264846640217138&ev=PageView&noscript=1");\n\t\t\t\tBootstrapper.imageRequest(baseurl+"1264846640217138"+imgurl);\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\tif (_TMDL.geo.toLowerCase()=="gb") {\n\t\t\t\tBootstrapper.imageRequest(baseurl+"1093198564158197"+imgurl);\t\n\t\t\t}\n\n\t\t}\n\t}\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== "undefined") {_TMutils.logRuleCall("FB CVF",err.message,imgurl);}\n\t_satellite.logger.error("FB CVF");\t\n}\n\n\n\n\n\n\n\n',language:"javascript"}}]},{id:"RL4bdf667038384adf9295cffa45ec5c85",name:"Media_/en-gb/Small Business LinkedIn",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-gb/store/b/microsoft-small-business",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"linkedin/src/lib/actions/loadInsightTag.js",settings:{}}]},{id:"RL5495657f599a44fb901e913901431d97",name:"ADHOCCVF",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'/*\nADHOC CVF\n*/\ntry\n{\n\tvar geolc=_TMDL.geo.toLowerCase();\n\tvar adobedsp="";\n\tvar imgsrc="";\n\n\tif (_TMDL.isprod && _TMDL.pT=="rP")\n\t{\n\n\t\t// uses approach 2:  single pixel, concatenating the product IDs (rather than sending a separate pixel for each line\n\t\t// DE, FR, GB, US\n\t\tif (geolc=="de" || geolc=="fr" || geolc=="gb" || geolc=="us") {\n\t\t\tadobedsp="https://pixel.everesttech.net/px2/5584?px_evt=t&ev_"+_TMDL.pidsku.join("_")+"_count="+_TMDL.totqty\n\t\t\t\t+"&ev_"+_TMDL.pidsku.join("_")+"_revenue="+_TMDL.totamount\n\t\t\t\t+"&ev_transid="+_TMDL.purchaseID;\n\t\t\timgsrc=adobedsp;\n\t\t\tBootstrapper.imageRequest(adobedsp);\n\t\t}\n\t}\n\n\tvar twmarketMap = {\n\t"BE" : "o173t",\n\t"DK" : "nznex",\n\t"FI" : "nznez",\n\t"NO" : "nznf1",\n\t"SE" : "nznf3",\n\t"IT" : "o0287",\n\t"ES" : "o028a",\n\t"PT" : "o0289",\n\t"NL" : "nvq0j",\n\t"LU" : "o18ai"\n\t};\n\tvar twtagID="",twimg1="",twimg2="";\n\n\tif(_TMDL && twmarketMap[_TMDL.geo.toUpperCase()] ){twtagID = twmarketMap[_TMDL.geo.toUpperCase()];}\n\t\n\tif (twtagID && _TMDL.isprod && _TMDL.pT=="rp") \n\t{\n\t\ttwimg1 = "https://analytics.twitter.com/i/adsct?txn_id="+tagID+"&p_id=Twitter&tw_sale_amount="+_TMDL.totamount+"&tw_order_quantity=1";\n\t\ttwimg2 = "//t.co/i/adsct?txn_id="+tagID+"&p_id=Twitter&tw_sale_amount="+_TMDL.totamount+"&tw_order_quantity=1";\n\t\timgsrc=twimg1;\n\t\tBootstrapper.imageRequest(img1);\n\t\timgsrc=twimg2;\n\t\tBootstrapper.imageRequest(img2);\t\n\t}\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== "undefined") {_TMutils.logRuleCall("ADHOC CVF",err.message,imgsrc);}\n\t_satellite.logger.error("ADHOC CVF");\n}\n\n',language:"javascript"}}]},{id:"RLab2298c7467f48a6ad45da5d885a3a2d",name:"AUSurfSMB",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:70}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return~window.location.href.toLowerCase().indexOf("www.microsoft.com/en-au/p/surface-pro-6-for-business-choice-of-accessory/8p88kcx6r5s7")||~window.location.href.toLowerCase().indexOf("www.microsoft.com/en-au/d/surface-pro-6-for-business-choice-of-accessory/8p88kcx6r5s7")||~window.location.href.toLowerCase().indexOf("www.microsoft.com/en-au/p/surface-book-2-for-business-choice-of-accessory/8pcw0wkflz2x")||~window.location.href.toLowerCase().indexOf("www.microsoft.com/en-au/d/surface-book-2-for-business-choice-of-accessory/8pcw0wkflz2x")||~window.location.href.toLowerCase().indexOf("www.microsoft.com/en-au/store/b/business")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'/*  AU Surface SMB \n\nCampaign:  AU Surface SMB\nContact: Lauren Ward @ Carat\nTags:  Outbrain, DV360\n*/\n\n// Landing Page Tags\n\n// DV360 Activity Name: Microsoft_LP_landing page\nvar\ta = "" + (Math.random() * 10000000000000);\nBootstrapper.imageRequest(\'https://ad.doubleclick.net/ddm/activity/src=6487971;type=invmedia;cat=micro00;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;ord=\' + a + \'?\');\n// Appnexus Microsoft_LP_landing page\nBootstrapper.imageRequest("https://secure.adnxs.com/px?id=1120808&seg=18111539&t=2");\n\n\n$(document).on(\'mousedown\',\'button[id*="buttons_BuildABundleButton"]\',\'\', function() {\n\t// Outbrain\n\tBootstrapper.imageRequest("https://tr.outbrain.com/pixel?marketerId=00fbc5a6837b6c040daa1e33bdf0cadcaa&name=lead");\n\t// DV360 Activity Name:  Microsoft_Int_button click\n\tBootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=6487971;type=invmedia;cat=micro000;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;ord=1?");\n\t// Appnexus Microsoft_Int_button click\n\tBootstrapper.imageRequest("https://secure.adnxs.com/px?id=1120809&seg=18111541&t=2");\n});\n',language:"javascript"}}]},{id:"RL78c9bc5a0724444cba047576c8920ec0",name:"Surface-Commercial/Consumer Campaign Yahoo ROW",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"(/ja-jp|/en-ca|/fr-ca|/de-de|/en-au|/en-gb|/fr-fr|/en-sg)/d/surface-laptop-studio",valueIsRegex:!0},{value:"(/ja-jp|/en-ca|/fr-ca|/de-at|/en-au|/en-gb|/fr-fr|/en-sg)/d/surface-pro-8",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}},{modulePath:"core/src/lib/conditions/dateRange.js",settings:{end:"2022-07-01T00:00:00Z",start:"2021-12-29T00:00:00Z"}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{
source:'// JavaScript source code\n// Consumer and commercial campaign tagging\n\ntry {\n\t// Configure Now buttons\n\tjQuery("button[id*=\'ConfigureDeviceButton\']").on("mousedown", function () {\n\t\tvar image = new Image(1, 1);\n\t\timage.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick";\n\t});\n\n\t//Check Your Eligibility button\n\tjQuery(\'a[href*="student-discounts?successurl"]\').on("mousedown", function () {\n\t\tvar image = new Image(1, 1);\n\t\timage.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick";\n\t});\n\n\t//Promotional Bar links\n\tjQuery("div.pi-promotion-bar").on("mousedown", function () {\n\t\tvar image = new Image(1, 1);\n\t\timage.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick";\n\t});\n\n}\ncatch (err) {\n\t_satellite.logger.error("Media.Verizon.Commercial/ConsumerCampaign/LL-LL");\n}\n',language:"javascript"}}]},{id:"RLed84364171ac4f6ead603906b1ff971f",name:"GBLCV",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'/* GBL CV\n\nAmnet Oath\nAOL\nBidTellect\nHCode\nMediaIQ\nMediaMath\ntaboola_url\nQuantcast \n\n*/\n\ntry\n{\n\tvar \n\thcode_u="",\n\tmediaIQ_imgurl="",\n\tmediamath_url="",\n\tamnetOath="",\n\ttaboola_url="",\n\toathdot="",\n\tquantcast="",\n\tdbugimgurl=""\n\t;\n\n\tif (_TMDL.isprod && _TMDL.pT=="rP")\n\t{\n\n\t\tdbugimgurl="BidTellect";\n\t\tBootstrapper.imageRequest("https://bttrack.com/pixel/uconversion/2682");\n\n\t\t// --------------------------------------------------------------------------------\n\t\t// HCode, from Carat (Robert Jordan), potentially decommissionable end of Q3FY19\n\t\t// --------------------------------------------------------------------------------\n\n\t\thcode_u="https://api.retargetly.com/track?t=eBWRHK&r_type=consumer"\n\t\t+"&r_market="+_TMDL.geo\n\t\t+"&r_product="+encodeURIComponent(_TMDL.pnames.join("_"))\n\t\t+"&r_currency="+_TMDL.cc\n\t\t+"&r_SKU="+_TMDL.pidsku.join("_")\n\t\t+"&r_irderid="+_TMDL.purchaseID\n\t\t+"&r_units="+_TMDL.quantities.join("_")\n\t\t+"&r-seats="+_TMDL.sales.join("_")\n\t\t+"&r_quanity="+_TMDL.quantities.join("_");\n\t\t\n\t\tdbugimgurl=hcode_u;\n\t\tBootstrapper.imageRequest(hcode_u);\n\n\t\t/*\n\t\tMedia IQ Appnexus \n\t\t*/\n\n\t\tmediaIQ_imgurl = "https://secure.adnxs.com/px?id=929469&seg=10765629&redir=https%3A%2F%2Fsecure.adnxs.com%2Fgetuid%3Fhttps%3A%2F%2Fpixel.mediaiqdigital.com%2Fpixel%3Fu1%3DConsPurchase%26u2%3D"\n\t\t+_TMDL.ll\n\t\t+"%26u3%3D"+_TMDL.ll.split("-")[1]\n\t\t+"%26u6%3D"+"thankyoupage"\n\t\t+"%26u20%3D"+_TMDL.pidsku.join("_")\n\t\t+"%26u26%3D"+encodeURIComponent(_TMDL.pnames.join("_"))\n\t\t+"%26u31%3D"+_TMDL.cc\n\t\t+"%26u34%3D"+_TMDL.purchaseID\n\t\t+"%26u35%3D"+_TMDL.totqty\n\t\t+"%26u39%3D"+_TMDL.sales.join("_")\n\t\t+"%26u40%3D"+_TMDL.quantities.join("_")\n\t\t+"%26pixel_id%3D929469%26uid%3D%24UID&t=2";\n\n\t\tdbugimgurl=mediaIQ_imgurl;\n\t\tBootstrapper.imageRequest(mediaIQ_imgurl);\n\n\t\t//-----------\n\t\t// MediaMath\n\t\t//-----------\n\n\n\t\tmediamath_url="https://pixel.mathtag.com/event/img?mt_id=1259909&mt_adid=166372"\n\t\t\t+"&site_language="+_TMDL.ll\n\t\t\t+"&page_name=thankyou"\n\t\t\t+"&product_name="+encodeURIComponent(_TMDL.pnames.join("_"))\n\t\t\t+"&currency_code="+_TMDL.cc\n\t\t\t+"&total_units="+_TMDL.totqty\n\t\t\t+"&s2="+_TMDL.ll\n\t\t\t+"&s3="+_TMDL.geo\n\t\t\t+"&s6=thankyou"\n\t\t\t+"&s20="+_TMDL.pidsku.join("_")\n\t\t\t+"&s26="+encodeURIComponent(_TMDL.pnames.join("_"))\n\t\t\t+"&s31="+_TMDL.cc\n\t\t\t+"&s34="+_TMDL.purchaseID\n\t\t\t+"&s35="+_TMDL.totqty\n\t\t\t+"&s39="+_TMDL.sales.join("_")\n\t\t\t+"&s40="+_TMDL.quantities.join("_")\n\t\t\t+"&v1=ConsPurchase&v5="+_TMDL.pidsku.join("_")+"&v11="+_TMDL.geo\n\t\t\t;\n\n\t\tdbugimgurl=mediamath_url;\n\t\tBootstrapper.imageRequest(mediamath_url);\n\t\n\t\t//---------------------\t\n\t\t// Oath Dot \n\t\t//---------------------\t\n\n\t\toathdot = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=ConsPurchase&qua="+_TMDL.totqty+"&off="+_TMDL.pidsku.join("|");\n\t\tdbugimgurl=oathdot;\n\t\tBootstrapper.imageRequest(oathdot);\n\n\t\t//-----------------------------------\n\t\t// Quantcast\n\t\t//    similar tags on other pages\n\t\t//-----------------------------------\n\n\t\tquantcast = "https://pixel.quantserve.com/pixel/p-tTB93UFC5vepM.gif?labels=_fp.channel."+_TMDL.geo+",_fp.event.receipt,_fp.subchannel."+_TMDL.totqty+",_fp.customer."+_TMDL.ll+",_fp.pcat."+_TMDL.pidsku.join(",")+"&orderid="+_TMDL.purchaseID+"&revenue="+_TMDL.totamount;\n\t\t\n\t\tdbugimgurl=quantcast;\n\t\tBootstrapper.imageRequest(quantcast);\n\n\t\t//------------------------------------------\t\n\t\t// Taboola for Office Direct\n\t\t//------------------------------------------\t\n\n\t\ttaboola_url="//trc.taboola.com/globalpixelhome/log/3/action?name=microsoft_global&item-url="+_TMDL.pidsku.join("_");\n\t\tdbugimgurl=taboola_url;\n\t\tBootstrapper.imageRequest(taboola_url);\n\t}\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== "undefined") {_TMutils.logRuleCall("GBLCV",err.message,dbugimgurl);}\n\t_satellite.logger.error("GBLCV");\t\n}',language:"javascript"}}]},{id:"RL242b795b9ca24d7e8b30d2e03397dae7",name:"AmplifySurfaceCategory",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"https://www.microsoft.com/en-us/surface",valueIsRegex:!1}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'// JavaScript source code\nvar productClicks = \'a[href*="https://www.microsoft.com/en-us/d/surface"]:not(.c-call-to-action)\';\nvar categoryClicks = \'a[href*="https://www.microsoft.com/en-us/surface/devices/"]\';\nvar surfaceDeals = \'a[href*="https://www.microsoft.com/en-us/store/b/surface-deals"]\';\nvar buyNow = \'a[data-bi-name="buy now"]\';\n\nfunction attachPixels(elementAddress) {\n    $(document).on(\'mousedown\', elementAddress, \'\', function () {\n        var name = $(this).attr("data-bi-name");\n        window.uetq_Amplify = window.uetq_Amplify || [];\n        window.uetq_Amplify.push(\'event\', \'click\', { \'event_label\': name });\n\t});\n}\n\ntry {\n    (function (w, d, t, r, u) {\n        var f, n, i; w[u] = w[u] || [], f = function () {\n            var o = { ti: "149014572" }; o.q = w[u], w[u] = new UET(o), w[u].push("pageLoad")\n        },\n            n = d.createElement(t), n.src = r, n.async = 1,\n            n.onload = n.onreadystatechange = function () {\n                var s = this.readyState; s && s !== "loaded" && s !== "complete" || (f(), n.onload = n.onreadystatechange = null)\n            }, i = d.getElementsByTagName(t)[0], i.parentNode.insertBefore(n, i)\n    })(window, document, "script", "//bat.bing.com/bat.js", "uetq_Amplify");\n\n    attachPixels(productClicks);\n    attachPixels(categoryClicks);\n    attachPixels(surfaceDeals);\n    attachPixels(buyNow);\n}\ncatch (err) {\n    _satellite.logger.error("Amplify Surface Category Test");\n}',language:"javascript"}}]},{id:"RL952152832a274a3da13fc3d86d6ac864",name:"AmplifySurfacePDPs",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"https://www.microsoft.com/en-us/d/surface-pro-8/",valueIsRegex:!0},{value:"https://www.microsoft.com/en-us/d/surface-laptop-4/",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'// JavaScript source code\nvar configure8 = \'a[href*="https://www.microsoft.com/en-us/store/configure/"]\';\nvar studentDiscount = \'a[href*="https://www.microsoft.com/en-us/store/r/student-discounts"]\';\nvar onlineAppoint = \'a[href*="https://www.microsoft.com/en-us/store/b/online-computer-shopping-appointments"]\';\nvar configureNow = "button[id*=\'ConfigureDeviceButton\']";\n\nfunction attachPixels(elementAddress) {\n    $(document).on(\'mousedown\', elementAddress, \'\', function () {\n        window.uetq_Amplify = window.uetq_Amplify || [];\n        window.uetq_Amplify.push(\'event\', \'click\', {\'event_label\': \'\'});\n    });\n}\n\ntry {\n    (function (w, d, t, r, u) {\n        var f, n, i; w[u] = w[u] || [], f = function () {\n            var o = { ti: "149014572" }; o.q = w[u], w[u] = new UET(o), w[u].push("pageLoad")\n        },\n            n = d.createElement(t), n.src = r, n.async = 1,\n            n.onload = n.onreadystatechange = function () {\n                var s = this.readyState; s && s !== "loaded" && s !== "complete" || (f(), n.onload = n.onreadystatechange = null)\n            }, i = d.getElementsByTagName(t)[0], i.parentNode.insertBefore(n, i)\n    })(window, document, "script", "//bat.bing.com/bat.js", "uetq_Amplify");\n\n    attachPixels(configure8);\n    attachPixels(studentDiscount);\n    attachPixels(onlineAppoint);\n    attachPixels(configureNow);\n}\ncatch (err) {\n    _satellite.logger.error("Amplify Surface PDP Test");\n}',language:"javascript"}}]},{id:"RL9d1c9c0bacfc48f3a3daaa0631b93043",name:"Surface Indirect Consumer",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"(en-ca|fr-ca|en-us|fr-fr|de-de|en-gb|ja-jp|es-es|nl-nl|en-au)/surface",valueIsRegex:!0},{value:"(en-ca|fr-ca|en-us|fr-fr|de-de|en-gb|ja-jp|es-es|nl-nl|en-au)/p/surface-laptop-4/946627FB12T1",valueIsRegex:!0},{value:"(en-ca|fr-ca|en-us|fr-fr|de-de|en-gb|ja-jp|es-es|nl-nl|en-au)/d/surface-laptop-go-2/8PGLPV76MJHN",valueIsRegex:!0},{value:"(en-ca|fr-ca|en-us|fr-fr|de-de|en-gb|ja-jp|es-es|nl-nl|en-au)/d/surface-go-3/904H27D0CBWN",valueIsRegex:!0},{value:"(en-ca|fr-ca|en-us|fr-fr|de-de|en-gb|ja-jp|es-es|nl-nl|en-au)/d/surface-pro-8/8QWCRTQ8V8XG",valueIsRegex:!0},{value:"(en-ca|fr-ca|en-us|fr-fr|de-de|en-GB|ja-jp|es-es|nl-nl|en-AU)/d/surface-laptop-studio/8SRDF62SWKPF",valueIsRegex:!0},{value:"(en-ca|fr-ca|en-us|fr-fr|de-de|en-gb|ja-jp|es-es|nl-nl|en-au)/store/b/sale",valueIsRegex:!0},{value:"(en-ca|fr-ca|fr-fr|de-de|en-gb|es-es|nl-nl|en-au)/store/b/student",valueIsRegex:!0},{value:"/en-us/store/b/education",valueIsRegex:!0},{value:"/ja-jp//store/b/surface-studentdeals",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'// JavaScript source code\nvar allMicrosoftClicks = \'a[href*="microsoft"]\';\nvar allXboxClicks = \'a[href*="xbox"]\';\nvar otherRedirects = \'a[href*="#"]\';\n\nfunction attachPixels(elementAddress) {\n    $(document).on(\'mousedown\', elementAddress, \'\', function () {\n        var image = new Image(1, 1);\n        image.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick";\n\n        var image2 = new Image(1, 1);\n        image2.src = "https://secure.adnxs.com/px?id=1268102&t=2";\n    });\n}\n\ntry {\n    attachPixels(allMicrosoftClicks);\n    attachPixels(allXboxClicks);\n    attachPixels(otherRedirects);\n}\ncatch (err) {\n    _satellite.logger.error("Amplify Surface Category Test");\n}',language:"javascript"}}]},{id:"RLbd4d36c8fb714dd0932babdd3f9bd4b3",name:"Surface Indirect VSB",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/(en-us|en-gb|ja-jp|en-ca|fr-ca|de-de|en-au|es-es|nl-nl|fr-fr)/store/b/surfaceforbusiness",valueIsRegex:!0},{value:"/(en-us|en-gb|ja-jp|en-ca|fr-ca|de-de|en-au|es-es|nl-nl|fr-fr)/d/surface-laptop-4-for-business/929894rg3gd7",valueIsRegex:!0},{value:"/(en-us|en-gb|ja-jp|en-ca|fr-ca|de-de|en-au|es-es|nl-nl|fr-fr)/d/surface-pro-7-plus-for-business/8P43N3K93409",valueIsRegex:!0},{value:"/(en-us|en-gb|ja-jp|en-ca|fr-ca|de-de|en-au|es-es|nl-nl|fr-fr)/d/surface-go-3-for-business/8MSJBNL8HBXW",valueIsRegex:!0},{value:"/(en-us|en-gb|ja-jp|en-ca|fr-ca|de-de|en-au|es-es|nl-nl|fr-fr)/d/surface-laptop-studio-for-business/8WVJ5P8DD2TH",valueIsRegex:!0},{value:"/(en-us|en-gb|ja-jp|en-ca|fr-ca|de-de|en-au|es-es|nl-nl|fr-fr)/d/surface-pro-8-for-business/8X957CQQP1T4",valueIsRegex:!0},{value:"/(en-us|en-gb|ja-jp|en-ca|fr-ca|de-de|en-au|es-es|nl-nl|fr-fr)/d/surface-laptop-go-2-for-business/8VW8GDHTN92D",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'// JavaScript source code\nvar allMicrosoftClicks = \'a[href*="microsoft"]\';\nvar allXboxClicks = \'a[href*="xbox"]\';\nvar otherRedirects = \'a[href*="#"]\';\n\nfunction attachPixels(elementAddress) {\n    $(document).on(\'mousedown\', elementAddress, \'\', function () {\n        var image = new Image(1, 1);\n        image.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick";\n\n        var image2 = new Image(1, 1);\n        image2.src = "https://secure.adnxs.com/px?id=1268102&t=2";\n    });\n}\n\ntry {\n  // look up page loads\n    attachPixels(allMicrosoftClicks);\n    attachPixels(allXboxClicks);\n    attachPixels(otherRedirects);\n}\ncatch (err) {\n    _satellite.logger.error("Amplify Surface Category Test");\n}',language:"javascript"}}]},{id:"RL1d41144d66f24225ae95e339c83ccf76",name:"Surface/StoreBusiness/US/Yahoo-Floodlight",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-us/store/b/business",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/dateRange.js",settings:{end:"2022-10-31T00:00:00Z",start:"2022-07-26T00:00:00Z"}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'var allMicrosoftClicks = \'a[href*="microsoft"]\';\nvar allXboxClicks = \'a[href*="xbox"]\';\n\nfunction attachPixels(elementAddress) {\n    $(document).on(\'mousedown\', elementAddress, \'\', function () {\n        var cN = $(this).attr("data-bi-cn");\n        var image = new Image(1, 1);\n        image.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&he={INSERT_MACRO_HERE}&auid={INSERT_MACRO_HERE}&ea=UserEngagementConversion";\n\n        var image2 = new Image(1, 1);\n        image2.src = "https://ad.doubleclick.net/ddm/activity/src=8406157;type=stoth;cat=lrn_uni;u1=" + _TMDL.geo + ";u2=" + _TMDL.ll + ";u6=" + encodeURIComponent(_TMDL.pagename) + ";u25=" + _TMDL.pids[0] + ";u26=" + encodeURIComponent(_TMDL.pnames[0]) + ";u50=" + cN + ";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=1;num=\' + a + \'?";\n    });\n}\n\ntry {\n    var image = new Image(1, 1);\n    image.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&he={INSERT_MACRO_HERE}&auid={INSERT_MACRO_HERE}&ea=LandingPageVisits";\n\n    var image = new Image(1, 1);\n    image.src = "https://ad.doubleclick.net/ddm/activity/src=8406157;type=stoth;cat=phy_std;u1=" + _TMDL.geo + ";u2=" + _TMDL.ll + ";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=\' + a + \'?";\n\n    attachPixels(allMicrosoftClicks);\n    attachPixels(allXboxClicks);\n}\ncatch (err) {\n    _satellite.logger.error("US-StoreBusiness-Yahoo/Floodlight");\n}',language:"javascript"}}]}]};var _satellite=function(){"use strict";function t(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}function e(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var o={};return"abcdefghijklmnopqrst".split("").forEach((function(t){o[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},o)).join("")}catch(t){return!1}}function n(t){if(t.__esModule)return t;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(t).forEach((function(n){var o=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,o.get?o:{enumerable:!0,get:function(){return t[n]}})})),e}function o(t){var e={exports:{}};return t(e,e.exports),e.exports}function a(t){var e=this.constructor;return this.then((function(n){return e.resolve(t()).then((function(){return n}))}),(function(n){return e.resolve(t()).then((function(){return e.reject(n)}))}))}function s(t){return Boolean(t&&void 0!==t.length)}function r(){}function i(t,e){return function(){t.apply(e,arguments)}}function c(t){if(!(this instanceof c))throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],f(t,this)}function d(t,e){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,c._immediateFn((function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null!==n){var o;try{o=n(t._value)}catch(t){return void l(e.promise,t)}u(e.promise,o)}else(1===t._state?u:l)(e.promise,t._value)}))):t._deferreds.push(e)}function u(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof c)return t._state=3,t._value=e,void p(t);if("function"==typeof n)return void f(i(n,e),t)}t._state=1,t._value=e,p(t)}catch(e){l(t,e)}}function l(t,e){t._state=2,t._value=e,p(t)}function p(t){2===t._state&&0===t._deferreds.length&&c._immediateFn((function(){t._handled||c._unhandledRejectionFn(t._value)}));for(var e=0,n=t._deferreds.length;e<n;e++)d(t,t._deferreds[e]);t._deferreds=null}function m(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}function f(t,e){var n=!1;try{t((function(t){n||(n=!0,u(e,t))}),(function(t){n||(n=!0,l(e,t))}))}catch(t){if(n)return;n=!0,l(e,t)}}function g(t){return!0===Wt(t)&&"[object Object]"===Object.prototype.toString.call(t)}function h(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function _(t){return"string"==typeof t&&-1!==t.indexOf("[")&&-1!==t.indexOf("]")}function T(t){return t.substr(0,t.indexOf("["))}function v(t,e,n){if(t.length&&Zt(e)){var o=t[0];if(1!==t.length){var a=t.slice(1);if(!_(o))return v(a,e[o],n);var s=e[o=T(o)];Array.isArray(s)&&s.forEach((function(t){return v(a,t,n)}))}else e.hasOwnProperty(o)&&"string"==typeof e[o]&&(e[o]=n(e[o]))}}if(window.atob){var C=document,b=Object.getOwnPropertySymbols,D=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable,L=e()?Object.assign:function(e){for(var n,o,a=t(e),s=1;s<arguments.length;s++){for(var r in n=Object(arguments[s]))D.call(n,r)&&(a[r]=n[r]);if(b){o=b(n);for(var i=0;i<o.length;i++)M.call(n,o[i])&&(a[o[i]]=n[o[i]])}}return a},y=L,w=window,R=function(t,e,n,o){var a,s=Boolean(e&&Array.isArray(n)),r=Boolean(s&&t),i=document.createElement("a");if(s){var c=function(){var t=new Error("Unable to find the Library Embed Code for Dynamic Host Resolution.");throw t.code="dynamic_host_resolver_constructor_error",t};if(t&&(/^((https?:)?\/\/).+/.test(t)||c(),/^\/\/.+/.test(t)?i.href=w.location.protocol+t:i.href=t),i.hostname||c(),-1===n.indexOf(i.hostname)){var d=new Error("This library is not authorized for this domain. Please contact your CSM for more information.");throw d.code="dynamic_host_not_allowed",d}}var u=function(){if(null!=a)return a;if(r){var t=i.host;/:80$/.test(t)?t=t.replace(":80",""):/:80\/$/.test(t)?t=t.replace(":80/",""):/:443$/.test(t)?t=t.replace(":443",""):/:443\/$/.test(t)&&(t=t.replace(":443/","")),a=i.protocol+"//"+t}else a="";return a},l=function(t){return r&&"string"==typeof t?[u(),"/"===t.charAt(0)?t.slice(1):t].join("/"):t},p={getTurbineHost:u,decorateWithDynamicHost:l,get isDynamicEnforced(){return s}};return w&&o.onDebugChanged((function(t){t?w.dynamicHostResolver=p:delete w.dynamicHostResolver})),p},x=function(t){var e=[];return t.forEach((function(t){t.events&&t.events.forEach((function(n){e.push({rule:t,event:n})}))})),e.sort((function(t,e){return t.event.ruleOrder-e.event.ruleOrder}))},P="debug",S=function(t,e){var n=function(){return"true"===t.getItem(P)},o=function(e){t.setItem(P,e)},a=[],s=function(t){a.push(t)};return e.outputEnabled=n(),{onDebugChanged:s,getDebugEnabled:n,setDebugEnabled:function(t){n()!==t&&(o(t),e.outputEnabled=t,a.forEach((function(e){e(t)})))}}},j="Module did not export a function.",B=function(t,e,n){return function(o,a,s){s=s||[];var r=t.getModuleExports(o.modulePath);if("function"!=typeof r)throw new Error(j);var i=t.getModuleDefinition(o.modulePath),c=o.settings||{};!o.hasTransformedFilePaths&&i.filePaths&&(n(c,i.filePaths,o.modulePath),o.hasTransformedFilePaths=!0);var d=e(c,a);return r.bind(null,d).apply(null,s)}},I=function(t){return"string"==typeof t?t.replace(/\s+/g," ").trim():t},A={LOG:"log",INFO:"info",DEBUG:"debug",WARN:"warn",ERROR:"error"},F="\ud83d\ude80",k=10===parseInt((/msie (\d+)/.exec(navigator.userAgent.toLowerCase())||[])[1])?"[Launch]":F,N=!1,Q=function(t){if(N&&window.console){var e=Array.prototype.slice.call(arguments,1);e.unshift(k),t!==A.DEBUG||window.console[t]||(t=A.INFO),window.console[t].apply(window.console,e)}},O=Q.bind(null,A.LOG),G=Q.bind(null,A.INFO),E=Q.bind(null,A.DEBUG),K=Q.bind(null,A.WARN),V=Q.bind(null,A.ERROR),H=function(){var t=N;N=!0,Q.apply(null,Array.prototype.concat(A.WARN,Array.prototype.slice.call(arguments))),t||(N=!1)},U={log:O,info:G,debug:E,warn:K,error:V,deprecation:H,get outputEnabled(){return N},set outputEnabled(t){N=t},createPrefixedLogger:function(t){var e="["+t+"]";return{log:O.bind(null,e),info:G.bind(null,e),debug:E.bind(null,e),warn:K.bind(null,e),error:V.bind(null,e)}}},q="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},X=o((function(t){!function(e){if(t.exports=e(),!!0){var n=window.Cookies,o=window.Cookies=e();o.noConflict=function(){return window.Cookies=n,o}}}((function(){function t(){for(var t=0,e={};t<arguments.length;t++){var n=arguments[t];for(var o in n)e[o]=n[o]}return e}function e(t){return t.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}function n(o){function a(){}function s(e,n,s){if("undefined"!=typeof document){"number"==typeof(s=t({path:"/"},a.defaults,s)).expires&&(s.expires=new Date(1*new Date+864e5*s.expires)),s.expires=s.expires?s.expires.toUTCString():"";try{var r=JSON.stringify(n);/^[\{\[]/.test(r)&&(n=r)}catch(t){}n=o.write?o.write(n,e):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=encodeURIComponent(String(e)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var i="";for(var c in s)s[c]&&(i+="; "+c,!0!==s[c]&&(i+="="+s[c].split(";")[0]));return document.cookie=e+"="+n+i}}function r(t,n){if("undefined"!=typeof document){for(var a={},s=document.cookie?document.cookie.split("; "):[],r=0;r<s.length;r++){var i=s[r].split("="),c=i.slice(1).join("=");n||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var d=e(i[0]);if(c=(o.read||o)(c,d)||e(c),n)try{c=JSON.parse(c)}catch(t){}if(a[d]=c,t===d)break}catch(t){}}return t?a[t]:a}}return a.set=s,a.get=function(t){return r(t,!1)},a.getJSON=function(t){return r(t,!0)},a.remove=function(e,n){s(e,"",t(n,{expires:-1}))},a.defaults={},a.withConverter=n,a}return n((function(){}))}))})),W={get:X.get,set:X.set,remove:X.remove},Z="com.adobe.reactor.",J=function(t,e){var n=Z+(e||"");return{getItem:function(e){try{return w[t].getItem(n+e)}catch(t){return null}},setItem:function(e,o){try{return w[t].setItem(n+e,o),!0}catch(t){return!1}}}},$="_sdsat_",z="dataElements.",Y="dataElementCookiesMigrated",tt=J("localStorage"),et=J("sessionStorage",z),nt=J("localStorage",z),ot={PAGEVIEW:"pageview",SESSION:"session",VISITOR:"visitor"},at={},st=function(t){var e;try{e=JSON.stringify(t)}catch(t){}return e},rt=function(t,e,n){var o;switch(e){case ot.PAGEVIEW:return void(at[t]=n);case ot.SESSION:return void((o=st(n))&&et.setItem(t,o));case ot.VISITOR:return void((o=st(n))&&nt.setItem(t,o))}},it=function(t,e){var n=W.get($+t);void 0!==n&&rt(t,e,n)},ct=function(t){tt.getItem(Y)||(Object.keys(t).forEach((function(e){it(e,t[e].storageDuration)})),tt.setItem(Y,!0))},dt={setValue:rt,getValue:function(t,e){var n;switch(e){case ot.PAGEVIEW:return at.hasOwnProperty(t)?at[t]:null;case ot.SESSION:return null===(n=et.getItem(t))?n:JSON.parse(n);case ot.VISITOR:return null===(n=nt.getItem(t))?n:JSON.parse(n)}},migrateCookieData:ct},ut=function(t,e,n,o){return"Failed to execute data element module "+t.modulePath+" for data element "+e+". "+n+(o?"\n"+o:"")},lt=function(t,e,n,o,a){return function(s,r){var i=e(s);if(!i)return o?"":void 0;var c,d,u=i.storageDuration;try{c=t.getModuleExports(i.modulePath),d=t.getModuleDefinition(i.modulePath)}catch(t){return void U.error(ut(i,s,t.message,t.stack))}if("function"==typeof c){var l,p=i.settings||{};!i.hasTransformedFilePaths&&d.filePaths&&(a(p,d.filePaths,i.modulePath),i.hasTransformedFilePaths=!0);try{l=c(n(p,r),r)}catch(t){return void U.error(ut(i,s,t.message,t.stack))}return u&&(null!=l?dt.setValue(s,u,l):l=dt.getValue(s,u)),null==l&&null!=i.defaultValue&&(l=i.defaultValue),"string"==typeof l&&(i.cleanText&&(l=I(l)),i.forceLowerCase&&(l=l.toLowerCase())),l}U.error(ut(i,s,"Module did not export a function."))}},pt={text:function(t){return t.textContent},cleanText:function(t){return I(t.textContent)}},mt=function(t,e,n){for(var o,a=t,s=0,r=e.length;s<r;s++){if(null==a)return;var i=e[s];if(n&&"@"===i.charAt(0)){var c=i.slice(1);a=pt[c](a)}else if(a.getAttribute&&(o=i.match(/^getAttribute\((.+)\)$/))){var d=o[1];a=a.getAttribute(d)}else a=a[i]}return a},ft=function(t,e,n){return function(o,a){var s;if(e(o))s=n(o,a);else{var r=o.split("."),i=r.shift();"this"===i?a&&(s=mt(a.element,r,!0)):"event"===i?a&&(s=mt(a,r)):"target"===i?a&&(s=mt(a.target,r)):s=mt(t[i],r)}return s}},gt=function(t,e){return function(n){var o=n.split(".")[0];return Boolean(e(n)||"this"===o||"event"===o||"target"===o||t.hasOwnProperty(o))}},ht=function(t,e,n){var o={exports:{}};return t.call(o.exports,o,o.exports,e,n),o.exports},_t=function(){var t={},e=function(e){var n=t[e];if(!n)throw new Error("Module "+e+" not found.");return n},n=function(){Object.keys(t).forEach((function(t){try{o(t)}catch(n){var e="Error initializing module "+t+". "+n.message+(n.stack?"\n"+n.stack:"");U.error(e)}}))},o=function(t){var n=e(t);return n.hasOwnProperty("exports")||(n.exports=ht(n.definition.script,n.require,n.turbine)),n.exports};return{registerModule:function(e,n,o,a,s){var r={definition:n,extensionName:o,require:a,turbine:s};r.require=a,t[e]=r},hydrateCache:n,getModuleExports:o,getModuleDefinition:function(t){return e(t).definition},getModuleExtensionName:function(t){return e(t).extensionName}}},Tt=!1,vt=function(t){return function(e,n){var o=t._monitors;o&&(Tt||(U.warn("The _satellite._monitors API may change at any time and should only be used for debugging."),Tt=!0),o.forEach((function(t){t[e]&&t[e](n)})))}},Ct=function(t,e,n){var o,a,s,r,i=[],c=function(o,a,s){if(!t(a))return o;i.push(a);var r=e(a,s);return i.pop(),null==r&&n?"":r};return o=function(t,e){var n=/^%([^%]+)%$/.exec(t);return n?c(t,n[1],e):t.replace(/%(.+?)%/g,(function(t,n){return c(t,n,e)}))},a=function(t,e){for(var n={},o=Object.keys(t),a=0;a<o.length;a++){var s=o[a],i=t[s];n[s]=r(i,e)}return n},s=function(t,e){for(var n=[],o=0,a=t.length;o<a;o++)n.push(r(t[o],e));return n},r=function(t,e){return"string"==typeof t?o(t,e):Array.isArray(t)?s(t,e):"object"==typeof t&&null!==t?a(t,e):t},function(t,e){return i.length>10?(U.error("Data element circular reference detected: "+i.join(" -> ")),t):r(t,e)}},bt=function(t){return function(){if("string"==typeof arguments[0])t[arguments[0]]=arguments[1];else if(arguments[0]){var e=arguments[0];for(var n in e)t[n]=e[n]}}},Dt=setTimeout;c.prototype.catch=function(t){return this.then(null,t)},c.prototype.then=function(t,e){var n=new this.constructor(r);return d(this,new m(t,e,n)),n},c.prototype.finally=a,c.all=function(t){return new c((function(e,n){function o(t,s){try{if(s&&("object"==typeof s||"function"==typeof s)){var i=s.then;if("function"==typeof i)return void i.call(s,(function(e){o(t,e)}),n)}a[t]=s,0==--r&&e(a)}catch(t){n(t)}}if(!s(t))return n(new TypeError("Promise.all accepts an array"));var a=Array.prototype.slice.call(t);if(0===a.length)return e([]);for(var r=a.length,i=0;i<a.length;i++)o(i,a[i])}))},c.resolve=function(t){return t&&"object"==typeof t&&t.constructor===c?t:new c((function(e){e(t)}))},c.reject=function(t){return new c((function(e,n){n(t)}))},c.race=function(t){return new c((function(e,n){if(!s(t))return n(new TypeError("Promise.race accepts an array"));for(var o=0,a=t.length;o<a;o++)c.resolve(t[o]).then(e,n)}))},c._immediateFn="function"==typeof setImmediate&&function(t){setImmediate(t)}||function(t){Dt(t,0)},c._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)};var Mt=n(Object.freeze({__proto__:null,default:c})),Lt="undefined"!=typeof window&&window.Promise||void 0!==q&&q.Promise||Mt.default||Mt,yt=function(t,e,n){return function(o,a,s,r){return r.then((function(){var r,i=o.delayNext;return new Lt((function(e,n){var a=t(o,s,[s]);if(!i)return e();var c=o.timeout,d=new Lt((function(t,e){r=setTimeout((function(){e(new Error("A timeout occurred because the action took longer than "+c/1e3+" seconds to complete. "))}),c)}));Lt.race([a,d]).then(e,n)})).catch((function(t){return clearTimeout(r),t=e(t),n(o,a,t),Lt.reject(t)})).then((function(){clearTimeout(r)}))}))}},wt=function(t,e,n,o,a){return function(s,r,i,c){return c.then((function(){var c;return new Lt((function(e,n){var o=t(s,i,[i]),a=s.timeout,r=new Lt((function(t,e){c=setTimeout((function(){e(new Error("A timeout occurred because the condition took longer than "+a/1e3+" seconds to complete. "))}),a)}));Lt.race([o,r]).then(e,n)})).catch((function(t){return clearTimeout(c),t=e(t),o(s,r,t),Lt.reject(t)})).then((function(t){if(clearTimeout(c),!n(s,t))return a(s,r),Lt.reject()}))}))}},Rt=Lt.resolve(),xt=function(t,e,n){return function(o,a){return o.conditions&&o.conditions.forEach((function(e){Rt=t(e,o,a,Rt)})),o.actions&&o.actions.forEach((function(t){Rt=e(t,o,a,Rt)})),Rt=(Rt=Rt.then((function(){n(o)}))).catch((function(){}))}},Pt=function(t){return Boolean(t&&"object"==typeof t&&"function"==typeof t.then)},St=function(t,e,n,o){return function(a,s){var r;if(a.conditions)for(var i=0;i<a.conditions.length;i++){r=a.conditions[i];try{var c=t(r,s,[s]);if(Pt(c))throw new Error("Rule component sequencing must be enabled on the property for this condition to function properly.");if(!e(r,c))return n(r,a),!1}catch(t){return o(r,a,t),!1}}return!0}},jt=function(t,e){return function(n,o){t(n,o)&&e(n,o)}},Bt=function(t){return function(e){var n=t.getModuleDefinition(e.modulePath);return n&&n.displayName||e.modulePath}},It=function(t){return function(e){var n=e.rule,o=e.event,a=t.getModuleDefinition(o.modulePath).name;return{$type:t.getModuleExtensionName(o.modulePath)+"."+a,$rule:{id:n.id,name:n.name}}}},At=function(t,e,n,o,a,s){return function(r,i){var c=i.rule,d=i.event;d.settings=d.settings||{};try{var u=a(i);e(d,null,[function(e){var o=n(u,e);r((function(){t(o,c)}))}])}catch(t){s.error(o(d,c,t))}}},Ft=function(t,e,n,o){return function(a,s,r){var i=e(a);n.error(t(i,s.name,r)),o("ruleActionFailed",{rule:s,action:a})}},kt=function(t,e,n,o){return function(a,s,r){var i=e(a);n.error(t(i,s.name,r)),o("ruleConditionFailed",{rule:s,condition:a})}},Nt=function(t,e,n){return function(o,a){var s=t(o);e.log('Condition "'+s+'" for rule "'+a.name+'" was not met.'),n("ruleConditionFailed",{rule:a,condition:o})}},Qt=function(t,e){return function(n){t.log('Rule "'+n.name+'" fired.'),e("ruleCompleted",{rule:n})}},Ot=function(t,e,n){return function(o,a){var s;if(o.actions)for(var r=0;r<o.actions.length;r++){s=o.actions[r];try{t(s,a,[a])}catch(t){return void e(s,o,t)}}n(o)}},Gt=function(t,e,n,o){return function(a,s){o("ruleTriggered",{rule:s}),t?n(s,a):e(s,a)}},Et=function(t,e,n){return'Failed to execute "'+t+'" for "'+e+'" rule. '+n.message+(n.stack?"\n"+n.stack:"")},Kt=function(t,e){return e&&!t.negate||!e&&t.negate},Vt=[],Ht=!1,Ut=function(t){Ht?t():Vt.push(t)},qt=function(t,e,n){t(e).forEach((function(t){n(Ut,t)})),Ht=!0,Vt.forEach((function(t){t()})),Vt=[]},Xt=function(t){
if(t||(t=new Error("The extension triggered an error, but no error information was provided.")),!(t instanceof Error)){var e="object"==typeof t?JSON.stringify(t):String(t);t=new Error(e)}return t},Wt=function(t){return null!=t&&"object"==typeof t&&!1===Array.isArray(t)},Zt=function(t){var e,n;return!1!==g(t)&&("function"==typeof(e=t.constructor)&&(!1!==g(n=e.prototype)&&!1!==n.hasOwnProperty("isPrototypeOf")))},Jt=function(t,e){return Zt(e=e||{})?e=y({},e,t):y(e,t),e.hasOwnProperty("type")||Object.defineProperty(e,"type",{get:function(){return U.deprecation("Accessing event.type in Adobe Launch has been deprecated and will be removed soon. Please use event.$type instead."),e.$type}}),e},$t=function(t,e){return function(n,o){var a=t[n];if(a){var s=a.modules;if(s)for(var r=Object.keys(s),i=0;i<r.length;i++){var c=r[i],d=s[c];if(d.shared&&d.name===o)return e.getModuleExports(c)}}}},zt=function(t,e){return function(){return e?t(e):{}}},Yt=function(t,e,n){return function(o){if(n){var a=o.split(".");a.splice(a.length-1||1,0,"min"),o=a.join(".")}return t(e)+o}},te=".js",ee=function(t){return t.substr(0,t.lastIndexOf("/"))},ne=function(t,e){return-1!==t.indexOf(e,t.length-e.length)},oe=function(t,e){ne(e,te)||(e+=te);var n=e.split("/"),o=ee(t).split("/");return n.forEach((function(t){t&&"."!==t&&(".."===t?o.length&&o.pop():o.push(t))})),o.join("/")},ae=function(t,e){return new Lt((function(n,o){e.onload=function(){n(e)},e.onerror=function(){o(new Error("Failed to load script "+t))}}))},se=function(t){var e=document.createElement("script");e.src=t,e.async=!0;var n=ae(t,e);return document.getElementsByTagName("head")[0].appendChild(e),n},re=function(t,e,n,o){e=e||"&",n=n||"=";var a={};if("string"!=typeof t||0===t.length)return a;var s=/\+/g;t=t.split(e);var r=1e3;o&&"number"==typeof o.maxKeys&&(r=o.maxKeys);var i=t.length;r>0&&i>r&&(i=r);for(var c=0;c<i;++c){var d,u,l,p,m=t[c].replace(s,"%20"),f=m.indexOf(n);f>=0?(d=m.substr(0,f),u=m.substr(f+1)):(d=m,u=""),l=decodeURIComponent(d),p=decodeURIComponent(u),h(a,l)?Array.isArray(a[l])?a[l].push(p):a[l]=[a[l],p]:a[l]=p}return a},ie=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}},ce=function(t,e,n,o){return e=e||"&",n=n||"=",null===t&&(t=void 0),"object"==typeof t?Object.keys(t).map((function(o){var a=encodeURIComponent(ie(o))+n;return Array.isArray(t[o])?t[o].map((function(t){return a+encodeURIComponent(ie(t))})).join(e):a+encodeURIComponent(ie(t[o]))})).join(e):o?encodeURIComponent(ie(o))+n+encodeURIComponent(ie(t)):""},de=o((function(t,e){e.decode=e.parse=re,e.encode=e.stringify=ce})),ue="@adobe/reactor-",le={cookie:W,document:C,"load-script":se,"object-assign":y,promise:Lt,"query-string":{parse:function(t){return"string"==typeof t&&(t=t.trim().replace(/^[?#&]/,"")),de.parse(t)},stringify:function(t){return de.stringify(t)}},window:w},pe=function(t){return function(e){if(0===e.indexOf(ue)){var n=e.substr(ue.length),o=le[n];if(o)return o}if(0===e.indexOf("./")||0===e.indexOf("../"))return t(e);throw new Error('Cannot resolve module "'+e+'".')}},me=function(t,e,n,o,a,s,r){var i=t.extensions,c=t.buildInfo,d=t.environment,u=t.property.settings;if(i){var l=$t(i,e);Object.keys(i).forEach((function(p){var m=i[p],f=m.settings;Array.isArray(m.filePaths)&&(f=s(f,m.filePaths));var g=zt(o,f);if(m.modules){var h=U.createPrefixedLogger(m.displayName),_=Yt(r,m.hostedLibFilesBaseUrl,c.minified),T={buildInfo:c,environment:d,property:{name:t.property.name,id:t.property.id},getDataElementValue:a,getExtensionSettings:g,getHostedLibFileUrl:_,getSharedModule:l,logger:h,propertySettings:u,replaceTokens:o,onDebugChanged:n.onDebugChanged,get debugEnabled(){return n.getDebugEnabled()}};Object.keys(m.modules).forEach((function(t){var n=m.modules[t],o=pe((function(n){var o=oe(t,n);return e.getModuleExports(o)}));e.registerModule(t,n,p,o,T)}))}})),e.hydrateCache()}return e},fe=function(t,e,n,o,a){var s=U.createPrefixedLogger("Custom Script");t.track=function(t){U.log('"'+t+'" does not match any direct call identifiers.')},t.getVisitorId=function(){return null},t.property={name:e.property.name,id:e.property.id},t.company=e.company,t.buildInfo=e.buildInfo,t.environment=e.environment,t.logger=s,t.notify=function(t,e){switch(U.deprecation("_satellite.notify is deprecated. Please use the `_satellite.logger` API."),e){case 3:s.info(t);break;case 4:s.warn(t);break;case 5:s.error(t);break;default:s.log(t)}},t.getVar=o,t.setVar=a,t.setCookie=function(t,e,n){var o="",a={};n&&(o=", { expires: "+n+" }",a.expires=n);var s='_satellite.setCookie is deprecated. Please use _satellite.cookie.set("'+t+'", "'+e+'"'+o+").";U.deprecation(s),W.set(t,e,a)},t.readCookie=function(t){return U.deprecation('_satellite.readCookie is deprecated. Please use _satellite.cookie.get("'+t+'").'),W.get(t)},t.removeCookie=function(t){U.deprecation('_satellite.removeCookie is deprecated. Please use _satellite.cookie.remove("'+t+'").'),W.remove(t)},t.cookie=W,t.pageBottom=function(){},t.setDebug=n;var r=!1;Object.defineProperty(t,"_container",{get:function(){return r||(U.warn("_satellite._container may change at any time and should only be used for debugging."),r=!0),e}})},ge=function(t){for(var e=C.querySelectorAll("script"),n=0;n<e.length;n++){var o=e[n];if(t.test(o.src))return o}},he=function(t,e){return function(n,o,a){return t&&Zt(n)&&Object.keys(n).length&&Array.isArray(o)&&o.length?(o.forEach((function(t){Boolean(null!=a&&/^core\/.*actions.*\/customCode\.js$/.test(a))&&"source"===t&&!n.isExternal||v(t.split("."),n,e)})),n):n}},_e={getTurbine:function(){return ge(new RegExp(/(launch|satelliteLib)-[^\/]+.js(\?.*)?$/))},byRegexPattern:ge}.getTurbine,Te=window._satellite;if(Te&&!window.__satelliteLoaded){window.__satelliteLoaded=!0;var ve=Te.container;delete Te.container;var Ce=y({},ve.buildInfo);Object.defineProperty(Ce,"environment",{get:function(){return U.deprecation("container.buildInfo.environment is deprecated.Please use `container.environment.stage` instead"),ve.environment.stage}}),ve.buildInfo=Ce;var be,De=S(J("localStorage"),U),Me="";C.currentScript&&C.currentScript.getAttribute("src")?Me=C.currentScript.getAttribute("src"):_e()&&(Me=_e().getAttribute("src"));try{be=R(Me,Boolean(ve.company.dynamicCdnEnabled),ve.company.cdnAllowList,De)}catch(t){throw U.warn("Please review the following error:"),t}var Le,ye=he(be.isDynamicEnforced,be.decorateWithDynamicHost),we=_t(),Re=ve.property.settings.undefinedVarsReturnEmpty,xe=ve.property.settings.ruleComponentSequencingEnabled,Pe=ve.dataElements||{};dt.migrateCookieData(Pe);var Se=function(t){return Pe[t]},je=function(){return Le.apply(null,arguments)},Be=lt(we,Se,je,Re,ye),Ie={},Ae=bt(Ie),Fe=gt(Ie,Se),ke=ft(Ie,Se,Be);Le=Ct(Fe,ke,Re),fe(Te,ve,De.setDebugEnabled,ke,Ae),me(ve,we,De,Le,Be,ye,be.decorateWithDynamicHost);var Ne=vt(Te),Qe=B(we,Le,ye),Oe=Bt(we),Ge=Nt(Oe,U,Ne),Ee=kt(Et,Oe,U,Ne),Ke=Ft(Et,Oe,U,Ne),Ve=Qt(U,Ne),He=At(Gt(xe,jt(St(Qe,Kt,Ge,Ee),Ot(Qe,Ke,Ve)),xt(wt(Qe,Xt,Kt,Ee,Ge),yt(Qe,Xt,Ke),Ve),Ne),Qe,Jt,Et,It(we),U);qt(x,ve.rules||[],He)}return Te}console.warn("Adobe Launch is unsupported in IE 9 and below.")}();